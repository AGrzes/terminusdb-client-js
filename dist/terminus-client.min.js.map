{"version":3,"sources":["webpack://TerminusClient/webpack/bootstrap","webpack://TerminusClient/./node_modules/axios/lib/utils.js","webpack://TerminusClient/./lib/utils.js","webpack://TerminusClient/./lib/errorMessage.js","webpack://TerminusClient/./lib/const.js","webpack://TerminusClient/./lib/woqlClient.js","webpack://TerminusClient/./node_modules/axios/lib/helpers/bind.js","webpack://TerminusClient/./node_modules/axios/lib/helpers/buildURL.js","webpack://TerminusClient/./node_modules/axios/lib/cancel/isCancel.js","webpack://TerminusClient/./node_modules/axios/lib/defaults.js","webpack://TerminusClient/./node_modules/axios/lib/adapters/xhr.js","webpack://TerminusClient/./node_modules/axios/lib/core/createError.js","webpack://TerminusClient/./node_modules/axios/lib/core/mergeConfig.js","webpack://TerminusClient/./node_modules/axios/lib/cancel/Cancel.js","webpack://TerminusClient/./lib/connectionCapabilities.js","webpack://TerminusClient/./lib/connectionConfig.js","webpack://TerminusClient/./lib/terminusIDParser.js","webpack://TerminusClient/./lib/woqlRule.js","webpack://TerminusClient/./lib/terminusRule.js","webpack://TerminusClient/./lib/frameRule.js","webpack://TerminusClient/./index.js","webpack://TerminusClient/./lib/dispatchRequest.js","webpack://TerminusClient/./node_modules/buffer/index.js","webpack://TerminusClient/(webpack)/buildin/global.js","webpack://TerminusClient/./node_modules/base64-js/index.js","webpack://TerminusClient/./node_modules/ieee754/index.js","webpack://TerminusClient/./node_modules/isarray/index.js","webpack://TerminusClient/./node_modules/axios/index.js","webpack://TerminusClient/./node_modules/axios/lib/axios.js","webpack://TerminusClient/./node_modules/is-buffer/index.js","webpack://TerminusClient/./node_modules/axios/lib/core/Axios.js","webpack://TerminusClient/./node_modules/axios/lib/core/InterceptorManager.js","webpack://TerminusClient/./node_modules/axios/lib/core/dispatchRequest.js","webpack://TerminusClient/./node_modules/axios/lib/core/transformData.js","webpack://TerminusClient/./node_modules/axios/lib/helpers/normalizeHeaderName.js","webpack://TerminusClient/./node_modules/axios/lib/core/settle.js","webpack://TerminusClient/./node_modules/axios/lib/core/enhanceError.js","webpack://TerminusClient/./node_modules/axios/lib/helpers/parseHeaders.js","webpack://TerminusClient/./node_modules/axios/lib/helpers/isURLSameOrigin.js","webpack://TerminusClient/./node_modules/axios/lib/helpers/cookies.js","webpack://TerminusClient/./node_modules/axios/lib/helpers/isAbsoluteURL.js","webpack://TerminusClient/./node_modules/axios/lib/helpers/combineURLs.js","webpack://TerminusClient/./node_modules/axios/lib/cancel/CancelToken.js","webpack://TerminusClient/./node_modules/axios/lib/helpers/spread.js","webpack://TerminusClient/./lib/document.js","webpack://TerminusClient/./lib/woqlResult.js","webpack://TerminusClient/./lib/woql.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isBuffer","toString","isArray","val","isObject","isFunction","forEach","obj","fn","length","isArrayBuffer","isFormData","FormData","isArrayBufferView","ArrayBuffer","isView","buffer","isString","isNumber","isUndefined","isDate","isFile","isBlob","isStream","pipe","isURLSearchParams","URLSearchParams","isStandardBrowserEnv","navigator","product","window","document","merge","result","assignValue","arguments","deepMerge","extend","a","b","thisArg","trim","str","replace","Utils","rdf","rdfs","xsd","owl","tcs","xdd","v","terminus","vio","payload","encodeURIComponent","payloadArr","keys","keyElement","valueElement","push","join","prefix","url","this","standard_urls","Math","random","substring","Date","getTime","link","pref","full","ida","idb","unshorten","sha","getShorthand","shb","prefixes","validURL","bits","split","nurl","urlFragment","lastIndexOf","charAt","toUpperCase","slice","location","href","urlStr","ext","vars","nvars","addNamespaceToVariable","mvar","removeNamespaceFromVariable","TypeHelper","isStringType","stype","numberWithCommas","separator","parts","datatypes","parseRangeValue","dividor","vals","indexOf","DateHelper","parseXsdTime","tz","extractXsdTimezone","hour","minute","second","timezone","parseXsdDate","year","parsed","abs","month","parseInt","day","parseDate","ty","parseXsdDateTime","addXsdPadding","nparsed","xsdFromParsed","ret","xparsed","convertTimestampToXsd","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","datetime","ptime","getErrorAsMessage","api","err","response","data","formatErrorMessage","body","status","action","type","method","msg","nmsg","getAPIErrorMessage","getAccessDeniedMessage","accessDenied","db","server","getInvalidURIMessage","parseAPIError","text","e","json","error","headers","redirected","freeze","CONNECT","GET_SCHEMA","UPDATE_SCHEMA","UPDATE_DOCUMENT","CLASS_FRAME","WOQL_SELECT","GET_DOCUMENT","DELETE_DATABASE","DELETE_DOCUMENT","CREATE_DATABASE","CREATE_DOCUMENT","WOQL_UPDATE","CONST","require","DispatchRequest","ErrorMessage","ConnectionCapabilities","ConnectionConfig","UTILS","WOQLClient","params","undefined","use_fetch","return_full_response","connectionConfig","connection","connect","curl","dbid","setServer","Promise","reject","URIError","serverURL","setClientKey","dispatch","then","addConnection","createDatabase","dburl","details","setDB","makeDocumentConsistentWithURL","dbURL","opts","doc","addOptionsToDocument","deleteDatabase","self","removeDB","getSchema","schurl","setSchemaURL","schemaURL","updateSchema","createDocument","docurl","setDocument","docURL","getDocument","docid","updateDocument","deleteDocument","select","qurl","woql","setQueryURL","q","JSON","stringify","addOptionsToWOQL","queryURL","update","getClassFrame","cfurl","cls","setClassFrameURL","frameURL","pdoc","_","addKeyToPayload","getClientKey","includeKey","dispatchFetch","redirect","referrer","hdrs","Authorization","btoa","URIEncodePayload","cache","Headers","fetch","ok","Error","args","Array","apply","utils","encode","paramsSerializer","serializedParams","toISOString","hashmarkIndex","__CANCEL__","normalizeHeaderName","DEFAULT_CONTENT_TYPE","setContentTypeIfUnset","adapter","defaults","process","XMLHttpRequest","transformRequest","transformResponse","parse","timeout","xsrfCookieName","xsrfHeaderName","maxContentLength","validateStatus","common","settle","buildURL","parseHeaders","isURLSameOrigin","createError","config","resolve","requestData","requestHeaders","request","auth","username","password","open","onreadystatechange","readyState","responseURL","responseHeaders","getAllResponseHeaders","responseType","responseText","statusText","onabort","onerror","ontimeout","cookies","xsrfValue","withCredentials","read","toLowerCase","setRequestHeader","onDownloadProgress","addEventListener","onUploadProgress","upload","cancelToken","promise","cancel","abort","send","enhanceError","message","code","config1","config2","prop","Cancel","capabilities","capabilitiesKeys","pred","auths","scope","actions","actionsArr","map","item","j","nrec","serverConnected","getServerRecord","srvr","connectionObj","oid","getDBRecord","dbCapabilityID","getServerDBRecords","dbrecs","dbidCap","capabilitiesPermit","rec","console","log","IDParser","newParams","include_key","inputStr","context","parser","parseServerURL","parseDBID","parseSchemaURL","parseQueryURL","parseClassFrameURL","parseDocumentURL","server_url","setContext","validPrefixedURL","expandPrefixed","index","validIDString","stripOptionalPath","bit","TerminusRule","WOQLRule","pattern","WOQLPattern","TerminusPattern","constructor","setVariables","variables","addNamespacesToVariables","current_variable","constraints","list","filter","tester","match","literal","test","source","target","k","constraint","vundertest","getMatchingRules","rules","row","matches","prettyPrint","removeNamespacesFromVariables","tf","mjson","njson","setPattern","IDsMatch","compareIDs","classIDsMatch","propertyIDsMatch","rangeIDsMatch","valuesMatch","vala","valb","numberMatch","eval","stringMatch","RegExp","FrameRule","FramePattern","testRules","frame","onmatch","matched_rules","patternMatchesFrame","checkFrame","frame_type","label","subject","subjectClass","range","parent","par","children","depth","rtype","getRendererType","illegalRuleType","checkFrameType","checkLabel","checkSubject","checkSubjectClass","checkProperty","checkDepth","checkRange","checkValue","checkParent","checkChildren","checkIndex","checkStatus","unpack","arr","nonstring","frameType","kids","rsubj","found","properties","renderer","values","isUpdated","isNew","rcls","ftype","getLabel","isProperty","isData","renderer_type","TerminusDocument","WOQLResult","WOQL","axios","btoaImplementation","Buffer","from","options","post","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","Uint8Array","__proto__","arg","encodingOrOffset","allocUnsafe","TypeError","array","byteOffset","byteLength","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","write","fromString","len","checked","copy","fromObject","assertSize","size","loweredCase","utf8ToBytes","base64ToBytes","slowToString","start","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","dir","isNaN","arrayIndexOf","indexSize","arrLength","valLength","String","buf","readUInt16BE","foundIndex","hexWrite","offset","Number","remaining","strLen","substr","utf8Write","blitBuffer","asciiWrite","byteArray","charCodeAt","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","min","res","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","MAX_ARGUMENTS_LENGTH","fromCharCode","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","subarray","typedArraySupport","poolSize","_augment","species","configurable","fill","allocUnsafeSlow","_isBuffer","compare","x","y","concat","pos","swap16","swap32","swap64","equals","inspect","max","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","out","toHex","bytes","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","floor","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","set","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","stringtrim","base64clean","src","dst","g","Function","b64","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","num","output","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","Axios","mergeConfig","createInstance","defaultConfig","instance","instanceConfig","CancelToken","isCancel","all","promises","spread","default","InterceptorManager","dispatchRequest","interceptors","chain","interceptor","unshift","fulfilled","rejected","shift","getUri","handlers","use","eject","id","h","transformData","isAbsoluteURL","combineURLs","throwIfCancellationRequested","throwIfRequested","baseURL","reason","fns","normalizedName","isAxiosError","description","number","fileName","lineNumber","columnNumber","stack","ignoreDuplicateOf","line","originURL","msie","userAgent","urlParsingNode","createElement","resolveURL","setAttribute","protocol","host","search","hash","hostname","port","pathname","requestURL","expires","path","domain","secure","cookie","toGMTString","decodeURIComponent","remove","now","relativeURL","executor","resolvePromise","token","callback","FrameHelper","client","ObjectFrame","dataframes","classframes","parentframe","empty","loadClassFrames","originalFrames","loadDataFrames","newDoc","PropertyFrame","cframe","predicate","DataFrame","subjid","load","ClassFrame","Restriction","restriction","loadRestriction","loadDocument","loadJSON","loadSchema","ncls","loadSchemaFrames","loadComplete","loadDocumentSchema","clsid","TerminusClient","fillFromSchema","render","applyRulesToDocument","nconfig","rule","loadRenderer","setFrameDisplayOptions","jsonld_context","cf","isValid","hasSchema","frames","domainValue","getPropertyClassFrame","isClassChoice","getChosenClassFrame","isLogic","getChosenFrame","addFrame","getAsFrame","ff","getAsFrames","restrictions","reset","props","clear","ignore_failure","getProperties","filled","missing","getMissingPropertyList","nmissing","newb","getFilledPropertyList","newid","genBNID","pf","clone","cloned","getChild","childid","pframe","getProperty","addProperty","createEmpty","createEmptyChoice","clss","getClassChoices","df","addPropertyValue","addValue","removeProperty","removePropertyValue","removeValue","first","parentObject","root","renderProperties","sortProperties","nprops","rend","unsorted","sort","standardCompare","cardControlAllows","hasRestriction","rest","currentnum","getSummary","propcount","kid","nframe","extract","extracts","updated","childUpdated","getComment","hasCardinalityRestriction","getRestriction","deletePropertyValue","gets","cvalues","fs","renderValues","sortedVals","sortValues","rangeValue","comment","save","originalValue","nrend","setNew","isValidType","dt","hasCardRestriction","lab","labelFromURL","getType","isObjectProperty","isDatatypeProperty","isRestriction","isDocument","isChoice","getStdURL","getChoiceOptions","elements","option","lang","getTypeShorthand","contents","normalizer","loadFromObjectFrame","child","getChosenClassFrames","objframe","chosen","nc","operands","dataframe","cloneDataFrame","other","choices","domcls","operand","cardinality","maxCardinality","minCardinality","nrest","results","query","bindings","cursor","no_compress","compress","getContext","nprop","shorten","nval","hasBindings","count","getBindings","getVariableList","last","next","prev","asc_or_desc","compareValues","WOQLQuery","chain_ended","contains_update","paging_transitive_properties","vocab","loadDefaultVocabulary","tripleBuilder","nspaces","spaces","TripleBuilder","when","Query","Update","opt","into","or","and","not","triple","quad","isa","eq","JSON_or_IRI","delete_triple","S","P","O","delete_quad","G","add_triple","add_quad","cols","as","vari","remote","file","order_by","gvarlist","asc","varlist_or_var","desc","group_by","groupedvar","groupquery","Q","lower","u","pad","input","unique","idgen","typecast","vara","varb","cast","re","less","v1","v2","greater","arith","plus","minus","times","divide","exp","div","var1","star","add_class","classid","graph","add_property","propid","delete_class","delete_property","node","nodeid","insert","Node","Type","Graph","cleanType","doctype","arr1","arr2","buildAsClauses","clauses","va","vb","ordering","advanceCursor","sq","nlist","nvalue","upd","queries","cleanSubject","cleanPredicate","cleanObject","chainable","cleanGraph","cleanClass","last_index","varname","lastUpdate","Subject","Predicate","Object_or_Literal","chainableUpdate","adding_class","asArray","card","addPO","pn","entity","relationship","nwoql","GraphIRI","Subj","Pred","Obj","getEverything","getAllDocuments","documentMetadata","concreteDocumentClasses","propertyMetadata","elementMetadata","classMetadata","getDataOfClass","getDataOfProperty","documentProperties","getDocumentConnections","getInstanceMeta","simpleGraphQuery","loadVocabulary","execute","spl","setVocabulary","getVocabulary","getLimit","getPagingProperty","setLimit","setPagingProperty","isPaged","getPage","psize","hasStart","getStart","setPage","pagenum","pstart","setStart","addStart","nextPage","firstPage","previousPage","npage","setPageSize","hasSelect","getSelectVariables","nq","defaultContext","DB_IRI","def","scm","subj","pageprop","indent","show_context","fluent","newlining_operators","operator","getWOQLPrelude","isChainable","uncleanArguments","inline","lastArg","hasShortcut","getShortcut","argIsSubQuery","myas","lhs","rhs","uncleanArgument","allArgs","unclean","cstr","oval","uncleanObjectArgument","nstr","part","suff","printLine","ttype","evstr","unit","addEntry","getO","clause","alert","which","os","od","tb"],"mappings":"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","file":"terminus-client.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n","'use strict';\n\nvar bind = require('./helpers/bind');\nvar isBuffer = require('is-buffer');\n\n/*global toString:true*/\n\n// utils is a library of generic helper functions non-specific to axios\n\nvar toString = Object.prototype.toString;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nfunction isArray(val) {\n  return toString.call(val) === '[object Array]';\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nfunction isArrayBuffer(val) {\n  return toString.call(val) === '[object ArrayBuffer]';\n}\n\n/**\n * Determine if a value is a FormData\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nfunction isFormData(val) {\n  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n}\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  var result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nfunction isString(val) {\n  return typeof val === 'string';\n}\n\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nfunction isNumber(val) {\n  return typeof val === 'number';\n}\n\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nfunction isObject(val) {\n  return val !== null && typeof val === 'object';\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Date, otherwise false\n */\nfunction isDate(val) {\n  return toString.call(val) === '[object Date]';\n}\n\n/**\n * Determine if a value is a File\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a File, otherwise false\n */\nfunction isFile(val) {\n  return toString.call(val) === '[object File]';\n}\n\n/**\n * Determine if a value is a Blob\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nfunction isBlob(val) {\n  return toString.call(val) === '[object Blob]';\n}\n\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nfunction isFunction(val) {\n  return toString.call(val) === '[object Function]';\n}\n\n/**\n * Determine if a value is a Stream\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nfunction isStream(val) {\n  return isObject(val) && isFunction(val.pipe);\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n * @returns {String} The String freed of excess whitespace\n */\nfunction trim(str) {\n  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n}\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n */\nfunction isStandardBrowserEnv() {\n  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||\n                                           navigator.product === 'NativeScript' ||\n                                           navigator.product === 'NS')) {\n    return false;\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined'\n  );\n}\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n */\nfunction forEach(obj, fn) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (var i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        fn.call(null, obj[key], key, obj);\n      }\n    }\n  }\n}\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = merge(result[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Function equal to merge with the difference being that no reference\n * to original objects is kept.\n *\n * @see merge\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction deepMerge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (typeof result[key] === 'object' && typeof val === 'object') {\n      result[key] = deepMerge(result[key], val);\n    } else if (typeof val === 'object') {\n      result[key] = deepMerge({}, val);\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n * @return {Object} The resulting value of object a\n */\nfunction extend(a, b, thisArg) {\n  forEach(b, function assignValue(val, key) {\n    if (thisArg && typeof val === 'function') {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  });\n  return a;\n}\n\nmodule.exports = {\n  isArray: isArray,\n  isArrayBuffer: isArrayBuffer,\n  isBuffer: isBuffer,\n  isFormData: isFormData,\n  isArrayBufferView: isArrayBufferView,\n  isString: isString,\n  isNumber: isNumber,\n  isObject: isObject,\n  isUndefined: isUndefined,\n  isDate: isDate,\n  isFile: isFile,\n  isBlob: isBlob,\n  isFunction: isFunction,\n  isStream: isStream,\n  isURLSearchParams: isURLSearchParams,\n  isStandardBrowserEnv: isStandardBrowserEnv,\n  forEach: forEach,\n  merge: merge,\n  deepMerge: deepMerge,\n  extend: extend,\n  trim: trim\n};\n","/**\n * @file Terminus Client Utility Functions\n * @license Apache Version 2\n * @summary Object for bunding up common Terminus Utility Functions \n */\nconst Utils = {}\n\n\n/**\n * default set of prefixes that will be used for URL compression\n */\nUtils.standard_urls = {\n\trdf: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#',\n\trdfs: 'http://www.w3.org/2000/01/rdf-schema#',\n\txsd: 'http://www.w3.org/2001/XMLSchema#',\n\towl: 'http://www.w3.org/2002/07/owl#',\n\ttcs: 'http://terminusdb.com/schema/tcs#',\n\txdd: 'http://terminusdb.com/schema/xdd#',\n\tv: 'http://terminusdb.com/woql/variable/',\n\tterminus: 'http://terminusdb.com/schema/terminus#',\n\tvio: 'http://terminusdb.com/schema/vio#'\n}\n\n/**\n * @summary Encode document payload for GET  \n */\nUtils.URIEncodePayload = function(payload) {\n\tif (typeof payload === 'string') return encodeURIComponent(payload);\n\tconst payloadArr = [];\n\tfor (const key of Object.keys(payload)) {\n\t\tif (typeof payload[key] === 'object') {\n\t\t\tfor (const keyElement of Object.keys(payload[key])) {\n\t\t\t\t const valueElement = payload[key][keyElement];\n\t\t\t\t payloadArr.push(`${encodeURIComponent(keyElement)}=${encodeURIComponent(valueElement)}`);\n\t\t\t}\n\t\t} else {\n\t\t\tpayloadArr.push(`${encodeURIComponent(key)}=${encodeURIComponent(payload[key])}`);\n\t\t}\n\t}\n\treturn payloadArr.join('&');\n}\n\n\n\n/**\n * @summary Adds an entry to the list of known standard URL prefixes \n */\nUtils.addURLPrefix = function (prefix, url) {\n\tthis.standard_urls[prefix] = url;\n};\n\n\n/**\n * is the object empty? \n * returns true if the json object is empty \n */\nUtils.empty = function (obj) {\n\t   // null and undefined are \"empty\"\n\tif (!obj) return true;\n\t// Assume if it has a length property with a non-zero value\n\t// that that property is correct.\n\tif (obj.length > 0) return false;\n\tif (obj.length === 0) return true;\n\t// Otherwise, does it have any properties of its own?\n\t// Note that this doesn't handle\n\t// toString and valueOf enumeration bugs in IE < 9\n\t// for (const key in obj) {\n\tif (typeof obj === 'object') {\n\t\tfor (const key of Object.keys(obj)) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) return false;\n\t\t}\n\t}\n\treturn true;\n};\n\n/**\n * Generates a unique blank node id \n */\nUtils.genBNID = function () {\n\tconst r = Math.random().toString(36).substring(7);\n\tconst d = new Date();\n\tconst bnid = `_:${r}${d.getTime()}`;\n\treturn bnid;\n};\n\n/**\n * Returns the shorthand version (compressed to prefix:id ) of a url or false if there is none known for that URL\n */\nUtils.getShorthand = function (link) {\n\tif (typeof link === 'object' && link.length) link = link[0];\n\tif (link && typeof link === 'string') {\n\t\tfor (const pref of Object.keys(this.standard_urls)) {\n\t\t\tconst full = this.standard_urls[pref];\n\t\t\tif (link.substring(0, full.length) === full) {\n\t\t\t\tconst sh = `${pref}:${link.substring(full.length)}`;\n\t\t\t\treturn sh;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n\n/**\n * Compares 2 IRIs for equality by checking compressed and expanded versions of both sides\n */\nUtils.compareIDs = function (ida, idb) {\n\tif (ida === idb) return true;\n\tif (this.unshorten(ida) === idb) return true;\n\tif (this.unshorten(ida) === this.unshorten(idb)) return true;\n\tconst sha = this.getShorthand(ida);\n\tconst shb = this.getShorthand(idb);\n\tif (sha && ((sha === idb) || (sha === shb))) return true;\n\tif (shb && shb === ida) return true;\n\treturn false;\n};\n\n\n/**\n * Shortens a URL to its compressed format - returns the full URL if not possible\n */\nUtils.shorten = function (url, prefixes) {\n\tprefixes = prefixes || this.standard_urls;\n\tfor (const pref in prefixes) {\n\t\tif (prefixes[pref] == url.substring(0, prefixes[pref].length)) {\n\t\t\treturn (`${pref}:${url.substring(prefixes[pref].length)}`);\n\t\t}\n\t}\n\treturn url;\n};\n\n/**\n * Expands a URL to its full URL format - returns the passed string if not possible to expand\n */\nUtils.unshorten = function (url) {\n\tif (this.validURL(url)) return url;\n\tif (!url) return url;\n\tconst bits = url.split(':');\n\tif (bits[1]) {\n\t\tif (this.standard_urls[bits[0]]) {\n\t\t\treturn this.standard_urls[bits[0]] + bits[1];\n\t\t}\n\t}\n\treturn url;\n};\n\n/**\n * Tests a string to see if it is a valid URL - \n * Valid URLs are those that start with http:// or https://\n */\nUtils.validURL = function (str) {\n\tif (str && (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://')) return true;\n\treturn false;\n};\n\n\n/**\n * Generates a text label from a URL\n */\nUtils.labelFromURL = function (url) {\n\tlet nurl = this.urlFragment(url);\n\tnurl = (nurl || url);\n\tif (nurl.lastIndexOf('/') < nurl.length - 1) {\n\t\tnurl = nurl.substring(nurl.lastIndexOf('/') + 1);\n\t}\n\tnurl = nurl.replace(/_/g, ' ');\n\treturn nurl.charAt(0).toUpperCase() + nurl.slice(1);\n};\n\n/**\n * returns the fragment part of a URL (whether compressed or not)\n */\nUtils.urlFragment = function (url) {\n\turl = (typeof url !== 'string') ? window.location.href : url;\n\tlet bits = url.split('#');\n\tif (bits.length <= 1) {\n\t\tif (!this.validURL(url)) {\n\t\t\tbits = url.split(':');\n\t\t}\n\t}\n\tif (bits.length >= 1) {\n\t\tconst [, urlStr] = bits;\n\n\t\tif (urlStr) {\n\t\t\tconst [baseUrl] = urlStr.split('?');\n\t\t\turl = baseUrl;\n\t\t}\n\t}\n\treturn url;\n};\n\n/**\n * returns the last part of a URL after the last /\n */\nUtils.lastURLBit = function (url) {\n\turl = (typeof url === 'undefined') ? window.location.href : url;\n\tconst [urlFirst] = url.split('#');\n\tconst [urlTmp] = urlFirst.split('?');\n\turl = urlTmp.substring(url.lastIndexOf('/') + 1);\n\treturn url;\n};\n\n/**\n * returns the a standard URL associated with a given prefix and extension\n */\nUtils.getStdURL = function (pref, ext, url) {\n\tif (this.standard_urls[pref]) {\n\t\tif (url) {\n\t\t\tif (url === this.standard_urls[pref] + ext) return url;\n\t\t} else {\n\t\t\treturn this.standard_urls[pref] + ext;\n\t\t}\n\t}\n\treturn false;\n};\n\n/*\n * Utility function adds v: to variables...\n */\nUtils.addNamespacesToVariables = function(vars){\n\tvar nvars = [];\n\tfor(var i = 0; i<vars.length; i++){\n\t\tnvars.push(this.addNamespaceToVariable(vars[i]));\t\t\n\t}\n\treturn nvars;\n}\n\nUtils.addNamespaceToVariable = function(v){\n\tif (v.substring(0, 2) != \"v:\") return \"v:\" + v;\n\treturn v;\n}\n\n/*\n * Utility function removes v: prefix from a variable...\n */\nUtils.removeNamespaceFromVariable = function(mvar){\n\tif(mvar.substring(0, 2) == \"v:\") return mvar.substring(2)\n\treturn mvar;\n}\n\n/*\n * Utility function removes v: prefix from an array of variables\n */\nUtils.removeNamespacesFromVariables = function(vars){\n\tvar nvars = [];\n\tfor(var i = 0; i<vars.length; i++){\n\t\tnvars.push(this.removeNamespaceFromVariable(vars[i]));\n\t}\n\treturn nvars;\n}\n\n/**\n * TypeHelper bundles together utility functions dealing with datatypes\n */\nUtils.TypeHelper = {};\n\n/**\n * Returns true if the passed type is an xsd:string (compressed or not)\n */\nUtils.TypeHelper.isStringType = function (stype) {\n\tif (stype === 'http://www.w3.org/2001/XMLSchema#string') return true;\n\tif (stype === 'xsd:string') return true;\n\treturn false;\n};\n\n/** \n * Adds 3 order magnitude separators ( default ,) into big numbers for legibility\n */\nUtils.TypeHelper.numberWithCommas = function (value, separator) {\n\tseparator = separator || \",\";\n\tif (value >= 1000 || value <= -1000) {\n\t    const parts = value.toString().split('.');\n\t    if (value <= -1000) parts[0] = parts[0].substring(1);\n\t    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, separator);\n\t    if (value <= -1000) value = `-${parts.join('.')}`;\n\t    else value = parts.join('.');\n\t}\n\treturn value;\n};\n\n/**\n * List of supported datatypes\n */\nUtils.TypeHelper.datatypes = [\n\t'xdd:coordinate', 'xdd:coordinatePolyline',\n\t'xdd:coordinatePolygon', 'xdd:dateRange', 'xdd:gYearRange', 'xdd:integerRange',\n\t'xdd:decimalRange', 'xdd:cc', 'xdd:email', 'xdd:html', 'xdd:url', 'xsd:anySimpleType',\n\t'xsd:string', 'xsd:boolean', 'xsd:decimal', 'xsd:double', 'xsd:float', 'xsd:time', 'xsd:date',\n\t'xsd:dateTime', 'xsd:dateTimeStamp', 'xsd:gYear', 'xsd:gMonth', 'xsd:gDay', 'xsd:gYearMonth',\n\t'xsd:gMonthDay', 'xsd:duration', 'xsd:yearMonthDuration', 'xsd:dayTimeDuration',\n\t'xsd:byte', 'xsd:short', 'xsd:integer', 'xsd:long', 'xsd:unsignedByte',\t'xsd:unsignedInt',\n\t'xsd:unsignedLong',\t'xsd:nonNegativeInteger', 'xsd:positiveInteger', 'xsd:negativeInteger',\n\t'xsd:nonPositiveInteger', 'xsd:base64Binary', 'xsd:anyURI', 'xsd:language', 'xsd:normalizedString',\n\t'xsd:token', 'xsd:NMTOKEN',\t'xsd:Name',\t'xsd:NCName', 'xsd:NOTATION', 'xsd:QName', 'xsd:ID',\n\t'xsd:IDREF', 'xsd:ENTITY', 'rdf:XMLLiteral', 'rdf:PlainLiteral', 'rdfs:Literal', 'xdd:json'\n];\n\nUtils.TypeHelper.parseRangeValue = function (val, dividor) {\n\tdividor = (dividor || ',');\n\tlet vals = [];\n\tif (typeof val === 'object' && val.length) {\n\t\tvals = val;\n\t} else if (val) {\n\t\tif (typeof val !== 'string') {\n\t\t\tval = `${val}`;\n\t\t}\n\t\tif (val.length && (val.charAt(0) === '[') && val.charAt(val.length - 1) === ']') {\n\t\t\tvals.push(val.substring(1, val.indexOf(dividor)));\n\t\t\tvals.push(val.substring(val.indexOf(dividor) + 1, val.length - 1));\n\t\t} else {\n\t\t\tvals.push(val);\n\t\t}\n\t}\n\treturn vals;\n};\n\n/**\n * DateHelper bundles together utility functions dealing with xsd date types\n */\nUtils.DateHelper = {};\n\n/**\n * Takes an xsd time string and returns a structure {hour: HH, minute: MM, second ss.ssssss, timezone: tz}\n */\nUtils.DateHelper.parseXsdTime = function (val) {\n\tif (!val) return {};\n\tconst tz = this.extractXsdTimezone(val);\n\tif (tz) {\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tconst parsed = {\n\t\thour: val.substring(0, 2),\n\t\tminute: val.substring(3, 5),\n\t\tsecond: val.substring(6),\n\t\ttimezone: tz\n\t};\n\treturn parsed;\n};\n\n/**\n * Takes an xsd time string and returns a structure {year: [-]YYYY, month: MM, day: dd}\n */\nUtils.DateHelper.parseXsdDate = function (val) {\n\tconst tz = this.extractXsdTimezone(val);\n\tif (tz) {\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tlet year;\n\tif (val.substring(0, 1) === '-') {\n\t\tyear = val.substring(0, 5);\n\t} else {\n\t\tyear = val.substring(0, 4);\n\t}\n\tlet parsed;\n\tif (year && Math.abs(year) < 10000) {\n\t\tlet month = val.substring(year.length + 1, year.length + 3);\n\t\tif (month) { month = parseInt(month, 10); } else return false;\n\t\tlet day = val.substring(year.length + 4);\n\t\tif (day) day = parseInt(day, 10);\n\t\telse return false;\n\t\tparsed = {\n\t\t\tyear,\n\t\t\t   month,\n\t\t\t   day,\n\t\t\t   timezone: tz\n\t\t};\n\t}\n\treturn parsed;\n};\n\n/**\n * Parses a date string of type ty\n */\nUtils.DateHelper.parseDate = function (ty, value) {\n\tlet parsed;\n\tif (ty === 'xsd:date') {\n\t\tparsed = this.parseXsdDate(value);\n\t} else if (ty === 'xsd:time') {\n\t\tparsed = this.parseXsdTime(value);\n\t} else if (ty === 'xsd:dateTime') {\n\t\tparsed = this.parseXsdDateTime(value);\n\t} else if (ty === 'xsd:gYear') {\n\t\tparsed = { year: value };\n\t} else if (ty === 'xsd:gYearRange') {\n\t\tparsed = { year: value };\n\t} else if (ty === 'xsd:gMonth') {\n\t\tparsed = { month: value.substring(2) };\n\t} else if (ty === 'xsd:gDay') {\n\t\tparsed = { day: value };\n\t} else if (ty === 'xsd:gYearMonth') {\n\t\tconst bits = value.split('-');\n\t\twhile (bits.length < 2) bits.push('');\n\t\tparsed = { year: bits[0], month: bits[1] };\n\t} else if (ty === 'xsd:gMonthDay') {\n\t\tconst bits = value.split('-');\n\t\twhile (bits.length < 2) bits.push('');\n\t\tparsed = { month: bits[0], day: bits[1] };\n\t} else if (ty === 'xsd:dateTimeStamp') {\n\t\tparsed = this.parseXsdDateTime(value);\n\t}\n\treturn parsed;\n};\n\n/**\n * adds appropriate padding to date type for xsd rules\n */\nUtils.DateHelper.addXsdPadding = function (parsed) {\n\tconst nparsed = {};\n\tif (typeof parsed.year !== 'undefined' && parsed.year !== false && parsed.year < 1000) {\n\t\tif (Math.abs(parsed.year) < 10) nparsed.year = (parsed.year < 0 ? `-000${Math.abs(parsed.year)}` : `000${parsed.year}`);\n\t\telse if (Math.abs(parsed.year) < 100) nparsed.year = (parsed.year < 0 ? `-00${Math.abs(parsed.year)}` : `00${parsed.year}`);\n\t\telse nparsed.year = (parsed.year < 0 ? `-0${Math.abs(parsed.year)}` : `0${parsed.year}`);\n\t} else if (parsed.year) {\n\t\tnparsed.year = parsed.year;\n\t}\n\tif (typeof parsed.month !== 'undefined' && parsed.month !== false && parsed.month < 10) {\n\t\tnparsed.month = `0${parsed.month}`;\n\t} else if (parsed.month) {\n\t\tnparsed.month = parsed.month;\n\t}\n\tif (typeof parsed.day !== 'undefined' && parsed.day !== false && parsed.day < 10) {\n\t\tnparsed.day = `0${parsed.day}`;\n\t} else if (parsed.day) {\n\t\tnparsed.day = parsed.day;\n\t}\n\tif (typeof parsed.hour !== 'undefined' && parsed.hour !== false && parsed.hour < 10) {\n\t\tnparsed.hour = `0${parsed.hour}`;\n\t} else if (parsed.hour) {\n\t\tnparsed.hour = parsed.hour;\n\t}\n\tif (typeof parsed.minute !== 'undefined' && parsed.minute !== false && parsed.minute < 10) {\n\t\tnparsed.minute = `0${parsed.minute}`;\n\t} else if (parsed.minute) {\n\t\tnparsed.minute = parsed.minute;\n\t}\n\tif (typeof parsed.second !== 'undefined' && parsed.second !== false && parsed.second < 10) {\n\t\tnparsed.second = `0${parsed.second}`;\n\t} else if (parsed.second) {\n\t\tnparsed.second = parsed.second;\n\t}\n\treturn nparsed;\n};\n\n/**\n * generates an xsd string of type ty for the passed parsed structure (year, month, day, hour, minute, second, timezone)\n */\nUtils.DateHelper.xsdFromParsed = function (parsed, ty) {\n\tconst xparsed = this.addXsdPadding(parsed);\n\tlet ret;\n\tif (ty === 'xsd:gYear') {\n\t\tret = (xparsed.year ? xparsed.year : false);\n\t} else if (ty === 'xsd:time') {\n\t\treturn (xparsed.hour && xparsed.minute && xparsed.second) ? `${xparsed.hour}:${xparsed.minute}:${xparsed.second}` : false;\n\t} else if (ty === 'xsd:date') {\n\t\treturn (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}` : false;\n\t} else if (ty === 'xsd:dateTime' || ty === 'xsd:dateTimeStamp') {\n\t\tret = (xparsed.year && xparsed.month && xparsed.day) ? `${xparsed.year}-${xparsed.month}-${xparsed.day}T` : false;\n\t\tif (ret) ret += `${xparsed.hour ? xparsed.hour : '12'}:${xparsed.minute ? xparsed.minute : '00'}:${xparsed.second ? xparsed.second : '00'}`;\n\t} else if (ty === 'xsd:gMonth') {\n\t\tret = (xparsed.month ? `--${xparsed.month}` : false);\n\t} else if (ty === 'xsd:gDay') {\n\t\tret = (xparsed.day ? `---${xparsed.day}` : false);\n\t} else if (ty === 'xsd:gYearMonth') {\n\t\tret = (xparsed.year && xparsed.month) ? `${xparsed.year}-${xparsed.month}` : false;\n\t} else if (ty === 'xsd:gMonthDay') {\n\t\tret = (xparsed.day && xparsed.month) ? `--${xparsed.month}-${xparsed.day}` : false;\n\t}\n\tif (xparsed.timezone) {\n\t\tret += xparsed.timezone;\n\t}\n\treturn ret;\n};\n\n/**\n * Converts between a unix timestamp and a parsed structure \n */\nUtils.DateHelper.convertTimestampToXsd = function (val) {\n\t  const a = new Date(val * 1000);\n\t  const parsed = {\n\t\tyear: a.getFullYear(),\n\t\tmonth: a.getMonth() + 1,\n\t\tday: a.getDate(),\n\t\thour: a.getHours(),\n\t\tminute: a.getMinutes(),\n\t\tsecond: a.getSeconds()\n\t  };\n\t  return parsed;\n};\n\n/**\n * Parses an xsd date time into a structure\n */\nUtils.DateHelper.parseXsdDateTime = function (val) {\n\tif (!val) return {};\n\tif (typeof val === 'number') {\n\t\treturn this.convertTimestampToXsd(val);\n\t}\n\tconst tz = this.extractXsdTimezone(val);\n\tif (tz) {\n\t\tval = val.substring(0, val.length - tz.length);\n\t}\n\tconst datetime = this.parseXsdDate(val);\n\tconst ptime = this.parseXsdTime(val.substring(val.indexOf('T') + 1));\n\n\tfor (const i of Object.keys(ptime)) {\n\t\tdatetime[i] = ptime[i];\n\t}\n\tdatetime.timezone = tz;\n\treturn datetime;\n};\n\n/**\n * Extracts the timezone data from an xsd date string\n */\nUtils.DateHelper.extractXsdTimezone = function (val) {\n\tif (val && val.charAt(val.length - 1) === 'Z') {\n\t\treturn 'Z';\n\t}\n\tif (val && (val.charAt(val.length - 6) === '+' || val.charAt(val.length - 6) === '-')) {\n\t\tval.substring(val.length - 6);\n\t}\n\treturn false;\n};\n\nmodule.exports = Utils;\n\n\n","function getErrorAsMessage(url, api, err) {\n\t// console.log('getErrorAsMessage');\n\tlet str = '';\n\tif (err.response) {\n\t\terr = err.response;\n\t\tif (err.data) str += `${formatErrorMessage(err.data)}`;\n\t} else if (err.body) str += `${formatErrorMessage(err.data)}`;\n\n\tif (err.status) str += `Code: ${err.status}`;\n\tif (err.action) str += `, Action: ${err.action}`;\n\tif (err.type) str += `, Type: ${err.type}`;\n\tif (url) str += `, url: ${url}`;\n\tif (api && api.method) str += `, method: ${api.method}`;\n\treturn str;\n}\n\nfunction formatErrorMessage(msg) {\n\tif (typeof msg === 'object') {\n\t\tlet nmsg = '';\n\t\tfor (const key of Object.keys(msg)) {\n\t\t\tnmsg += `${key} ${msg[key]} `;\n\t\t}\n\t\treturn nmsg;\n\t}\n\treturn msg;\n}\n\nfunction accessDenied(action, db, server) {\n\tconst err = {};\n\terr.status = 403;\n\terr.url = (server || '') + (db || '');\n\terr.type = 'client';\n\terr.action = action;\n\terr.body = `${err.action} not permitted for ${err.url}`;\n\treturn err;\n}\n\nfunction getAPIErrorMessage(url, api, err) {\n\treturn `API Error ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getAccessDeniedMessage(url, api, err) {\n\treturn `Access Denied ${getErrorAsMessage(url, api, err)}`;\n}\n\nfunction getInvalidURIMessage(url, call) {\n\tconst str = `Invalid argument to\n            ${call}. \n            ${url}\n            is not a valid Terminus DB API endpoint`;\n\treturn str;\n}\n\n/**\n * Utility functions for generating and retrieving error messages\n * and storing error state\n */\n\nfunction parseAPIError(response) {\n\tconst err = {};\n\terr.status = response.status;\n\terr.type = response.type;\n\tif (response.data && typeof response.data === 'object') {\n\t\tlet msg;\n\t\ttry {\n\t\t\tmsg = response.text();\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tmsg = response.json();\n\t\t\t} catch (error) {\n\t\t\t\tmsg = response.toString();\n\t\t\t}\n\t\t}\n\t\terr.body = msg;\n\t} else if (response.data) err.body = response.data;\n\terr.url = response.url;\n\terr.headers = response.headers;\n\terr.redirected = response.redirected;\n\treturn err;\n}\n\n\nmodule.exports = {\n\tgetErrorAsMessage,\n\tgetAPIErrorMessage,\n\tgetAccessDeniedMessage,\n\taccessDenied,\n\tgetInvalidURIMessage,\n\tparseAPIError\n};\n","/**\n * @file Terminus Constants\n * @license Apache Version 2\n * @summary Constants representing API actions\n */\n\nmodule.exports = Object.freeze({\n\tCONNECT: 'connect',\n\tGET_SCHEMA: 'get_schema',\n\tUPDATE_SCHEMA: 'update_schema',\n\tUPDATE_DOCUMENT: 'update_document',\n\tCLASS_FRAME: 'class_frame',\n\tWOQL_SELECT: 'woql_select',\n\tGET_DOCUMENT: 'get_document',\n\tDELETE_DATABASE: 'delete_database',\n\tDELETE_DOCUMENT: 'delete_document',\n\tCREATE_DATABASE: 'create_database',\n\tCREATE_DOCUMENT: 'create_document',\n\tWOQL_UPDATE: 'woql_update'\n});\n","/**\n * @file Javascript WOQL client object\n * @license Apache Version 2\n * @summary Simple Javascript Client for accessing the Terminus DB API\n */\n\nconst CONST = require('./const');\nconst DispatchRequest = require('./dispatchRequest');\nconst ErrorMessage = require('./errorMessage');\nconst ConnectionCapabilities = require('./connectionCapabilities');\nconst ConnectionConfig = require('./connectionConfig');\nconst UTILS = require('./utils.js');\n\n/**\n  * Constructor - takes an option json list of connection parameters\n  * @param {Object} params a json object containing connection parameters\n  * which can be: \n  * params.server URL of server to connect to\n  *\tparams.dbid ID of database to connect to\n  * params.docid = ID of document to load;\n*/\nfunction WOQLClient(params) {\n\t// current connection context variables\n\tconst key = (params && params.key) ? params.key : undefined;\n\tthis.use_fetch = false;\n\tthis.return_full_response = false;\n\tthis.connectionConfig = new ConnectionConfig(params);\n\tthis.connection = new ConnectionCapabilities(this.connectionConfig, key);\n}\n\nWOQLClient.CONST = CONST;\n\n/**\n * Connect to a Terminus server at the given URI with an API key\n * Stores the terminus:ServerCapability document returned\n * in the connection register which stores, the url, key, capabilities,\n * and database meta-data for the connected server\n *\n * If the curl argument is false or null,\n * this.connectionConfig.server will be used if present,\n * or the promise will be rejected.\n\n * @param  {string} curl Terminus server URI\n * @param  {string} [key] API  key\n * @param  {string} [dbid] Optional DB to connect to by default\n * @return {Promise}\n * @public\n */\nWOQLClient.prototype.connect = function (curl, key, dbid) {\n\tif (curl && !this.connectionConfig.setServer(curl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(curl, CONST.CONNECT))\n\t\t);\n\t}\n\tconst serverURL = this.connectionConfig.serverURL();\n\tif (key) {\n\t\tthis.connection.setClientKey(serverURL, key);\n\t}\n\t// unset the current server setting until successful connect\n\tthis.connectionConfig.server = false;\n\treturn this.dispatch(serverURL, CONST.CONNECT)\n\t.then((response) => {\n\t    this.connectionConfig.server = serverURL;\n\t    if(dbid) this.connectionConfig.dbid = dbid;\n\t    this.connection.addConnection(serverURL, response);\n\t    return response;\n\t});\n};\n\n/**\n * Create a Terminus Database by posting\n * a terminus:Database document to the Terminus API\n *\n * The dburl argument can be\n *    1) a valid URL of a terminus database or\n *    2) a valid Terminus database id or\n *    3) can be omitted\n * \t\tin case 2) the current server will be used,\n * \t\tin case 3) the database id will be set from the @id field of the terminuse:Database document.\n *\n * The second (details) argument contains a terminus:Database document\n * with a mandatory rdfs:label field and an optional rdfs:comment field.\n * The third (key) argument contains an optional API key\n *\n * @param {string} dburl Terminus server URI or a TerminusID\n * @param {object} details\n * @param {string} key\n * @return {Promise}\n * @public\n */\nWOQLClient.prototype.createDatabase = function (dburl, details, key) {\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Create Database'))\n\t\t);\n\t}\n\tif (\n\t\tdetails\n    && details['@id']\n    && !this.connectionConfig.setDB(details['@id'], details['@context'])\n\t) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(details['@id'], 'Create Database'))\n\t\t);\n\t}\n\tdetails = this.makeDocumentConsistentWithURL(details, this.connectionConfig.dbURL());\n\n\tconst opts = {};\n\tif (key) {\n\t\topts.key = key;\n\t}\n\tconst doc = this.addOptionsToDocument(details, opts);\n\treturn this.dispatch(this.connectionConfig.dbURL('create'), CONST.CREATE_DATABASE, doc);\n};\n\n/**\n * Delete a Database\n * @param {String} dburl it is a terminusDB Url or a terminusDB Id\n * @param {String} key an optional API key\n * @return {Promise}\n *\n * if dburl is omitted, the current server and database will be used\n */\nWOQLClient.prototype.deleteDatabase = function (dburl, key) {\n\tif (dburl && !this.connectionConfig.setDB(dburl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(dburl, 'Delete Database'))\n\t\t);\n\t}\n\tconst opts = {};\n\n\tif (key) {\n\t\topts.key = key;\n\t}\n\n\tconst self = this;\n\treturn this.dispatch(`${this.connectionConfig.dbURL()}`, CONST.DELETE_DATABASE, opts).then(\n\t\t(response) => {\n\t\t\tself.connection.removeDB();\n\t\t\treturn response;\n\t\t}\n\t);\n};\n\n/**\n * Retrieves the schema of the specified database\n *\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\n * @param {object} opts is an options object\n * @return {Promise}\n *\n * opts.format is optional and defines which format is requested (*json / turtle)\n * opts.key is an optional API key\n */\nWOQLClient.prototype.getSchema = function (schurl, opts) {\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Get Schema'))\n\t\t);\n\t}\n\t// consoleco.log('schemaURL', this.connectionConfig.schemaURL());\n\treturn this.dispatch(this.connectionConfig.schemaURL(), CONST.GET_SCHEMA, opts);\n};\n\n/**\n * Updates the Schema of the specified database\n *\n * @param {string} schurl TerminusDB server URL or a valid TerminusDB Id or omitted\n * @param {object} doc is a valid owl ontology in json-ld or turtle format\n * @param {object} opts is an options object\n * @return {Promise}\n *\n * if omitted the current server and database will be used\n * opts.format is used to specify which format is being used (*json / turtle)\n * opts.key is an optional API key\n */\nWOQLClient.prototype.updateSchema = function (schurl, doc, opts) {\n\tif (schurl && !this.connectionConfig.setSchemaURL(schurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(schurl, 'Update Schema'))\n\t\t);\n\t}\n\tdoc = this.addOptionsToDocument(doc, opts);\n\treturn this.dispatch(this.connectionConfig.schemaURL(), 'update_schema', doc);\n};\n\n/**\n * Creates a new document in the specified database\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus database (an id will be randomly assigned) or\n * 2) a valid URL or of a terminus document (the document will be given the passed URL) or\n * 3) a valid terminus document id (the current server and database will be used)\n * 4) can be omitted (the URL will be taken from the document if present)\n * The second argument (doc) is a valid document in json-ld\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.createDocument = function (docurl, doc, opts) {\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Create Document'))\n\t\t);\n\t} if (\n\t\tdoc\n    && doc['@id']\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\n\t) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Create Document'))\n\t\t);\n\t}\n\tdoc = this.addOptionsToDocument(\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\n\t\topts\n\t);\n\treturn this.dispatch(this.connectionConfig.docURL(), 'create_document', doc);\n};\n\n/**\n * Retrieves a document from the specified database\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus document or\n * 2) a valid ID of a terminus document in the current database\n * the second argument (opts) is an options json -\n * \t\topts.key is an optional API key\n * \t\topts.shape is frame | *document\n */\nWOQLClient.prototype.getDocument = function (docurl, opts) {\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Get Document'))\n\t\t);\n\t}\n\treturn this.dispatch(this.connectionConfig.docURL(), 'get_document', opts);\n};\n\n/**\n * Updates a document in the specified database with a new version\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus document or\n * 2) a valid ID of a terminus document in the current database or\n * 3) omitted in which case the id will be taken from the document @id field\n * the second argument (doc) is a document in json-ld format\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.updateDocument = function (docurl, doc, opts) {\n\tif (docurl && !this.connectionConfig.setDocument(docurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Update Document'))\n\t\t);\n\t}\n\tif (doc && doc['@id']\n    && !this.connectionConfig.setDocument(doc['@id'], doc['@context'])\n\t) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(doc['@id'], 'Update Document'))\n\t\t);\n\t}\n\tdoc = this.addOptionsToDocument(\n\t\tthis.makeDocumentConsistentWithURL(doc, this.connectionConfig.docURL()),\n\t\topts\n\t);\n\treturn this.dispatch(this.connectionConfig.docURL(), 'update_document', doc);\n};\n\n/**\n * Deletes a document from the specified database\n *\n * The first (docurl) argument can be\n * 1) a valid URL of a terminus document or\n * 2) a valid ID of a terminus document in the current database\n * 3) omitted - the current document will be used\n * the second argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.deleteDocument = function (docurl, opts) {\n\tif (docurl && (!this.connectionConfig.setDocument(docurl) || !this.connectionConfig.docid)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(docurl, 'Delete Document'))\n\t\t);\n\t}\n\treturn this.dispatch(this.connectionConfig.docURL(), 'delete_document', opts);\n};\n\n/**\n * Executes a read-only WOQL query on the specified database and returns the results\n *\n * @param {string} qurl TerminusDB server URL or omitted (the current DB will be used)\n * @param {string} woql is a \"woql query select statement\"\n * @param {object} opts it can contents the API key (opts.key)\n *\n */\nWOQLClient.prototype.select = function (qurl, woql, opts) {\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Select'))\n\t\t);\n\t}\n\tlet q = { 'terminus:query': JSON.stringify(woql) };\n\tq = this.addOptionsToWOQL(q, opts);\n\treturn this.dispatch(this.connectionConfig.queryURL(), CONST.WOQL_SELECT, q);\n};\n\n/**\n * Executes a WOQL query on the specified database which updates the state and returns the results\n *\n * The first (qurl) argument can be\n * 1) a valid URL of a terminus database or\n * 2) omitted - the current database will be used\n * the second argument (woql) is a woql select statement encoded as a string\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.update = function (qurl, woql, opts) {\n\tif (qurl && !this.connectionConfig.setQueryURL(qurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(qurl, 'Update'))\n\t\t);\n\t}\n\twoql = this.addOptionsToWOQL(woql, opts);\n\treturn this.dispatch(this.connectionConfig.queryURL(), 'woql_update', woql);\n};\n\n/**\n * Retrieves a WOQL query on the specified database which updates the state and returns the results\n *\n * The first (cfurl) argument can be\n * 1) a valid URL of a terminus database or\n * 2) omitted - the current database will be used\n * the second argument (cls) is the URL / ID of a document class that exists in the database schema\n * the third argument (opts) is an options json - opts.key is an optional API key\n */\nWOQLClient.prototype.getClassFrame = function (cfurl, cls, opts) {\n\tif (cfurl && !this.connectionConfig.setClassFrameURL(cfurl)) {\n\t\treturn Promise.reject(\n\t\t\tnew URIError(ErrorMessage.getInvalidURIMessage(cfurl, 'Get Class Frame'))\n\t\t);\n\t}\n\tif (!opts) opts = {};\n\topts['terminus:class'] = cls;\n\treturn this.dispatch(this.connectionConfig.frameURL(), 'class_frame', opts);\n};\n\n/*\n * Utility functions for adding standard fields to API arguments\n */\n\n /**\n  * Adds a key to the passed woql query if it is present in the opts json\n  * \n  */\nWOQLClient.prototype.addOptionsToWOQL = function (woql, opts) {\n\tif (opts && opts.key) {\n\t\twoql.key = opts.key;\n\t}\n\treturn woql;\n};\n\n\n/**\n * Wrapws the passed json document in a valid TerminusDB update document API shell\n */\nWOQLClient.prototype.addOptionsToDocument = function (doc, opts) {\n\tconst pdoc = {};\n\tpdoc['@context'] = doc['@context'];\n\t// add blank node prefix as document base url\n\tif (pdoc['@context'] && doc['@id']) { \n\t\tpdoc['@context']._ = `${doc['@id']}/`;\n\t}\n\tif (opts && opts['terminus:encoding'] && opts['terminus:encoding'] === 'terminus:turtle') {\n\t\tpdoc['terminus:turtle'] = doc;\n\t\tpdoc['terminus:schema'] = this.connectionConfig.schemaURL();\n\t\tdelete pdoc['terminus:turtle']['@context'];\n\t} else {\n\t\tpdoc['terminus:document'] = doc;\n\t\tdelete pdoc['terminus:document']['@context'];\n\t}\n\tpdoc['@type'] = 'terminus:APIUpdate';\n\tif (opts && opts['terminus:user_key']) {\n\t\tpdoc['terminus:user_key'] = opts['terminus:user_key'];\n\t}\n\tif (opts && opts.key) {\n\t\tpdoc['terminus:user_key'] = opts.key;\n\t}\n\treturn pdoc;\n};\n\n/**\n * Adds an api key to the payload\n */\nWOQLClient.prototype.addKeyToPayload = function (payload, url) {\n\tif (typeof payload !== 'object')payload = {};\n\tif (payload.key) {\n\t\tpayload['terminus:user_key'] = payload.key;\n\t\tdelete payload.key;\n\t} else if (this.connection.getClientKey()) {\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey();\n\t} else if (this.connection.getClientKey(url)) {\n\t\tpayload['terminus:user_key'] = this.connection.getClientKey(url);\n\t}\n\treturn payload;\n};\n\n/**\n * Document updates include the URL in both the endpoint and the document itself\n * This ensures that they are the same by using the endpoint URL as the authoritative version \n * and copying it into the embedded document ID\n */\nWOQLClient.prototype.makeDocumentConsistentWithURL = function (doc, dburl) {\n\tdoc['@id'] = dburl;\n\treturn doc;\n};\n\n/**\n * Common request dispatch function\n */\nWOQLClient.prototype.dispatch = function (url, action, payload) {\n\tif (this.connectionConfig.includeKey()) {\n\t\tpayload = this.addKeyToPayload(payload, url);\n\t}\n\tif (this.use_fetch) {\n\t\treturn this.dispatchFetch(url, action, payload);\n\t}\n\treturn DispatchRequest(url, action, payload);\n};\n\n/**\n * If the use_fetch switch is set, the browser's built in fetch will be used rather than the npm axios module \n */\nWOQLClient.prototype.dispatchFetch = function (url, action, payload) {\n\tconst api = {\n\t\t//mode: 'cors',  no-cors, cors, *same-origin\n\t\tredirect: 'follow', // manual, *follow, error\n\t\treferrer: 'client', // no-referrer, *client\n\t};\n\tlet hdrs = {};\n\tif (payload && payload['terminus:user_key']) {\n\t\thdrs = { Authorization: `Basic ${btoa(`:${payload['terminus:user_key']}`)}` };\n\t\tdelete (payload['terminus:user_key']);\n\t}\n\t// read only API calls - use GET\n\tswitch (action) {\n\tcase CONST.DELETE_DATABASE:\n\tcase CONST.DELETE_DOCUMENT:\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\n\t\tapi.method = 'DELETE';\n\t\tapi.cache = 'no-cache';\n\t\tbreak;\n\tcase CONST.CREATE_DATABASE:\n\tcase CONST.UPDATE_SCHEMA:\n\tcase CONST.CREATE_DOCUMENT:\n\tcase CONST.UPDATE_DOCUMENT:\n\tcase CONST.WOQL_UPDATE:\n\t\tapi.method = 'POST';\n\t\tapi.cache = 'no-cache';\n\t\thdrs['Content-Type'] = 'application/json';\n\t\tapi.body = JSON.stringify(payload);\n\t\tbreak;\n\tcase CONST.GET_SCHEMA:\n\tcase CONST.CONNECT:\n\tcase CONST.CLASS_FRAME:\n\tcase CONST.WOQL_SELECT:\n\tcase CONST.GET_DOCUMENT:\n\tdefault:\n\t\tapi.method = 'GET';\n\t\tif (Object.keys(payload).length > 0) url += `?${UTILS.URIEncodePayload(payload)}`;\n\t}\n\tconst self = this;\n\tif (Object.keys(hdrs).length > 0) {\n\t\tapi.headers = new Headers(hdrs);\n\t}\n\treturn fetch(url, api).then((response) => {\n\t\tif (self.return_full_response) return response;\n\t\tif (response.ok) {\n\t\t\treturn response.json();\n\t\t}\n\t\tself.error = self.parseAPIError(response);\n\t\treturn Promise.reject(new Error(self.getAPIErrorMessage(url, api, self.error)));\n\t});\n};\n\nmodule.exports = WOQLClient;\n","'use strict';\n\nmodule.exports = function bind(fn, thisArg) {\n  return function wrap() {\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n    return fn.apply(thisArg, args);\n  };\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%40/gi, '@').\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @returns {string} The formatted url\n */\nmodule.exports = function buildURL(url, params, paramsSerializer) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n\n  var serializedParams;\n  if (paramsSerializer) {\n    serializedParams = paramsSerializer(params);\n  } else if (utils.isURLSearchParams(params)) {\n    serializedParams = params.toString();\n  } else {\n    var parts = [];\n\n    utils.forEach(params, function serialize(val, key) {\n      if (val === null || typeof val === 'undefined') {\n        return;\n      }\n\n      if (utils.isArray(val)) {\n        key = key + '[]';\n      } else {\n        val = [val];\n      }\n\n      utils.forEach(val, function parseValue(v) {\n        if (utils.isDate(v)) {\n          v = v.toISOString();\n        } else if (utils.isObject(v)) {\n          v = JSON.stringify(v);\n        }\n        parts.push(encode(key) + '=' + encode(v));\n      });\n    });\n\n    serializedParams = parts.join('&');\n  }\n\n  if (serializedParams) {\n    var hashmarkIndex = url.indexOf('#');\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n};\n","'use strict';\n\nmodule.exports = function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar normalizeHeaderName = require('./helpers/normalizeHeaderName');\n\nvar DEFAULT_CONTENT_TYPE = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nfunction setContentTypeIfUnset(headers, value) {\n  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n    headers['Content-Type'] = value;\n  }\n}\n\nfunction getDefaultAdapter() {\n  var adapter;\n  // Only Node.JS has a process variable that is of [[Class]] process\n  if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    adapter = require('./adapters/http');\n  } else if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = require('./adapters/xhr');\n  }\n  return adapter;\n}\n\nvar defaults = {\n  adapter: getDefaultAdapter(),\n\n  transformRequest: [function transformRequest(data, headers) {\n    normalizeHeaderName(headers, 'Accept');\n    normalizeHeaderName(headers, 'Content-Type');\n    if (utils.isFormData(data) ||\n      utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n      return data.toString();\n    }\n    if (utils.isObject(data)) {\n      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n      return JSON.stringify(data);\n    }\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    /*eslint no-param-reassign:0*/\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data);\n      } catch (e) { /* Ignore */ }\n    }\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  }\n};\n\ndefaults.headers = {\n  common: {\n    'Accept': 'application/json, text/plain, */*'\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nmodule.exports = defaults;\n","'use strict';\n\nvar utils = require('./../utils');\nvar settle = require('./../core/settle');\nvar buildURL = require('./../helpers/buildURL');\nvar parseHeaders = require('./../helpers/parseHeaders');\nvar isURLSameOrigin = require('./../helpers/isURLSameOrigin');\nvar createError = require('../core/createError');\n\nmodule.exports = function xhrAdapter(config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    var requestData = config.data;\n    var requestHeaders = config.headers;\n\n    if (utils.isFormData(requestData)) {\n      delete requestHeaders['Content-Type']; // Let the browser set it\n    }\n\n    var request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password || '';\n      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n    }\n\n    request.open(config.method.toUpperCase(), buildURL(config.url, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    // Listen for ready state\n    request.onreadystatechange = function handleLoad() {\n      if (!request || request.readyState !== 4) {\n        return;\n      }\n\n      // The request errored out and we didn't get a response, this will be\n      // handled by onerror instead\n      // With one exception: request that using file: protocol, most browsers\n      // will return status as 0 even though it's a successful request\n      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n        return;\n      }\n\n      // Prepare the response\n      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n      var response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config,\n        request: request\n      };\n\n      settle(resolve, reject, response);\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(createError('Request aborted', config, 'ECONNABORTED', request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(createError('Network Error', config, null, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED',\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (utils.isStandardBrowserEnv()) {\n      var cookies = require('./../helpers/cookies');\n\n      // Add xsrf header\n      var xsrfValue = (config.withCredentials || isURLSameOrigin(config.url)) && config.xsrfCookieName ?\n        cookies.read(config.xsrfCookieName) :\n        undefined;\n\n      if (xsrfValue) {\n        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n      }\n    }\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n          // Remove Content-Type if data is undefined\n          delete requestHeaders[key];\n        } else {\n          // Otherwise add header to the request\n          request.setRequestHeader(key, val);\n        }\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (config.withCredentials) {\n      request.withCredentials = true;\n    }\n\n    // Add responseType to request if needed\n    if (config.responseType) {\n      try {\n        request.responseType = config.responseType;\n      } catch (e) {\n        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n        if (config.responseType !== 'json') {\n          throw e;\n        }\n      }\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', config.onDownloadProgress);\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', config.onUploadProgress);\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (!request) {\n          return;\n        }\n\n        request.abort();\n        reject(cancel);\n        // Clean up request\n        request = null;\n      });\n    }\n\n    if (requestData === undefined) {\n      requestData = null;\n    }\n\n    // Send the request\n    request.send(requestData);\n  });\n};\n","'use strict';\n\nvar enhanceError = require('./enhanceError');\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The created error.\n */\nmodule.exports = function createError(message, config, code, request, response) {\n  var error = new Error(message);\n  return enhanceError(error, config, code, request, response);\n};\n","'use strict';\n\nvar utils = require('../utils');\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n * @returns {Object} New object resulting from merging config2 to config1\n */\nmodule.exports = function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  var config = {};\n\n  utils.forEach(['url', 'method', 'params', 'data'], function valueFromConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    }\n  });\n\n  utils.forEach(['headers', 'auth', 'proxy'], function mergeDeepProperties(prop) {\n    if (utils.isObject(config2[prop])) {\n      config[prop] = utils.deepMerge(config1[prop], config2[prop]);\n    } else if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (utils.isObject(config1[prop])) {\n      config[prop] = utils.deepMerge(config1[prop]);\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  utils.forEach([\n    'baseURL', 'transformRequest', 'transformResponse', 'paramsSerializer',\n    'timeout', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',\n    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress', 'maxContentLength',\n    'validateStatus', 'maxRedirects', 'httpAgent', 'httpsAgent', 'cancelToken',\n    'socketPath'\n  ], function defaultToConfig2(prop) {\n    if (typeof config2[prop] !== 'undefined') {\n      config[prop] = config2[prop];\n    } else if (typeof config1[prop] !== 'undefined') {\n      config[prop] = config1[prop];\n    }\n  });\n\n  return config;\n};\n","'use strict';\n\n/**\n * A `Cancel` is an object that is thrown when an operation is canceled.\n *\n * @class\n * @param {string=} message The message.\n */\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return 'Cancel' + (this.message ? ': ' + this.message : '');\n};\n\nCancel.prototype.__CANCEL__ = true;\n\nmodule.exports = Cancel;\n","/**\n * @file Connection Capabilities\n * @license Apache Version 2\n * @summary Object which helps manage the capabilities available for a given TerminusDB connection\n * Creates an entry in the connection registry for the server\n * and all the databases that the client has access to\n * maps the input authorties to a per-db array for internal storage and easy\n * access control checks\n */\nconst CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n\n/**\n * @constructor \n * @param {connectionConfig} connectionConfig connectionConfig object containing the connection parameters \n * @param {String} key API key\n */\nfunction ConnectionCapabilities(connectionConfig, key) {\n\tthis.connection = {};\n\tthis.connectionConfig = connectionConfig;\n\tif (this.connectionConfig.server && key) {\n\t\tthis.setClientKey(this.connectionConfig.server, key);\n\t}\n}\n\n/**\n * @summary Retrieves the API key for the given TerminusDB Server\n * @param {String} serverURL optional - URL of TerminusDB - if ommited the current server URL is used\n */\nConnectionCapabilities.prototype.getClientKey = function (serverURL) {\n\tif (!serverURL) serverURL = this.connectionConfig.serverURL();\n\tif (serverURL && this.connection[serverURL]) return this.connection[serverURL].key;\n\treturn false;\n};\n\n\n/*\n * Utility functions for changing the state of connections with Terminus servers\n */\n\n/**\n * @summary sets the api key for the given url\n * @param {String} curl a valid terminusDB server URL\n * @param {String} key an optional API key\n */\nConnectionCapabilities.prototype.setClientKey = function (curl, key) {\n\tif (typeof key === 'string' && key.trim()) {\n\t\tif (typeof this.connection[curl] === 'undefined') {\n\t\t\tthis.connection[curl] = {};\n\t\t}\n\t\tthis.connection[curl].key = key.trim();\n\t}\n};\n\n\n/**\n * @param {string} curl a valid terminusDB server URL\n * @param {object} capabilities the JSON object returned by the connect API call \n */\nConnectionCapabilities.prototype.addConnection = function (curl, capabilities) {\n\tif (typeof this.connection[curl] === 'undefined') {\n\t\tthis.connection[curl] = {};\n\t}\n\tconst capabilitiesKeys = capabilities ? Object.keys(capabilities) : [];\n\n\tfor (const pred of capabilitiesKeys) {\n\t    if (pred === 'terminus:authority' && capabilities[pred]) {\n\t      const auths = Array.isArray(capabilities[pred]) === true\n\t        ? capabilities[pred]\n\t        : [capabilities[pred]];\n\n\t      for (let i = 0; i < auths.length; i += 1) {\n\t        let scope = auths[i]['terminus:authority_scope'];\n\t        const actions = auths[i]['terminus:action'];\n\n\t\t\tif (Array.isArray(scope) === false) scope = [scope];\n\t\t\tconst actionsArr = ((Array.isArray(actions)) ? actions.map(item => item['@id']) : [] );\n\t        for (let j = 0; j < scope.length; j += 1) {\n\t          const nrec = scope[j];\n\t          if (typeof this.connection[curl][nrec['@id']] === 'undefined') {\n\t            this.connection[curl][nrec['@id']] = nrec;\n\t          }\n\t          this.connection[curl][nrec['@id']]['terminus:authority'] = actionsArr;\n\t        }\n\t      }\n\t    } else {\n\t      this.connection[curl][pred] = capabilities[pred];\n\t    }\n\t}\n};\n\n/**\n * @summary returns true if the client is currently connected to a server\n * @returns {Boolean}\n */\nConnectionCapabilities.prototype.serverConnected = function () {\n\treturn typeof this.connection[this.connectionConfig.server] !== 'undefined';\n};\n\n\n/**\n * @summary retrieves the meta-data record returned by connect for a particular server\n * @param {String} [srvr] optional server URL - if omitted current connection config will be used\n * @returns {terminus:Server} JSON server record as returned by WOQLClient.connect\n */\nConnectionCapabilities.prototype.getServerRecord = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst connectionObj = this.connection[url] || {};\n\tconst okeys = Object.keys(connectionObj);\n\n\tfor (const oid of okeys) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Server') {\n\t\t\treturn this.connection[url][oid];\n\t\t}\n\t}\n\treturn false;\n};\n\n/**\n * @summary retrieves the meta-data record returned by connect for a particular database\n * @param {String} [dbid] optional database id - if omitted current connection config db will be used\n * @param {String} [srvr] optional server URL - if omitted current connection config server will be used\n * @returns {terminus:Database} terminus:Database JSON document as returned by WOQLClient.connect\n */\nConnectionCapabilities.prototype.getDBRecord = function (dbid, srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tdbid = (dbid || this.connectionConfig.dbid);\n\tif (typeof this.connection[url] !== 'object') {\n\t\treturn false;\n\t}\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\tdbid = this.dbCapabilityID(dbid);\n\n\tif (typeof this.connection[url][dbid] !== 'undefined') { return this.connection[url][dbid]; }\n\n\treturn undefined;\n};\n\n/**\n * @summary retrieves all the db meta-data records returned by connect for a particular server\n * @param {String} [srvr] optional server URL - if omitted current connection config server will be used\n * @returns {[terminus:Database]} array of terminus:Database JSON documents as returned by WOQLClient.connect\n */\nConnectionCapabilities.prototype.getServerDBRecords = function (srvr) {\n\tconst url = (srvr || this.connectionConfig.server);\n\tconst dbrecs = {};\n\tconst connectionObj = this.connection[url] || {};\n\n\tfor (const oid of Object.keys(connectionObj)) {\n\t\tif (this.connection[url][oid]['@type'] === 'terminus:Database') {\n\t\t\tdbrecs[oid] = this.connection[url][oid];\n\t\t}\n\t}\n\treturn dbrecs;\n};\n\n/**\n * @summary removes a database record from the connection registry (after deletion, for example)\n * @param {String} [dbid] optional DB ID - if omitted current connection config db will be used\n * @param {String} [srvr] optional server URL - if omitted current connection config server will be used\n * @returns {[terminus:Database]} array of terminus:Database JSON documents as returned by WOQLClient.connect\n */\nConnectionCapabilities.prototype.removeDB = function (dbid, srvr) {\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tif (dbid && this.connectionConfig.dbid && this.connectionConfig.dbid === dbid) {\n\t\tthis.connectionConfig.dbid = false;\n\t}\n\n\tconst url = srvr || this.connectionConfig.server;\n\tconst dbidCap = this.dbCapabilityID(dbid);\n\tif (dbidCap && this.connection[url] && this.connection[url][dbidCap]) {\n\t\tdelete this.connection[url][dbidCap];\n\t}\n};\n\n/**\n * @param {String} dbid local id of database\n * @returns {String} the id of the terminus:Document describing the DB\n * @summary Generates the ID of the terminus:Database document from the database ID\n */\nConnectionCapabilities.prototype.dbCapabilityID = function (dbid) {\n\treturn `doc:${dbid}`;\n};\n\n/**\n * @param {String} action - the action that will be carried out\n * @param {String} [dbid] optional DB ID - if omitted current connection config db will be used\n * @param {String} [srvr] optional server URL - if omitted current connection config server will be used\n * @returns {Boolean} true if the client's capabilities allow the action on the given server / db\n * @summary supports client side access control checks (in addition to server side)\n */\nConnectionCapabilities.prototype.capabilitiesPermit = function (action, dbid, server) {\n\tserver = server || this.connectionConfig.server;\n\tdbid = dbid || this.connectionConfig.dbid;\n\n\tlet rec;\n\n\tif (action === CONST.CREATE_DATABASE) {\n\t\trec = this.getServerRecord(server);\n\t} else if (dbid) rec = this.getDBRecord(dbid);\n\telse console.log('no dbid provided in capabilities check ', server, dbid);\n\tif (rec) {\n\t\tconst auths = rec['terminus:authority'];\n\t\tif (auths && auths.indexOf(`terminus:${action}`) !== -1) return true;\n\t} else {\n\t\tconsole.log('No record found for connection: ', this.connection, action, server, dbid);\n\t}\n\tthis.error = ErrorMessage.accessDenied(action, dbid, server);\n\treturn false;\n};\n\n\nmodule.exports = ConnectionCapabilities;\n","/**\n * @file Terminus DB connection configuration\n * @license Apache Version 2\n * @summary Object representing the state of a connection to a terminus db - server url, current dbid, document id\n * along with some configuration information (key, connected mode, client_side_access_control)\n * provides methods for getting and setting connection parameters\n */\nconst IDParser = require('./terminusIDParser');\n\nfunction ConnectionConfig(params) {\n\tconst newParams = params || {};\n\tthis.server = false;\n\tthis.dbid = false;\n\tthis.docid = false;\n\tif (newParams.server) this.setServer(newParams.server);\n\tif (newParams.db) this.setDB(newParams.db);\n\tif (newParams.doc) this.setDocument(newParams.doc);\n\t/*\n     * client configuration options - connected_mode = connected\n     * tells the client to first connect to the server before invoking other services\n     */\n\n\t// include a terminus:user_key API key in the calls\n\tthis.include_key = newParams.include_key || true;\n}\n\n/**\n * Server URL will always end in a / character - automatically appended if missing\n */\nConnectionConfig.prototype.setServer = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseServerURL(inputStr)) {\n\t\tthis.server = parser.server();\n\t\tthis.dbid = false;\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\n\nConnectionConfig.prototype.serverURL = function () {\n\treturn this.server;\n};\n\n/**\n * Database URL does not have a trailing slash \"/\" character and it will be chopped if it is passed in at the end of the input string\n * @param {String} inputStr - URL of DB or local id of DB\n */\nConnectionConfig.prototype.setDB = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDBID(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.dbURL = function () {\n\treturn this.server + this.dbid;\n};\n\n\n/**\n * @summary sets the connection to point at the schema api URL\n */\nConnectionConfig.prototype.setSchemaURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseSchemaURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.schemaURL = function () {\n\treturn `${this.dbURL()}/schema`;\n};\n\n/**\n * @param {String} inputStr - the URL of a Terminus DB base install or schema endpoint\n * @param {Object} [context] optional json-ld context \n * @summary sets the connection to point at the query api URL\n */\nConnectionConfig.prototype.setQueryURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseQueryURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.queryURL = function () {\n\treturn `${this.dbURL()}/woql`;\n};\n\n/**\n * @param {String} inputStr - the URL of a Terminus DB base install or frame endpoint\n * @param {Object} [context] optional json-ld context \n * @summary sets the connection to point at the class frame api URL\n */\nConnectionConfig.prototype.setClassFrameURL = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseClassFrameURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tthis.dbid = parser.dbid();\n\t\tthis.docid = false;\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.frameURL = function () {\n\treturn `${this.dbURL()}/frame`;\n};\n\n/**\n * @param {String} inputStr - the URL of a Terminus DB base install or document endpoint\n * @param {Object} [context] optional json-ld context \n * @summary sets the connection to point at the document api URL\n */\nConnectionConfig.prototype.setDocument = function (inputStr, context) {\n\tconst parser = new IDParser(context);\n\tif (parser.parseDocumentURL(inputStr)) {\n\t\tif (parser.server()) this.server = parser.server();\n\t\tif (parser.dbid()) this.dbid = parser.dbid();\n\t\tif (parser.docid()) this.docid = parser.docid();\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nConnectionConfig.prototype.docURL = function () {\n\treturn `${this.dbURL()}/document/${this.docid ? this.docid : ''}`;\n};\n\n/**\n * will a key be used in this connnection?\n */\nConnectionConfig.prototype.includeKey = function () {\n\treturn this.include_key === true;\n};\n\nmodule.exports = ConnectionConfig;\n","/**\n * @file Terminus ID Parser\n * @license Apache Version 2\n * @summary Object representing a terminus ID / URL \n * Helper methods for parsing and decomposing Terminus URLs \n * and dealing with namespace prefixed URLs\n */\n\n/**\n * \n * @param {Object} context JSON-LD context to be used for prefixes\n */\n function IDParser(context) {\n\tthis.context = context;\n\tthis.server_url = false;\n\tthis.db = false;\n\tthis.doc = false;\n}\n\nIDParser.prototype.server = function () {\n\treturn this.server_url;\n};\n\nIDParser.prototype.dbid = function () {\n\treturn this.db;\n};\n\nIDParser.prototype.docid = function () {\n\treturn this.doc;\n};\n\nIDParser.prototype.setContext = function (context) {\n\tthis.context = context;\n};\n\n/**\n * parses a Terminus Server URL and appends a trailing slash if not present\n */\nIDParser.prototype.parseServerURL = function (str) {\n\tthis.server_url = false;\n\n\tif (this.validURL(str)) {\n\t\tthis.server_url = str;\n\t} else if (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tthis.server_url = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.server_url && this.server_url.lastIndexOf('/') !== this.server_url.length - 1\n\t) {\n\t\tthis.server_url += '/';\n\t}\n\treturn this.server_url;\n};\n\nIDParser.prototype.parseDBID = function (str) {\n\tthis.db = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tif (str.lastIndexOf('/') === str.length - 1) {\n\t\t\t// trim trailing slash\n\t\t\tstr = str.substring(0, str.length - 1);\n\t\t}\n\t\tconst index = str.lastIndexOf('/');\n\n\t\tconst serverURL = str.substring(0, index);\n\t\t// only dbNamer\n\t\tstr = str.substring(index + 1);\n\n\t\tif (this.parseServerURL(serverURL) === false) return false;\n\t}\n\n\tif (this.validIDString(str)) {\n\t\tthis.db = str;\n\t}\n\treturn this.db;\n};\n\nIDParser.prototype.parseDocumentURL = function (str) {\n\tthis.doc = false;\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\n\tif (this.validURL(str)) {\n\t\tlet dbURL = str;\n\t\tif (str.lastIndexOf('/document/') !== -1) {\n\t\t\t// get dbURL\n\t\t\tdbURL = str.substring(0, str.lastIndexOf('/document/'));\n\t\t\tstr = str.substring(str.lastIndexOf('/document/') + 10);\n\t\t}\n\t\tif (this.parseDBID(dbURL) === false) return false;\n\t}\n\tif (str.substring(0, 4) === 'doc:') str = str.substring(4);\n\t// check if the document's name hasn't space or '/'\n\tif (this.validIDString(str)) {\n\t\tthis.doc = str;\n\t}\n\treturn this.doc;\n};\n\nIDParser.prototype.parseSchemaURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'schema');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.parseQueryURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'woql');\n\t\tstr = this.stripOptionalPath(str, 'query');\n\t}\n\treturn this.parseDBID(str);\n};\n\nIDParser.prototype.stripOptionalPath = function (str, bit) {\n\tif (str.indexOf(`/${bit}`) !== -1) str = str.substring(0, str.indexOf(`/${bit}`));\n\treturn str;\n};\n\nIDParser.prototype.parseClassFrameURL = function (str) {\n\tif (this.context && this.validPrefixedURL(str, this.context)) {\n\t\tstr = this.expandPrefixed(str, this.context);\n\t}\n\tif (this.validURL(str)) {\n\t\tstr = this.stripOptionalPath(str, 'frame');\n\t}\n\treturn this.parseDBID(str);\n};\n\n// Valid URLs are those that start with http:// or https://\nIDParser.prototype.validURL = function (str) {\n\tif (str.substring(0, 7) === 'http://' || str.substring(0, 8) === 'https://') return true;\n\treturn false;\n};\n\nIDParser.prototype.validPrefixedURL = function (str, context) {\n\tif (typeof str !== 'string' || typeof context !== 'object') return false;\n\tconst parts = str.split(':');\n\tif (parts.length !== 2) return false;\n\tif (parts[0].length < 1 || parts[1].length < 1) return false;\n\tif (context && context[parts[0]] && this.validIDString(parts[1])) return true;\n\treturn false;\n};\n\nIDParser.prototype.validIDString = function (str) {\n\tif (typeof str !== 'string') return false;\n\tif (str.indexOf(':') !== -1 || str.indexOf(' ') !== -1 || str.indexOf('/') !== -1) return false;\n\treturn true;\n};\n\nIDParser.prototype.expandPrefixed = function (str, context) {\n\tconst parts = str.split(':');\n\treturn context[parts[0]] + parts[1];\n};\n\nmodule.exports = IDParser;\n","/**\r\n * @file Terminus Rules \r\n * @license Apache Version 2\r\n * @summary Terminus Rules support pattern matching on documents and results with an effect being carried out on each match\r\n */\r\nconst TerminusRule = require('./terminusRule.js');\r\nconst UTILS = require('./utils.js');\r\n\r\nfunction WOQLRule(){\r\n\tTerminusRule.TerminusRule.call(this); \r\n\tthis.pattern = new WOQLPattern();\r\n}\r\n\r\n\r\nWOQLRule.prototype = Object.create(TerminusRule.TerminusRule.prototype);\r\nWOQLRule.prototype.constructor = TerminusRule.TerminusRule;\r\n\r\nWOQLRule.prototype.setVariables = function(vars){\r\n\tif(vars && vars.length){\r\n\t\tthis.pattern.variables = UTILS.addNamespacesToVariables(vars);\r\n\t\tthis.current_variable = this.pattern.variables[this.pattern.variables.length - 1];\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.v = function(v){\r\n\tif(v){\r\n\t\tif(v.substring(0, 2) != \"v:\") v = \"v:\" + v;\r\n\t\tthis.current_variable = v;\r\n\t\treturn this;\r\n\t}\r\n\treturn this.current_variable;\r\n}\r\n\r\nWOQLRule.prototype.in = function(...list){\r\n\tif(this.current_variable){\r\n\t\tif(!this.pattern.constraints) this.pattern.constraints = {};\r\n\t\tif(!this.pattern.constraints[this.current_variable]) this.pattern.constraints[this.current_variable] = [];\r\n\t\tthis.pattern.constraints[this.current_variable].push(list);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.filter = function(tester){\r\n\tif(this.current_variable){\r\n\t\tif(!this.pattern.constraints) this.pattern.constraints = {};\r\n\t\tif(!this.pattern.constraints[this.current_variable]) this.pattern.constraints[this.current_variable] = [];\r\n\t\tthis.pattern.constraints[this.current_variable].push(tester);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nWOQLRule.prototype.match = function(data, key, context, action){\r\n\tif(context && this.pattern.scope != context) return false;\r\n\tif(key){\r\n\t\tif(this.pattern.variables && this.pattern.variables.length){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(this.pattern.variables.indexOf(key[0]) == -1) return false;\r\n\t\t\t\tif(this.pattern.variables.indexOf(key[1]) == -1) return false;\r\n\t\t\t}\r\n\t\t\telse if(this.pattern.variables.indexOf(key) == -1) return false;\r\n\t\t}\r\n\t\tif(this.pattern && this.pattern.type){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(!(data[key][0][\"@type\"] && this.pattern.type.indexOf(data[key][0][\"@type\"]) != -1)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if(!(data[key][\"@type\"] && this.pattern.type.indexOf(data[key][\"@type\"]) != -1)){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(this.pattern && typeof this.pattern.literal != \"undefined\"){\r\n\t\t\tif(typeof key == \"object\"){\r\n\t\t\t\tif(data[key[0]]['@value']) {\r\n\t\t\t\t\tif(!this.pattern.literal) return false;\r\n\t\t\t\t}\r\n\t\t\t\telse if(this.pattern.literal) return false;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif(data[key]['@value']) {\r\n\t\t\t\t\tif(!this.pattern.literal) return false;\r\n\t\t\t\t}\r\n\t\t\t\telse if(this.pattern.literal) return false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(typeof key == \"object\"){\r\n\t\t\tif(this.pattern.constraints && this.pattern.constraints[key[0]]){\r\n\t\t\t\tif(!data) return false;\r\n\t\t\t\tfor(var i = 0; i<this.pattern.constraints[key[0]].length; i++){\r\n\t\t\t\t\tif(!this.test(data[key[0]], this.pattern.constraints[key][0])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(this.pattern.constraints && this.pattern.constraints[key[1]]){\r\n\t\t\t\tif(!data) return false;\r\n\t\t\t\tfor(var i = 0; i<this.pattern.constraints[key[1]].length; i++){\r\n\t\t\t\t\tif(!this.test(data[key[1]], this.pattern.constraints[key][1])){\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if(this.pattern.constraints && this.pattern.constraints[key]){\r\n\t\t\tif(!data) return false;\r\n\t\t\tfor(var i = 0; i<this.pattern.constraints[key].length; i++){\r\n\t\t\t\tif(!this.test(data[key], this.pattern.constraints[key])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(context == \"edge\"){\r\n\t\t\tif(this.pattern.source && this.pattern.source != key[0]) return false;\r\n\t\t\tif(this.pattern.target && this.pattern.target != key[1]) return false;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tfor(var k in this.pattern.constraints){\r\n\t\t\tif(!data) return false;\r\n\t\t\tfor(var i = 0; i<this.pattern.constraints[k].length; i++){\r\n\t\t\t\tif(!this.test(data[k], this.pattern.constraints[k])){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(action && typeof this.pattern[action] == \"undefined\") return false;\r\n\treturn true;\r\n}\r\n\r\nWOQLRule.prototype.test = function(value, constraint){\r\n\tif(typeof constraint == \"object\" && constraint.length){\r\n\t\tvar vundertest = (value['@value'] ? value['@value'] : value);\r\n\t\treturn (constraint.indexOf(vundertest) != -1);\r\n\t}\r\n\tif(typeof constraint == \"function\"){\r\n\t\treturn constraint(value);\r\n\t}\r\n}\r\n\r\nWOQLRule.prototype.getMatchingRules = function(rules, row, key, context, action){\r\n\tvar matches = [];\r\n\tfor(var i = 0; i<rules.length; i++){\r\n\t\tif(rules[i].match(row, key, context, action)){\r\n\t\t\tmatches.push(rules[i].pattern);\r\n\t\t}\r\n\t}\r\n\treturn matches;\r\n}\r\n\r\nfunction WOQLPattern(pattern){\r\n\tTerminusRule.TerminusPattern.call(this,pattern); \r\n};\r\n\r\nWOQLPattern.prototype = Object.create(TerminusRule.TerminusPattern.prototype);\r\nWOQLPattern.prototype.constructor = TerminusRule.TerminusPattern;\r\n\r\nWOQLPattern.prototype.prettyPrint = function(type){\r\n\t//starts with obj. ...\r\n\tvar str = this.scope + \"('\";\r\n\tif(this.variables){\r\n\t\tstr += this.variables.join(\"', '\");\r\n\t }\r\n\t str += \"')\";\r\n\tif(typeof this.literal != \"undefined\"){\r\n\t\tstr += \".literal(\" + this.literal + \")\";\r\n\t}\r\n\tif(typeof this.type != \"undefined\"){\r\n\t\tstr += \".type(\" + JSON.stringify(UTILS.removeNamespacesFromVariables(this.type)) + \")\";\r\n\t}\r\n\tfor(var v in this.constraints){\r\n\t\tstr += \".v('\" + v + \"')\";\r\n\t\tfor(var i = 0; i<this.constraints[v].length; i++){\r\n\t\t\tif(typeof(this.constraints[v][i]) == \"function\"){\r\n\t\t\t\tstr += \".filter(\" + this.pattern.constraints[v][i] + \")\";\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tstr += \".in(\" + JSON.stringify(this.pattern.constraints[v][i]) + \")\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n\r\nmodule.exports = WOQLRule ;\r\n","/**\r\n * @file Terminus Rules\r\n * @license Apache Version 2\r\n * @summary Abstract object to support applying matching rules to result sets and documents\r\n * sub-classes are FrameRule and WOQLRule - this just has common functions\r\n */\r\n\r\nconst UTILS = require('./utils.js');\r\n\r\nfunction TerminusRule(){}\r\n\r\nTerminusRule.prototype.literal = function(tf){\r\n\tif(typeof tf == \"undefined\"){\r\n\t\treturn this.pattern.literal;\r\n\t}\r\n\tthis.pattern.literal = tf;\r\n\treturn this;\r\n}\r\n\r\nTerminusRule.prototype.type = function(...list){\r\n\tif(typeof list == \"undefined\" || list.length == 0){\r\n\t\treturn this.pattern.type;\r\n\t}\r\n\tthis.pattern.type = list;\r\n\treturn this;\r\n}\r\n\r\nTerminusRule.prototype.scope = function(scope){\r\n\tif(typeof scope == \"undefined\"){\r\n\t\treturn this.pattern.scope;\r\n\t}\r\n\tthis.pattern.scope = scope;\r\n\treturn this;\r\n}\r\n\r\nTerminusRule.prototype.value = function(val){\r\n\tif(typeof val == \"undefined\"){\r\n\t\treturn this.pattern.value;\r\n\t}\r\n\tthis.pattern.value = val;\r\n\treturn this;\r\n}\r\n\r\nTerminusRule.prototype.json = function(mjson){\r\n\tif(!mjson) {\r\n\t\tvar njson = {};\r\n\t\tif(this.pattern) njson.pattern = this.pattern.json();\r\n\t\treturn njson;\r\n\t}\r\n\telse {\r\n\t\tthis.setPattern(mjson.pattern);\r\n\t}\r\n\treturn this;\r\n}\r\n\r\nfunction TerminusPattern(pattern){};\r\n\r\n\r\nTerminusPattern.prototype.setPattern = function(pattern){\r\n\tif(typeof pattern.literal != \"undefined\") this.literal = pattern.literal;\r\n\tif(pattern.type) this.pattern.type = pattern.type;\r\n\tif(pattern.scope) this.pattern.scope = pattern.scope;\r\n}\r\n\r\nTerminusPattern.prototype.json = function(){\r\n    var json = {};\r\n\tif(typeof this.literal != \"undefined\") json.literal = this.literal;\r\n\tif(this.type) json.type = this.type;\r\n    if(this.scope) json.scope = this.scope;\r\n    if(this.value) json.value = this.value;\r\n    return json;\r\n}\r\n\r\n\r\nTerminusPattern.prototype.IDsMatch = function (ida, idb) {\r\n\treturn UTILS.compareIDs(ida, idb);\r\n};\r\n\r\nTerminusPattern.prototype.classIDsMatch = function (ida, idb) {\r\n\treturn this.IDsMatch(ida, idb);\r\n};\r\nTerminusPattern.prototype.propertyIDsMatch = function (ida, idb) {\r\n\tconst match = this.IDsMatch(ida, idb);\r\n\treturn match;\r\n};\r\nTerminusPattern.prototype.rangeIDsMatch = function (ida, idb) {\r\n\treturn this.IDsMatch(ida, idb);\r\n};\r\nTerminusPattern.prototype.valuesMatch = function (vala, valb) {\r\n\treturn vala == valb;\r\n};\r\nTerminusPattern.prototype.numberMatch = function (vala, valb) {\r\n\tif (typeof vala === 'string') {\r\n\t\ttry {\r\n\t\t\treturn eval(valb + vala);\r\n\t\t} catch (e) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn vala === valb;\r\n};\r\n\r\nTerminusPattern.prototype.stringMatch = function (vala, valb) {\r\n\tconst pat = new RegExp(vala);\r\n\treturn pat.test(valb);\r\n};\r\n\r\n\r\n module.exports = {TerminusRule, TerminusPattern};","const TerminusRule = require('./terminusRule.js');\r\n\r\n\r\nfunction FrameRule(){\r\n\tTerminusRule.TerminusRule.call(this); \r\n\tthis.pattern = new FramePattern();\r\n}\r\n\r\n\r\nFrameRule.prototype = Object.create(TerminusRule.TerminusRule.prototype);\r\nFrameRule.prototype.constructor = TerminusRule.TerminusRule;\r\n\r\n\r\nFrameRule.prototype.testRules = function(rules, frame, onmatch){\r\n\tvar matched_rules = [];\r\n\tif(rules && rules.length){\r\n\t\tfor(var i = 0; i<rules.length; i++){\r\n\t\t\tvar match = (!rules[i].pattern || this.patternMatchesFrame(rules[i].pattern.json(), frame));\r\n\t\t\tif(match){\r\n\t\t\t\tmatched_rules.push(rules[i]);\r\n\t\t\t\tif(onmatch && typeof onmatch == \"function\"){\r\n\t\t\t\t\tonmatch(frame, rules[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn matched_rules;\r\n}\r\n\r\n/**\r\n * Determines whether a given pattern matches a given frame\r\n */\r\nFrameRule.prototype.patternMatchesFrame = function(pattern, frame){\r\n\tif(typeof pattern == \"object\" && pattern.length){ //multiple patterns are ANDed\r\n\t\tfor(var i = 0 ; i<pattern.length; i++){\r\n\t\t\tvar fp = new FramePattern(pattern[i]);\r\n\t\t\tif(!fp.checkFrame(frame)) return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\telse {\r\n\t\tvar fp = new FramePattern(pattern);\r\n\t\treturn fp.checkFrame(frame);\r\n\t}\r\n}\r\n\r\nFrameRule.prototype.property = function(...prop){\r\n    if(!prop || prop.length == 0) return this.pattern.property;\r\n    this.pattern.property = prop;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.frame_type = function(...frame_type){\r\n    if(!frame_type || frame_type.length == 0) return this.pattern.frame_type;\r\n    this.pattern.frame_type = frame_type;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.label = function(prop){\r\n    if(!prop || prop.length == 0) return this.pattern.label;\r\n    this.pattern.label = prop;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.subject = function(...prop){\r\n    if(!prop|| prop.length == 0) return this.pattern.subject;\r\n    this.pattern.subject = prop;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.subjectClass = function(...prop){\r\n    if(!prop || prop.length == 0) return this.pattern.subjectClass;\r\n    this.pattern.subjectClass = prop;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.range = function(...prop){\r\n    if(!prop || prop.length == 0) return this.pattern.range;\r\n    this.pattern.range = prop;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.parent = function(par){\r\n    if(!par) return this.pattern.parent;\r\n    this.pattern.parent = par;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.children = function(...prop){\r\n    if(!prop || prop.length == 0) return this.pattern.children;\r\n    this.pattern.children= prop;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.depth = function(depth){\r\n    if(!depth) return this.pattern.depth;\r\n    this.pattern.depth=depth;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.index = function(...index){\r\n    if(!index || index.length == 0) return this.pattern.index;\r\n    this.pattern.index=index;\r\n    return this;\r\n}\r\n\r\nFrameRule.prototype.status = function(...status){\r\n    if(!status || status.length == 0) return this.pattern.status;\r\n    this.pattern.status=status;\r\n    return this;\r\n}\r\n\r\n\r\nfunction FramePattern(pattern){\r\n\tTerminusRule.TerminusPattern.call(this,pattern); \r\n};\r\n\r\nFramePattern.prototype = Object.create(TerminusRule.TerminusPattern.prototype);\r\nFramePattern.prototype.constructor = TerminusRule.TerminusPattern;\r\n\r\n/**\r\n * A frame pattern can have the following variables\r\n * renderer : object, property, data, * - matches a specific part of the frame\r\n * label : matches the label of a property\r\n * frame_type: object, data, document, id, oneOf\r\n * subject: id of the subject\r\n * subjectClass: class of the subject\r\n * range: type of a property (applies to property and data)\r\n * property: property id or list of property ids (parent property if it is an object or data)\r\n * value: value of the property\r\n * parent: a pattern relating to the parent of this frame\r\n * children: patterns for matching on the children of a frame\r\n * depth: how deep are we in the document? starts from 0\r\n * index: the index of a value in an array\r\n * status: updated, error, new, ok,\r\n */\r\n\r\nFramePattern.prototype.setPattern = function(pattern){\r\n\tthis.scope = (pattern.scope ? pattern.scope: false);\r\n\tthis.label = (pattern.label ? pattern.label : false);\r\n\tthis.frame_type = (pattern.frame_type ? pattern.frame_type : false);\r\n\tthis.subject = (pattern.subject ? pattern.subject : false);\r\n\tthis.subjectClass = (pattern.subjectClass ? pattern.subjectClass : false);\r\n\tthis.range = (pattern.range ? pattern.range : false);\r\n\tthis.property = (pattern.property ? pattern.property : false);\r\n\tthis.value = (pattern.value ? pattern.value : false);\r\n\tthis.parent = (pattern.parent ? new FramePattern(pattern.parent) : false);\r\n\tthis.children = [];\r\n\tif (pattern.children) {\r\n\t\tfor (let i = 0; i < pattern.children.length; i++) {\r\n\t\t\tthis.children.push(new FramePattern(pattern.children[i]));\r\n\t\t}\r\n\t}\r\n\tthis.depth = (typeof pattern.depth !== 'undefined' ? pattern.depth : false);\r\n\tthis.index = (pattern.index ? pattern.index : false);\r\n\tthis.status = (pattern.status ? pattern.status : false);\r\n}\r\n\r\nFramePattern.prototype.checkFrame = function(frame){\r\n\tvar rtype = this.getRendererType(frame);\r\n\tif(!rtype) return false;\r\n\tif(this.scope && (this.scope != rtype) && (this.scope != \"*\" )) return false;\r\n\tif(this.illegalRuleType(rtype)) return false;\r\n\tif(this.frame_type && !this.checkFrameType(rtype, frame)) return false;\r\n\tif(this.label && !this.checkLabel(rtype, frame)) return false;\r\n\tif(this.subject && !this.checkSubject(rtype, frame)) return false;\r\n\tif(this.subjectClass && !this.checkSubjectClass(rtype, frame)) return false;\r\n\tif(this.property && !this.checkProperty(rtype, frame)) return false;\r\n\tif(this.depth !== false && !this.checkDepth(rtype, frame)) return false;\r\n\tif(this.range && !this.checkRange(rtype, frame)) return false;\r\n\tif(this.value && !this.checkValue(rtype, frame)) return false;\r\n\tif(this.parent && !this.checkParent(rtype, frame)) return false;\r\n\tif(this.children && this.children.length && !this.checkChildren(rtype, frame)) return false;\r\n\tif(this.index && !this.checkIndex(rtype, frame)) return false;\r\n\tif(this.status && !this.checkStatus(rtype, frame)) return false;\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.unpack = function(arr, nonstring){\r\n\tif(nonstring) var str = arr.join(\",\");\r\n\tvar str = \"'\" + arr.join(\"','\") + \"'\";\r\n\treturn str;\r\n}\r\n\r\nFramePattern.prototype.prettyPrint = function(type){\r\n\t//starts with obj. ...\r\n\tif(this.scope == \"*\"){\r\n\t\tvar str = \"all()\";\r\n\t}\r\n\telse {\r\n\t\tvar str = this.scope + \"()\";\r\n    }\r\n    if(typeof this.literal != \"undefined\"){\r\n\t\tstr += \".literal(\" + this.literal + \")\";\r\n\t}\r\n\tif(typeof this.type != \"undefined\"){\r\n\t\tstr += \".type(\" + JSON.stringify(UTILS.removeNamespacesFromVariables(this.type)) + \")\";\r\n\t}\r\n\tif(typeof this.frameType != \"undefined\"){\r\n\t\tstr += \".frame_type(\" + this.unpack(this.frameType) + \")\";\r\n\t}\r\n\tif(typeof this.label != \"undefined\"){\r\n\t\tstr += \".label(\" + this.unpack(this.label) + \")\";\r\n\t}\r\n\tif(typeof this.subject != \"undefined\"){\r\n\t\tstr += \".subject(\" + this.unpack(this.subject) + \")\";\r\n\t}\r\n\tif(typeof this.subjectClass != \"undefined\"){\r\n\t\tstr += \".subjectClass(\" + this.unpack(this.subjectClass) + \")\";\r\n\t}\r\n\tif(typeof this.property != \"undefined\"){\r\n\t\tstr += \".property(\" + this.unpack(this.property) + \")\";\r\n\t}\r\n\tif(typeof this.value != \"undefined\"){\r\n\t\tstr += \".value(\" + this.unpack(this.value) + \")\";\r\n\t}\r\n\tif(typeof this.children != \"undefined\" && this.children.length > 0){\r\n\t\tstr += \".children(\\n\";\r\n\t\tvar kids = this.children;\r\n\t\tfor(var i = 0; i< kids.length; i++){\r\n\t\t\t//str += \"WOQL.\" + kids[i].prettyPrint() + \"\\n\";\r\n\t\t}\r\n\t\tstr += \")\";\r\n\t}\r\n\tif(typeof this.parent() != \"undefined\"){\r\n\t\t//str += \".parent(\" + this.parent.prettyPrint() + \")\";\r\n\t}\r\n\tif(typeof this.depth != \"undefined\"){\r\n\t\tvar d = this.depth;\r\n\t\tif(typeof d == \"string\"){\r\n\t\t\tstr += \".depth('\" + d + \"')\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tstr += \".depth(\" + d + \")\";\r\n\t\t}\r\n\t}\r\n\tif(typeof this.index != \"undefined\"){\r\n\t\tstr += \".index(\" + this.unpack(this.index, true) + \")\";\r\n\t}\r\n\tif(typeof this.status != \"undefined\"){\r\n\t\tstr += \".status(\" + this.unpack(this.status) + \")\";\r\n\t}\r\n\treturn str;\r\n}\r\n\r\n\r\nFramePattern.prototype.illegalRuleType = function (rtype) {\r\n\t// data frames have no children\r\n\tif (rtype == 'data' && this.children.length) return true;\r\n\t// object frames have no range\r\n\tif (rtype == 'object' && this.range) return true;\r\n\treturn false;\r\n};\r\n\r\n/* subject is an id or an array of ids,\r\n/* match is positive if the renderer's subject appears in the array or is the id\r\n */\r\nFramePattern.prototype.checkSubject = function (subject, frame) {\r\n\tif (typeof this.subject !== 'object' || !this.subject.length) this.subject = [this.subject];\r\n\tconst rsubj = frame.subject();\r\n\tfor (let i = 0; i < this.subject.length; i++) {\r\n\t\tif (this.IDsMatch(subject[i], rsubj)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// at least one child must match all child rules\r\nFramePattern.prototype.checkChildren = function (rtype, frame) {\r\n\tfor (let i = 0; i < this.children.length; i++) {\r\n\t\tlet found = false;\r\n\t\tif (rtype == 'object') {\r\n\t\t\tfor (const prop in frame.properties) {\r\n\t\t\t\tif (this.children[i].checkFrame(frame.properties[prop])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (rtype == 'property') {\r\n\t\t\tfor (let j = 0; j <= renderer.values.length; j++) {\r\n\t\t\t\tif (this.children[j].checkFrame(frame.values[j])) {\r\n\t\t\t\t\tfound = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!found) return false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.checkStatus = function (rtype, frame) {\r\n\tif (typeof this.status !== 'object' || this.status.length == 0) this.status = [this.status];\r\n\tfor (let i = 0; i < this.status.length; i++) {\r\n\t\tif (this.status[i] == 'updated' && !frame.isUpdated()) return false;\r\n\t\tif (this.status[i] == 'new' && !frame.isNew()) return false;\r\n\t\tif (this.status[i] == 'unchanged' && frame.isUpdated()) return false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nFramePattern.prototype.checkDepth = function (rtype, frame) {\r\n\treturn this.numberMatch(this.depth, frame.depth());\r\n};\r\n\r\nFramePattern.prototype.checkParent = function (rtype, frame) {\r\n\treturn this.parent.checkFrame(frame.parent);\r\n};\r\n\r\nFramePattern.prototype.checkIndex = function (rtype, frame) {\r\n\tif (rtype == 'data') {\r\n\t\treturn this.index == frame.index;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkProperty = function (rtype, frame) {\r\n\tif (typeof this.property !== 'object' || !this.property.length) this.property = [this.property];\r\n\tfor (let i = 0; i < this.property.length; i++) {\r\n\t\tif (this.propertyIDsMatch(frame.property(), this.property[i])) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n// returns true if any of the values are found\r\nFramePattern.prototype.checkValue = function (rtype, frame) {\r\n\tif (typeof this.value !== 'object' || !this.value.length) this.value = [this.value];\r\n\tfor (let i = 0; i < this.value.length; i++) {\r\n\t\tif (rtype == 'data') {\r\n\t\t\tif (this.valuesMatch(frame.value(), this.value[i])) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t} else if (rtype == 'property') {\r\n\t\t\tfor (let j = 0; j <= frame.values.length; j++) {\r\n\t\t\t\tif (this.getRendererType(frame.values[i]) == 'data'\r\n\t\t\t\t\t\t&& this.valuesMatch(frame.values[i].get(), this.value[i])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (rtype == 'object') {\r\n\t\t\tfor (const prop in frame.properties) {\r\n\t\t\t\tif (this.checkValue(this.getRendererType(frame.properties[prop]), frame.properties[prop])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkRange = function (rtype, frame) {\r\n\tif (typeof this.range !== 'object' || !this.range.length) this.range = [this.range];\r\n\tfor (let i = 0; i < this.range.length; i++) {\r\n\t\tif (this.rangeIDsMatch(frame.range(), this.range[i])) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkSubjectClass = function (rtype, frame) {\r\n\tif (typeof this.subjectClass !== 'object' || !this.subjectClass.length) this.subjectClass = [this.subjectClass];\r\n\tconst rcls = frame.subjectClass();\r\n\tfor (let i = 0; i < this.subjectClass.length; i++) {\r\n\t\tif (this.classIDsMatch(this.subjectClass[i], rcls)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nFramePattern.prototype.checkFrameType = function (rtype, frame) {\r\n\tif (rtype == 'object') return this.frame_type == 'object';\r\n\tif (rtype == 'data') {\r\n\t\tif (frame.frame) {\r\n\t\t\treturn this.frame_type == frame.frame.ftype();\r\n\t\t}\r\n\t}\r\n\tif (rtype == 'property') return false;\r\n};\r\n\r\nFramePattern.prototype.checkLabel = function (rtype, frame) {\r\n\tif (typeof frame.getLabel !== 'function') {\r\n\t\tconsole.log(new Error('Rule passed to check label with broken renderer object - no getLabel'));\r\n\t\treturn false;\r\n\t}\r\n\treturn this.stringMatch(this.label, frame.getLabel());\r\n};\r\n\r\n\r\nFramePattern.prototype.getRendererType = function (frame) {\r\n\tif (frame.isProperty()) return 'property';\r\n\tif (frame.isObject()) return 'object';\r\n\tif (frame.isData()) return 'data';\r\n\tif (frame.renderer_type) return frame.renderer_type;\r\n\tconsole.log(new Error(`frame configuration passed non-renderer type ${frame.constructor.name}`));\r\n\tconsole.log(renderer);\r\n\treturn false;\r\n};\r\n\r\nmodule.exports = FrameRule;","module.exports = {\n\t\t\t\t WOQLClient:require('./lib/woqlClient'),\n                  ConnectionCapabilities:require('./lib/connectionCapabilities'),\n                  ConnectionConfig:require('./lib/connectionConfig'),\n                  IDParser:require('./lib/terminusIDParser'),\n                  ErrorMessage:require('./lib/errorMessage'),\n                  UTILS:require('./lib/utils'),\n                  TerminusDocument:require('./lib/document'),\n                  WOQLResult:require('./lib/woqlResult'),\n                  WOQLRule:require('./lib/woqlRule'),\n                  FrameRule:require('./lib/frameRule'),\n                  WOQL:require('./lib/woql')};","/**\n * @file Dispatch Request\n * @license Apache Version 2\n * @summary Functions for dispatching API requests via the axios library. \n */\n\nconst axios = require('axios');\nconst UTILS = require('./utils.js');\nconst CONST = require('./const.js');\nconst ErrorMessage = require('./errorMessage');\n\n/**\n * @summary base 64 encodes a string using either the btoa implementation if available or the Buffer object. \n * @param {String} str string to be base 64 encoded\n */\nfunction btoaImplementation(str) {\n\ttry {\n\t\treturn btoa(str);\n\t} catch (err) {\n\t\t// console.log('in buffer')\n\t\treturn Buffer.from(str).toString('base64');\n\t}\n}\n\n/**\n * \n * @param {String} url  API endpoint URL\n * @param {String} action API action\n * @param {Object} payload data to be transmitted to endpoint\n */\nfunction DispatchRequest(url, action, payload) {\n\t/*\n\t*CORS is only required when trying to fetch data from a browser,\n\t*as browsers by default will block requests to different origins\n\t*/\n\tconst options = {\n\t\tmode: 'cors', // no-cors, cors, *same-origin\n\t\tredirect: 'follow', // manual, *follow, error\n\t\treferrer: 'client',\n\t\t// url:url,\n\t\t// no-referrer, *client\n\t};\n\tif (payload && payload['terminus:user_key']) {\n\t\toptions.headers = { Authorization: `Basic ${btoaImplementation(`:${payload['terminus:user_key']}`)}` };\n\t\tdelete (payload['terminus:user_key']);\n\t}\n\n\tswitch (action) {\n\tcase CONST.DELETE_DATABASE:\n\tcase CONST.DELETE_DOCUMENT:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.delete(url, options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t});\n\tcase CONST.CREATE_DATABASE:\n\tcase CONST.UPDATE_SCHEMA:\n\tcase CONST.CREATE_DOCUMENT:\n\tcase CONST.UPDATE_DOCUMENT:\n\tcase CONST.WOQL_UPDATE:\n\t\toptions.headers = options.headers ? options.headers : {};\n\t\toptions.headers['Content-Type'] = 'application/json';\n\t\treturn axios.post(url, JSON.stringify(payload), options)\n\t\t\t.then(response => response.data)\n\t\t\t.catch((err) => {\n\t\t\t\tconst e = new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t\tif (err.response && err.response.data) e.data = err.response.data;\n\t\t\t\tthrow e;\n\t\t\t});\n\tcase CONST.GET_SCHEMA:\n\tcase CONST.CONNECT:\n\tcase CONST.CLASS_FRAME:\n\tcase CONST.WOQL_SELECT:\n\tcase CONST.GET_DOCUMENT:\n\tdefault:\n\t\tif (payload) {\n\t\t\tconst ext = UTILS.URIEncodePayload(payload);\n\t\t\tif (ext) url += `?${ext}`;\n\t\t}\n\t\treturn axios.get(url, options)\n\t\t\t.then((response => response.data))\n\t\t\t.catch((err) => {\n\t\t\t\tthrow new Error(ErrorMessage.getAPIErrorMessage(url, options, err));\n\t\t\t});\n\t}\n}\n\nmodule.exports = DispatchRequest;\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","module.exports = require('./lib/axios');","'use strict';\n\nvar utils = require('./utils');\nvar bind = require('./helpers/bind');\nvar Axios = require('./core/Axios');\nvar mergeConfig = require('./core/mergeConfig');\nvar defaults = require('./defaults');\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n * @return {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  var context = new Axios(defaultConfig);\n  var instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context);\n\n  // Copy context to instance\n  utils.extend(instance, context);\n\n  return instance;\n}\n\n// Create the default instance to be exported\nvar axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Factory for creating new instances\naxios.create = function create(instanceConfig) {\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\n};\n\n// Expose Cancel & CancelToken\naxios.Cancel = require('./cancel/Cancel');\naxios.CancelToken = require('./cancel/CancelToken');\naxios.isCancel = require('./cancel/isCancel');\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\naxios.spread = require('./helpers/spread');\n\nmodule.exports = axios;\n\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = axios;\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\nmodule.exports = function isBuffer (obj) {\n  return obj != null && obj.constructor != null &&\n    typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n","'use strict';\n\nvar utils = require('./../utils');\nvar buildURL = require('../helpers/buildURL');\nvar InterceptorManager = require('./InterceptorManager');\nvar dispatchRequest = require('./dispatchRequest');\nvar mergeConfig = require('./mergeConfig');\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n */\nfunction Axios(instanceConfig) {\n  this.defaults = instanceConfig;\n  this.interceptors = {\n    request: new InterceptorManager(),\n    response: new InterceptorManager()\n  };\n}\n\n/**\n * Dispatch a request\n *\n * @param {Object} config The config specific for this request (merged with this.defaults)\n */\nAxios.prototype.request = function request(config) {\n  /*eslint no-param-reassign:0*/\n  // Allow for axios('example/url'[, config]) a la fetch API\n  if (typeof config === 'string') {\n    config = arguments[1] || {};\n    config.url = arguments[0];\n  } else {\n    config = config || {};\n  }\n\n  config = mergeConfig(this.defaults, config);\n  config.method = config.method ? config.method.toLowerCase() : 'get';\n\n  // Hook up interceptors middleware\n  var chain = [dispatchRequest, undefined];\n  var promise = Promise.resolve(config);\n\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n    chain.push(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  while (chain.length) {\n    promise = promise.then(chain.shift(), chain.shift());\n  }\n\n  return promise;\n};\n\nAxios.prototype.getUri = function getUri(config) {\n  config = mergeConfig(this.defaults, config);\n  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\\?/, '');\n};\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, data, config) {\n    return this.request(utils.merge(config || {}, {\n      method: method,\n      url: url,\n      data: data\n    }));\n  };\n});\n\nmodule.exports = Axios;\n","'use strict';\n\nvar utils = require('./../utils');\n\nfunction InterceptorManager() {\n  this.handlers = [];\n}\n\n/**\n * Add a new interceptor to the stack\n *\n * @param {Function} fulfilled The function to handle `then` for a `Promise`\n * @param {Function} rejected The function to handle `reject` for a `Promise`\n *\n * @return {Number} An ID used to remove interceptor later\n */\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n  this.handlers.push({\n    fulfilled: fulfilled,\n    rejected: rejected\n  });\n  return this.handlers.length - 1;\n};\n\n/**\n * Remove an interceptor from the stack\n *\n * @param {Number} id The ID that was returned by `use`\n */\nInterceptorManager.prototype.eject = function eject(id) {\n  if (this.handlers[id]) {\n    this.handlers[id] = null;\n  }\n};\n\n/**\n * Iterate over all the registered interceptors\n *\n * This method is particularly useful for skipping over any\n * interceptors that may have become `null` calling `eject`.\n *\n * @param {Function} fn The function to call for each interceptor\n */\nInterceptorManager.prototype.forEach = function forEach(fn) {\n  utils.forEach(this.handlers, function forEachHandler(h) {\n    if (h !== null) {\n      fn(h);\n    }\n  });\n};\n\nmodule.exports = InterceptorManager;\n","'use strict';\n\nvar utils = require('./../utils');\nvar transformData = require('./transformData');\nvar isCancel = require('../cancel/isCancel');\nvar defaults = require('../defaults');\nvar isAbsoluteURL = require('./../helpers/isAbsoluteURL');\nvar combineURLs = require('./../helpers/combineURLs');\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n * @returns {Promise} The Promise to be fulfilled\n */\nmodule.exports = function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  // Support baseURL config\n  if (config.baseURL && !isAbsoluteURL(config.url)) {\n    config.url = combineURLs(config.baseURL, config.url);\n  }\n\n  // Ensure headers exist\n  config.headers = config.headers || {};\n\n  // Transform request data\n  config.data = transformData(\n    config.data,\n    config.headers,\n    config.transformRequest\n  );\n\n  // Flatten headers\n  config.headers = utils.merge(\n    config.headers.common || {},\n    config.headers[config.method] || {},\n    config.headers || {}\n  );\n\n  utils.forEach(\n    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n    function cleanHeaderConfig(method) {\n      delete config.headers[method];\n    }\n  );\n\n  var adapter = config.adapter || defaults.adapter;\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData(\n      response.data,\n      response.headers,\n      config.transformResponse\n    );\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData(\n          reason.response.data,\n          reason.response.headers,\n          config.transformResponse\n        );\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Object|String} data The data to be transformed\n * @param {Array} headers The headers for the request or response\n * @param {Array|Function} fns A single function or Array of functions\n * @returns {*} The resulting transformed data\n */\nmodule.exports = function transformData(data, headers, fns) {\n  /*eslint no-param-reassign:0*/\n  utils.forEach(fns, function transform(fn) {\n    data = fn(data, headers);\n  });\n\n  return data;\n};\n","'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n  utils.forEach(headers, function processHeader(value, name) {\n    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n      headers[normalizedName] = value;\n      delete headers[name];\n    }\n  });\n};\n","'use strict';\n\nvar createError = require('./createError');\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n */\nmodule.exports = function settle(resolve, reject, response) {\n  var validateStatus = response.config.validateStatus;\n  if (!validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(createError(\n      'Request failed with status code ' + response.status,\n      response.config,\n      null,\n      response.request,\n      response\n    ));\n  }\n};\n","'use strict';\n\n/**\n * Update an Error with the specified config, error code, and response.\n *\n * @param {Error} error The error to update.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The error.\n */\nmodule.exports = function enhanceError(error, config, code, request, response) {\n  error.config = config;\n  if (code) {\n    error.code = code;\n  }\n\n  error.request = request;\n  error.response = response;\n  error.isAxiosError = true;\n\n  error.toJSON = function() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: this.config,\n      code: this.code\n    };\n  };\n  return error;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\n// Headers whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nvar ignoreDuplicateOf = [\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n];\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} headers Headers needing to be parsed\n * @returns {Object} Headers parsed into an object\n */\nmodule.exports = function parseHeaders(headers) {\n  var parsed = {};\n  var key;\n  var val;\n  var i;\n\n  if (!headers) { return parsed; }\n\n  utils.forEach(headers.split('\\n'), function parser(line) {\n    i = line.indexOf(':');\n    key = utils.trim(line.substr(0, i)).toLowerCase();\n    val = utils.trim(line.substr(i + 1));\n\n    if (key) {\n      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n        return;\n      }\n      if (key === 'set-cookie') {\n        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n      } else {\n        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n      }\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs have full support of the APIs needed to test\n  // whether the request URL is of the same origin as current location.\n    (function standardBrowserEnv() {\n      var msie = /(msie|trident)/i.test(navigator.userAgent);\n      var urlParsingNode = document.createElement('a');\n      var originURL;\n\n      /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n      function resolveURL(url) {\n        var href = url;\n\n        if (msie) {\n        // IE needs attribute set twice to normalize properties\n          urlParsingNode.setAttribute('href', href);\n          href = urlParsingNode.href;\n        }\n\n        urlParsingNode.setAttribute('href', href);\n\n        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n        return {\n          href: urlParsingNode.href,\n          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n          host: urlParsingNode.host,\n          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n          hostname: urlParsingNode.hostname,\n          port: urlParsingNode.port,\n          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n            urlParsingNode.pathname :\n            '/' + urlParsingNode.pathname\n        };\n      }\n\n      originURL = resolveURL(window.location.href);\n\n      /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n      return function isURLSameOrigin(requestURL) {\n        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n        return (parsed.protocol === originURL.protocol &&\n            parsed.host === originURL.host);\n      };\n    })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return function isURLSameOrigin() {\n        return true;\n      };\n    })()\n);\n","'use strict';\n\nvar utils = require('./../utils');\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs support document.cookie\n    (function standardBrowserEnv() {\n      return {\n        write: function write(name, value, expires, path, domain, secure) {\n          var cookie = [];\n          cookie.push(name + '=' + encodeURIComponent(value));\n\n          if (utils.isNumber(expires)) {\n            cookie.push('expires=' + new Date(expires).toGMTString());\n          }\n\n          if (utils.isString(path)) {\n            cookie.push('path=' + path);\n          }\n\n          if (utils.isString(domain)) {\n            cookie.push('domain=' + domain);\n          }\n\n          if (secure === true) {\n            cookie.push('secure');\n          }\n\n          document.cookie = cookie.join('; ');\n        },\n\n        read: function read(name) {\n          var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n          return (match ? decodeURIComponent(match[3]) : null);\n        },\n\n        remove: function remove(name) {\n          this.write(name, '', Date.now() - 86400000);\n        }\n      };\n    })() :\n\n  // Non standard browser env (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return {\n        write: function write() {},\n        read: function read() { return null; },\n        remove: function remove() {}\n      };\n    })()\n);\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nmodule.exports = function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n};\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n * @returns {string} The combined URL\n */\nmodule.exports = function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n};\n","'use strict';\n\nvar Cancel = require('./Cancel');\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @class\n * @param {Function} executor The executor function.\n */\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // Cancellation has already been requested\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n\n/**\n * Returns an object that contains a new `CancelToken` and a function that, when called,\n * cancels the `CancelToken`.\n */\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nmodule.exports = CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n * @returns {Function}\n */\nmodule.exports = function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n};\n","/**\r\n * @file Javascript Terminus Document Classes\r\n * @license Apache Version 2\r\n * @summary Helper classes for accessing documents returned by the Terminus DB API programmatically\r\n * \r\n * Usage: let doc = new TerminusDocument(client);\r\n * \r\n * These set the objects document property and return promises:\r\n *  \r\n * doc.loadDocument(URL) //.then(() => console.log(this.document));\r\n * doc.loadComplete(URL, CLS) // .then(() => console.log(this.document))\r\n * doc.loadSchema(cls) //.then(() => console.log(this.document))\r\n * \r\n * These just set the object's document property \r\n * doc.loadJSON(json_frames, cls) //console.log(this.document)\r\n * doc.loadDataFrames(json_frames, cls)\r\n * doc.loadClassFrames(json_frames, cls)\r\n * \r\n */\r\nconst WOQLClient = require('./woqlClient');\r\nconst FrameHelper = require('./utils');\r\n\r\n\r\n/**\r\n * \r\n * @param {WOQLClient} [client] - woql client object to reuse for loading the doucument\r\n * @summary creates a Terminus Document Object for loading documents from the Terminus Document API\r\n */\r\nfunction TerminusDocument(client){\r\n    this.client = client;\r\n    if(!this.client){\r\n        this.client = new WOQLClient();\r\n    }\r\n}\r\n\r\nTerminusDocument.prototype.db = function(dburl){\r\n    this.client.connectionConfig.setDB(dburl);\r\n    return this;\r\n}\r\n\r\n\r\n\r\n/**\r\n *  @param {String} url - loads the document frame from the document API in frame form\r\n *  @summary - loads the frame encapsulates more meta-data in the json and reduces the number of api calls we need to make\r\n *  @returns {Promise}\r\n */\r\n TerminusDocument.prototype.loadDocument = function(url, encoding){\r\n     encoding = encoding || \"terminus:frame\";\r\n\t return this.client.getDocument(url, {\"terminus:encoding\": encoding})\r\n\t.then((response) => (encoding == \"terminus:frame\" ? this.loadDataFrames(response) : this.loadJSON(response)));\r\n}\r\n\r\nTerminusDocument.prototype.loadSchema = function(cls, dbURL){\r\n\tvar ncls = FrameHelper.unshorten(cls);\r\n\treturn this.client.getClassFrame(dbURL, ncls)\r\n\t.then((response) => this.loadSchemaFrames(response, ncls));\r\n}\r\n\r\n/**\r\n *  @param {String} url - loads the document frame along with its class frame\r\n *  @param {String} [cls] - optional class id of the document - if absent class frames will be loaded from the document class once it is loaded\r\n *  @returns {Promise}\r\n *  @summary - loads a document frame and it's class frame in unison\r\n */\r\n\r\nTerminusDocument.prototype.loadComplete = function(url, cls){\r\n    if(cls){\r\n        return Promise.all([this.loadDocument(url), this.loadDocumentSchema(cls)]);        \r\n    }\r\n    else {\r\n\t    return this.client.getDocument(url, {\"terminus:encoding\": \"terminus:frame\"})\r\n        .then((response) =>  this.loadDocumentSchema(this.document.cls));\r\n    }\r\n}\r\n\r\nTerminusDocument.prototype.loadJSON = function(json, type){\r\n    if(this.docid){\r\n        return this.loadDocument(this.docid);\r\n    }\r\n    else if(this.clsid){\r\n        return this.loadDocumentSchema(this.clsid);\r\n    }\r\n    console.error(\"Either docid or clid must be set before load is called\")\r\n}\r\n\r\nTerminusDocument.prototype.loadDataFrames = function(dataframes, cls, classframes){\r\n\tif(!cls){\r\n\t\tif(this.document) cls = this.document.cls;\r\n\t\telse {\r\n\t\t\tif(dataframes && dataframes.length && dataframes[0] && dataframes[0].domain){\r\n\t\t\t\tcls = dataframes[0].domain;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls, dataframes, classframes);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.document.loadDataFrames(dataframes);\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\" + \" \" + \"Failed to add dataframes due to missing class\");\r\n\t}\r\n}\r\n\r\nTerminusDocument.prototype.loadSchemaFrames = function(classframes, cls){\r\n\tif(!cls){\r\n\t\tif(classframes && classframes.length && classframes[0] && classframes[0].domain){\r\n\t\t\tcls = classframes[0].domain;\r\n\t\t}\r\n\t}\r\n\tif(cls){\r\n\t\tif(!this.document){\r\n\t\t\tthis.document = new TerminusClient.ObjectFrame(cls);\r\n\t\t}\r\n\t\tif(classframes){\r\n\t\t\tthis.document.loadClassFrames(classframes);\r\n\t\t\tif(!this.document.subjid){\r\n\t\t\t\tthis.document.newDoc = true;\r\n\t\t\t\tthis.document.fillFromSchema(\"_:\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"Missing Class\", \"Failed to add class frames due to missing both class and classframes\");\r\n\t}\r\n}\r\n\r\nTerminusDocument.prototype.render = function(){\r\n\tif(!this.renderer && this.document){\r\n\t\tif(this.config.renderer()){\r\n\t\t\tthis.renderer = this.config.renderer();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.applyRulesToDocument(this.document, this.config);\r\n\t\t\tthis.renderer = this.document;\r\n\t\t}\r\n\t}\r\n\tif(this.renderer && this.renderer.render){\r\n\t\treturn this.renderer.render(this.document);\r\n\t}\r\n\telse if(typeof this.renderer == \"function\"){\r\n\t\tvar x = this.renderer(this.document);\r\n\t\treturn x;\r\n\t}\r\n\telse {\r\n\t\tconsole.log(\"didna make it - no render function for document\");\r\n\t}\r\n}\r\n\r\n/*\r\n * adds render and compare functions to object frames\r\n */\r\nTerminusDocument.prototype.applyRulesToDocument = function(doc, config){\r\n\tvar self = this;\r\n\tfunction onmatch(frame, rule){\r\n\t\tif(typeof rule.render() != \"undefined\"){\r\n\t\t\tframe.render = rule.render();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(rule.renderer()){\r\n\t\t\t\tvar renderer = self.loadRenderer(rule.renderer(), frame, rule.args);\t\t\r\n\t\t\t}\r\n\t\t\tif(renderer && renderer.render){\r\n\t\t\t\tframe.render = function(frame){\r\n\t\t\t\t\treturn renderer.render(frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(rule.compare()){\r\n\t\t\tframe.compare = rule.compare();\r\n\t\t}\r\n\t\tconfig.setFrameDisplayOptions(frame, rule);\r\n\t}\r\n\tif(doc.render){\r\n\t\tfunction clearDisplay(frame, rule){\r\n\t\t\tdelete(frame['render']);\r\n\t\t\tdelete(frame['display_options']);\r\n\t\t\tframe.compare = TerminusClient.ObjectFrame.prototype.compare;\r\n\t\t}\r\n\t\tvar nconfig = TerminusClient.WOQL.document();\r\n\t\tnconfig.all();\r\n\t\tdoc.filter(nconfig.rules, clearDisplay);\r\n\t}\r\n\tdoc.filter(config.rules, onmatch);\r\n}\r\n\r\n\r\n/**\r\n * Represents a frame for programmatic access to object frame, anywhere within a document\r\n * Recursive data structure where this.children contains an indexed array of object frames\r\n * and this.dataframes contains a property indexed array of data frames\r\n * Every object frame carries a reference to its classframe\r\n * This gives us instructions as to how to create new frames according to the schema\r\n * After that it's turtles all the way down.\r\n * @param cls - ID of the class (URL)\r\n * @param classframe - an array of frames representing a class\r\n * @param archetypes list of class frames\r\n * @param parent parent object\r\n * @returns\r\n */\r\n\r\nfunction ObjectFrame(cls, dataframes, classframes, parent, parentframe) {\r\n\t// the class of the frame - mandatory\r\n\tthis.empty();\r\n\tthis.cls = cls;\r\n\r\n\t// array of frames representing the full class frame\r\n\t// (optional - required to be able to safely add missing properties)\r\n\tif (classframes && typeof classframes === 'object') {\r\n\t\tthis.loadClassFrames(classframes);\r\n\t}\r\n\tif (dataframes && typeof dataframes === 'object') {\r\n\t\tthis.originalFrames = dataframes;\r\n\t\tthis.loadDataFrames(dataframes);\r\n\t} else {\r\n\t\tthis.originalFrames = false;\r\n\t}\r\n\t// parent object frame\r\n\tthis.parent = parent;\r\n\t// original frame used by parent to create me\r\n\tthis.parentframe = parentframe;\r\n\t// set to true if this is a newly created document\r\n\tthis.newDoc = false;\r\n}\r\n\r\n/**\r\n * Loads class frames for the object's class - the instructions about how to put an object together\r\n */\r\nObjectFrame.prototype.loadClassFrames = function (classframes) {\r\n\tfor (let j = 0; j < classframes.length; j += 1) {\r\n\t\tif (classframes[j]['@context']) this.jsonld_context = classframes[j]['@context'];\r\n\r\n\t\tconst cf = new ClassFrame(classframes[j]);\r\n\t\tif (cf.isValid()) {\r\n\t\t\tif(!this.classframes) this.classframes = {};\r\n\t\t\tif(typeof this.classframes[classframes[j].property] === 'undefined') {\r\n\t\t\t\tthis.classframes[classframes[j].property] = [];\r\n\t\t\t}\r\n\t\t\tthis.classframes[classframes[j].property] = cf;\r\n\t\t\tif (cf.isObject() && this.properties[classframes[j].property]) {\r\n\t\t\t\tfor (let i = 0; i < this.properties[classframes[j].property].values.length; i += 1) {\r\n\t\t\t\t\tthis.properties[classframes[j].property].values[i].loadClassFrames(classframes[j].frame);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/**\r\n * Does this object have a schema loaded?\r\n */\r\nObjectFrame.prototype.hasSchema = function () {\r\n\treturn !FrameHelper.empty(this.classframes);\r\n};\r\n\r\n/*\r\n * Loads an array of data frames into the object's internal index\r\n * {property: [frames]}\r\n */\r\nObjectFrame.prototype.loadDataFrames = function (frames) {\r\n\tif (typeof frames !== 'object' || !frames.length) return undefined;\r\n\tif (!this.originalFrames) this.originalFrames = frames;\r\n\tif (!this.subjid && frames[0].domainValue) this.subjid = frames[0].domainValue;\r\n\tfor (let i = 0; i < frames.length; i += 1) {\r\n\t\tif (frames[i]['@context']) this.jsonld_context = frames[i]['@context'];\r\n\t\tlet cframe = this.getPropertyClassFrame(frames[i].property, frames[i]);\r\n\t\tif (cframe.isClassChoice()) {\r\n\t\t\tcframe = cframe.getChosenClassFrame(frames[i].range);\r\n\t\t\tif (!cframe) {\r\n\t\t\t\tconsole.log(`no choice frame ${frames[i].range}`);\r\n\t\t\t}\r\n\t\t} else if (cframe.isLogic()) {\r\n\t\t\tcframe = cframe.getChosenFrame(frames[i]);\r\n\t\t}\r\n\t\tif (cframe) {\r\n\t\t\tif (typeof this.properties[frames[i].property] === 'undefined') {\r\n\t\t\t\tthis.properties[frames[i].property] = new PropertyFrame(frames[i].property, cframe, this);\r\n\t\t\t}\r\n\t\t\tthis.properties[frames[i].property].addFrame(frames[i]);\r\n\t\t}\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Serialises the javascript object as an array of frames\r\n */\r\nObjectFrame.prototype.getAsFrame = function (prop, parent) {\r\n\tif (this.parentframe) return this.parentframe;\r\n\tconst ff = { type: 'objectProperty', property: prop };\r\n\tff.range = this.cls;\r\n\tff.domain = parent.cls;\r\n\tff.domainValue = parent.subjid;\r\n\tff.frame = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tff.frame = ff.frame.concat(ff.frame, this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn ff;\r\n};\r\n\r\nObjectFrame.prototype.getAsFrames = function (prop, parent) {\r\n\tvar frames = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tframes = frames.concat(frames, this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn frames;\r\n}\r\n\r\n/**\r\n * Cleans out object and sets everything empty\r\n */\r\nObjectFrame.prototype.empty = function () {\r\n\t// all indexed by property\r\n\tthis.properties = {};\r\n\tthis.restrictions = {};\r\n\tthis.subjid = false;\r\n\tthis.cls = false;\r\n};\r\n\r\n/*\r\n * Resets object state to original state\r\n */\r\nObjectFrame.prototype.reset = function (prop) {\r\n\tif (prop) {\r\n\t\tconst props = [];\r\n\t\tfor (let i = 0; i < this.originalFrames.length; i += 1) {\r\n\t\t\tif (this.originalFrames[i].property === prop) {\r\n\t\t\t\tprops.push(this.originalFrames[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this.properties[prop]) this.properties[prop] = [];\r\n\t\tthis.loadDataFrames(props);\r\n\t} else {\r\n\t\tthis.restrictions = {};\r\n\t\tthis.properties = {};\r\n\t\tthis.loadDataFrames(this.originalFrames);\r\n\t}\r\n};\r\n\r\n/*\r\n * Clears out any specific information from a tree\r\n */\r\nObjectFrame.prototype.clear = function () {\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.properties[prop].clear();\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Filters the frame and its children\r\n */\r\nObjectFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\t//var hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\t//if(hits.length || cascading){\r\n\t\tfor (const prop of Object.keys(this.properties)) {\r\n\t\t\tthis.properties[prop].filter(rules, onmatch, options);\r\n\t\t}\r\n\t//}\r\n\treturn this;\r\n};\r\n\r\n\r\n/**\r\n * If a class frame is present, it is returned for the given property\r\n * If no class frame is present and an instance frame is passed in the\r\n * this enables make it up as you go along editing\r\n * second argument a class frame will be created from the instance frame.\r\n */\r\nObjectFrame.prototype.getPropertyClassFrame = function (prop, instance) {\r\n\tif (this.classframes && typeof this.classframes === 'object' && typeof this.classframes[prop] === 'object') {\r\n\t\treturn this.classframes[prop];\r\n\t}\r\n\tif (instance) {\r\n\t\tconst cf = new ClassFrame(instance);\r\n\t\treturn cf;\r\n\t}\r\n\tif (this.properties[prop]) {\r\n\t\treturn new ClassFrame(this.properties[prop].values[0]);\r\n\t}\r\n\treturn false;\r\n};\r\n\r\n/*\r\n * Returns a list of properties - type can be filled|missing|all\r\n */\r\nObjectFrame.prototype.getProperties = function (type) {\r\n\tif(type == \"filled\" || !this.classframes){\r\n\t\treturn Object.keys(this.properties);\r\n\t}\r\n\tif (type == 'missing') {\r\n\t\tconst filled = Object.keys(this.properties);\r\n\t\tconst all = Object.keys(this.classframes);\r\n\t\tconst missing = [];\r\n\t\tfor (let i = 0; i < all.length; i++) {\r\n\t\t\tif (filled.indexOf(all[i]) == -1 && missing.indexOf(all[i]) == -1) {\r\n\t\t\t\tmissing.push(all[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn missing;\r\n\t}\r\n\treturn Object.keys(this.classframes);\r\n};\r\n\r\n/**\r\n * Missing properties are those that are present in the classframe,\r\n * but not instantiated in the current object frame\r\n * for this to work we need to load the frame with the associated classframe\r\n */\r\nObjectFrame.prototype.getMissingPropertyList = function () {\r\n\tvar missing = this.getProperties(\"missing\");\r\n\tconst nmissing = [];\r\n\tfor (let i = 0; i < missing.length; i++) {\r\n\t\tconst cframe = this.getPropertyClassFrame(missing[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: missing[i] };\r\n\t\tnmissing.push(newb);\r\n\t}\r\n\treturn nmissing;\r\n};\r\n\r\n/**\r\n * List of properties that are filled in the object\r\n */\r\nObjectFrame.prototype.getFilledPropertyList = function () {\r\n\tvar props = this.getProperties(\"filled\");\r\n\tconst filled = [];\r\n\tfor (let i = 0; i < props.length; i++) {\r\n\t\tconst cframe = this.getPropertyClassFrame(props[i]);\r\n\t\tconst newb = { label: cframe.getLabel(), value: props[i] };\r\n\t\tfilled.push(newb);\r\n\t}\r\n\treturn filled;\r\n};\r\n\r\n/*\r\n * Fills the object frame from the schema - adding all the necessary property frames, etc to make it complete\r\n */\r\nObjectFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (newid) this.subjid = newid;\r\n\tnewid = (newid || FrameHelper.genBNID());\r\n\tconst properties = {};\r\n\tif(this.classframes){\r\n\t\tfor (const prop of Object.keys(this.classframes)) {\r\n\t\t\tconst pf = this.getPropertyClassFrame(prop);\r\n\t\t\tproperties[prop] = new PropertyFrame(prop, pf, this);\r\n\t\t\tproperties[prop].fillFromSchema(newid);\r\n\t\t}\r\n\t}\r\n\tthis.properties = properties;\r\n\tthis.originalFrames = [];\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tthis.originalFrames.push(this.properties[prop].getAsFrames());\r\n\t}\r\n\treturn this;\r\n};\r\n\r\n/*\r\n * Clones an object frame to be a copy of the current frame\r\n */\r\nObjectFrame.prototype.clone = function (newid) {\r\n\tconst properties = {};\r\n\tconst cloned = new ObjectFrame(this.cls, false, false, this.parent);\r\n\tcloned.classframes = this.classframes;\r\n\tcloned.subjid = newid;\r\n\tfor (const prop of Object.keys(this.properties)) {\r\n\t\tproperties[prop] = this.properties[prop].clone();\r\n\t}\r\n\tcloned.properties = properties;\r\n\treturn cloned;\r\n};\r\n\r\n\r\n/**\r\n * Returns a child frame with a particular id\r\n * If the second parameter is included, it will only look in that specific property\r\n * Otherwise searches all properties for the child\r\n */\r\nObjectFrame.prototype.getChild = function (childid, prop) {\r\n\tlet pframe = this.getProperty(prop);\r\n\tfor (let i = 0; i < pframe.values.length; pframe++) {\r\n\t\tif (pframe.values[i].isObject() && pframe.values[i].subject === childid) return pframe.values[i];\r\n\t}\r\n\tif (!prop) {\r\n\t\tfor (const key of Object.keys(this.properties)) {\r\n\t\t\tfor (let i = 0; i < this.properties[key].values.length; i += 1) {\r\n\t\t\t\tif (this.properties[key].values[i].subject() === childid) return this.properties[key].values[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.addProperty = function (prop, cls) {\r\n\tconst cframe = this.getPropertyClassFrame(prop);\r\n\tconst nprop = new PropertyFrame(prop, cframe, this);\r\n\tif (nprop.isData()) {\r\n\t\tconst df = cframe.copy();\r\n\t\tdf.set('');\r\n\t}\r\n\tif (cframe.isObject()) {\r\n\t\tif (!cframe.isClassChoice()) {\r\n\t\t\tconst df = cframe.createEmpty(FrameHelper.genBNID());\r\n\t\t}\r\n\t\tif (cls) {\r\n\t\t\tconst df = cframe.createEmptyChoice(cls, FrameHelper.genBNID());\r\n\t\t}\r\n\t\tconst clss = cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst df = cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t}\r\n\t}\r\n\tif (typeof this.properties[prop] === 'undefined') {\r\n\t\tthis.properties[prop] = [];\r\n\t}\r\n\tthis.properties[prop].push(df);\r\n\treturn df;\r\n};\r\n\r\nObjectFrame.prototype.addPropertyValue = function (prop, value) {\r\n\tconst pframe = this.properties[prop];\r\n\treturn pframe.addValue(value);\r\n};\r\n\r\nObjectFrame.prototype.removeProperty = function (prop) {\r\n\tif (typeof this.properties[prop] !== 'undefined') {\r\n\t\tdelete (this.properties[prop]);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.removePropertyValue = function (prop, value, index) {\r\n\tconst pframe = this.properties[prop];\r\n\tpframe.removeValue(value, index);\r\n\tif (pframe.values.length == 0) {\r\n\t\tthis.removeProperty(prop);\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.error = function (msg) {\r\n\tconsole.error(msg);\r\n};\r\n\r\n\r\nObjectFrame.prototype.subject = function () {\r\n\treturn this.subjid;\r\n};\r\n\r\nObjectFrame.prototype.get = ObjectFrame.prototype.subject;\r\n\r\nObjectFrame.prototype.isObject = function () { return true; };\r\nObjectFrame.prototype.isProperty = function () { return false; };\r\nObjectFrame.prototype.isData = function () { return false; };\r\n\r\n\r\nObjectFrame.prototype.subjectClass = function () {\r\n\treturn this.cls;\r\n};\r\n\r\nObjectFrame.prototype.depth = function () {\r\n\tif (this.parent) return (this.parent.depth() + 1);\r\n\treturn 0;\r\n};\r\n\r\nObjectFrame.prototype.getProperty = function (prop) {\r\n\treturn this.properties[prop];\r\n};\r\n\r\nObjectFrame.prototype.first = function (prop) {\r\n\tif (this.properties && this.properties[prop]) {\r\n\t\treturn this.properties[prop].first();\r\n\t}\r\n};\r\n\r\nObjectFrame.prototype.property = function (prop) {\r\n\tif (this.parent) return this.parent.property();\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.parentObject = function () {\r\n\tif (this.parent && this.parent.parent) {\r\n\t\treturn this.parent.parent;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.root = function () {\r\n\tif (this.parent) return false;\r\n\treturn true;\r\n};\r\n\r\nObjectFrame.prototype.renderProperties = function () {\r\n\tconst props = this.sortProperties();\r\n\tconst nprops = [];\r\n\tfor (let i = 0; i < props.length; i++) {\r\n\t\tif (this.properties[props[i]].render) {\r\n\t\t\tconst rend = this.properties[props[i]].render(this.properties[props[i]]);\r\n\t\t\tif (rend) nprops.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn nprops;\r\n};\r\n\r\nObjectFrame.prototype.sortProperties = function () {\r\n\tconst unsorted = Object.keys(this.properties);\r\n\tif (this.compare) {\r\n\t\treturn unsorted.sort((a, b) => this.compare(a, b, this));\r\n\t}\r\n\treturn unsorted.sort((a, b) => this.standardCompare(a, b, this));\r\n};\r\n\r\n/*\r\n * Label first, then datatype properties, then object properties\r\n */\r\nObjectFrame.prototype.standardCompare = function (a, b, doc) {\r\n\tif (a == 'rdfs:label') return -1;\r\n\tif (b == 'rdfs:label') return 1;\r\n\tif (a == 'rdfs:comment') return -1;\r\n\tif (b == 'rdfs:comment') return 1;\r\n\tif (doc.properties[a].isData() && doc.properties[b].isObject()) return -1;\r\n\tif (doc.properties[b].isData() && doc.properties[a].isObject()) return 1;\r\n\treturn 0;\r\n};\r\n\r\nObjectFrame.prototype.cardControlAllows = function(action){\r\n\tif(!this.parent) return true;\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nObjectFrame.prototype.isUpdated = function(){\r\n\tvar i = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tif(this.originalFrames[i] != prop) return true;\r\n\t\tif(this.properties[prop].isUpdated()) return true;\r\n\t\ti++;\r\n\t}\r\n\tif(i != this.originalFrames.length) return true;\r\n\treturn false;\r\n}\r\n\r\nObjectFrame.prototype.isNew = function(){\r\n\treturn (this.subject().substring(0, 2) == \"_:\");\r\n}\r\n\r\nObjectFrame.prototype.getSummary = function(){\r\n\tvar ret = { status: \"ok\" };\r\n\tif(this.isUpdated()) ret.status = \"updated\";\r\n\tif(this.isNew()) ret.status = \"new\";\r\n\tret.propcount = 0;\r\n\tfor(var prop in this.properties){\r\n\t\tret.propcount++;\r\n\t}\r\n\tret.long = ret.propcount + \" properties\";\r\n\treturn ret;\r\n}\r\n\r\nfunction PropertyFrame(property, cframe, parent) {\r\n\tthis.predicate = property;\r\n\tthis.cframe = cframe;\r\n\tthis.parent = parent;\r\n\tthis.values = [];\r\n}\r\n\r\nPropertyFrame.prototype.addFrame = function (frame) {\r\n\tif(this.cframe.isData()){\r\n\t\tvar df = new DataFrame(frame, this, this.values.length);\r\n\t\tthis.values.push(df);\r\n\t} else {\r\n\t\tconst kid = new ObjectFrame(this.range(), cframe.frame, frame.frame, this, frame);\r\n\t\tthis.values.push(kid);\r\n\t}\r\n};\r\n\r\nPropertyFrame.prototype.fillFromSchema = function (newid) {\r\n\tif (this.isData() || (this.isObject() && !this.isClassChoice())) {\r\n\t\tvar values = [];\r\n\t\tif (this.cframe.hasRestriction() && this.cframe.restriction.min) {\r\n\t\t\tfor (let i = 0; i < this.cframe.restriction.min; i += 1) {\r\n\t\t\t\tvar nframe = this.createEmpty(newid);\r\n\t\t\t\tnframe.parent = this;\r\n\t\t\t\tvalues.push(nframe);\r\n\t\t\t}\r\n\t\t} \r\n\t\telse {\r\n\t\t\tvar nframe = this.createEmpty(newid);\r\n\t\t\tnframe.parent = this;\r\n\t\t\tvalues.push(nframe);\r\n\t\t}\r\n\t\tthis.values = values;\r\n\t}\r\n\telse if (this.isClassChoice()) {\r\n\t\tconst clss = this.cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst empty = this.cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t\tempty.parent = this;\r\n\t\t\tthis.values = [empty];\r\n\t\t}\r\n\t}\r\n};\r\n\r\nPropertyFrame.prototype.isData = function () {\r\n\treturn this.cframe.isData();\r\n};\r\n\r\nPropertyFrame.prototype.isObject = function () {\r\n\treturn this.cframe.isObject();\r\n};\r\n\r\nPropertyFrame.prototype.isProperty = function () {\r\n\treturn true;\r\n};\r\n\r\nPropertyFrame.prototype.property = function () {\r\n\treturn this.predicate;\r\n};\r\n\r\nPropertyFrame.prototype.extract = function () {\r\n \tconst extracts = [];\r\n \tfor (let i = 0; i < this.values.length; i++) {\r\n \t\tconst val = this.values[i].extract();\r\n \t\tif (val !== '' && val !== false && typeof val !== 'undefined') extracts.push(val);\r\n \t}\r\n\treturn extracts;\r\n};\r\n\r\nPropertyFrame.prototype.subject = function () {\r\n\treturn (this.parent ? this.parent.subject() : false);\r\n};\r\nPropertyFrame.prototype.subjectClass = function () {\r\n\treturn (this.parent ? this.parent.subjectClass() : false);\r\n};\r\nPropertyFrame.prototype.depth = function () {\r\n\treturn (this.parent ? this.parent.depth() : false);\r\n};\r\nPropertyFrame.prototype.updated = function () {\r\n\treturn (this.parent ? this.parent.childUpdated() : false);\r\n};\r\nPropertyFrame.prototype.range = function () {\r\n\treturn (this.cframe ? this.cframe.range : '');\r\n};\r\nPropertyFrame.prototype.getLabel = function () {\r\n\treturn (\r\n\t\tthis.cframe ? this.cframe.getLabel() : '');\r\n};\r\nPropertyFrame.prototype.getComment = function () {\r\n\treturn (this.cframe ? this.cframe.getComment() : false);\r\n};\r\nPropertyFrame.prototype.hasCardinalityRestriction = function () {\r\n\treturn (this.cframe ? this.cframe.hasRestriction() : false);\r\n};\r\nPropertyFrame.prototype.getRestriction = function () {\r\n\treturn (this.cframe ? this.cframe.restriction : false);\r\n};\r\nPropertyFrame.prototype.isClassChoice = function () {\r\n\treturn (this.cframe ? this.cframe.isClassChoice() : false);\r\n};\r\n\r\nPropertyFrame.prototype.deletePropertyValue = function (value, index) {\r\n\tthis.parent.removePropertyValue(this.property(), value, index);\r\n};\r\n\r\nPropertyFrame.prototype.get = function(){\r\n\tvar gets = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i]) {\r\n\t\t\tvar x = this.values[i].get();\r\n\t\t\tif(x) gets.push(x);\r\n\t\t}\r\n\t}\r\n\treturn gets;\r\n}\r\n\r\nPropertyFrame.prototype.clear = function(){\r\n\tfor(var i = 0 ; i<this.values.length; i++){\r\n\t\tthis.values[i].clear();\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.clone = function(){\r\n\tconst cvalues = [];\r\n\tconst cloned = new PropertyFrame(this.predicate, this.cframe, this.parent);\r\n\tfor(var i = 0 ; i<this.values.length; i++){\r\n\t\tcvalues.push(this.values[i].clone());\r\n\t}\r\n\tcloned.values = cvalues;\r\n\treturn cloned;\r\n\t//\r\n}\r\n\r\nPropertyFrame.prototype.getAsFrames = function(){\r\n\tvar fs = [];\r\n\tfor(var i = 0; i<this.values.length; i++){\r\n\t\tif(this.values[i]){\r\n\t\t\tif(this.isData()){\r\n\t\t\t\tfs.push(this.values[i].getAsFrame());\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfs = fs.concat(this.values[i].getAsFrames());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn fs;\r\n}\r\n\r\nPropertyFrame.prototype.createEmpty = function(){\r\n\tif (this.cframe.isData()) {\r\n\t\tconst df = this.cframe.copy();\r\n\t\tdf.set('');\r\n\t\treturn df;\r\n\t}\r\n\telse if (this.cframe.isObject()) {\r\n\t\tif (!this.cframe.isClassChoice()) {\r\n\t\t\tconst df = this.cframe.createEmpty(FrameHelper.genBNID());\r\n\t\t\treturn df;\r\n\t\t}\r\n\t\tconst clss = this.cframe.getClassChoices();\r\n\t\tif (clss && clss.length) {\r\n\t\t\tconst df = this.cframe.createEmptyChoice(clss[0], FrameHelper.genBNID());\r\n\t\t\treturn df;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nPropertyFrame.prototype.filter = function (rules, onmatch, options) {\r\n\tconst cascading = (options && options.ignore_failure ? true : false);\r\n\t//var hits = FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\t//if(hits.length || cascading){\r\n\t\tfor (var i = 0; i<this.values.length; i++){\r\n\t\t\tthis.values[i].filter(rules, onmatch, options);\r\n\t\t}\r\n\t//}\r\n\treturn this;\r\n}\r\n\r\n/*\r\n * Shorthand functions to make it easier to access the underlying data\r\n */\r\n\r\nPropertyFrame.prototype.first = function () {\r\n\tif (this.values && this.values[0]) {\r\n\t\treturn this.values[0].get();\r\n\t}\r\n};\r\n\r\nPropertyFrame.prototype.renderValues = function(){\r\n\tvar sortedVals = this.sortValues();\r\n\tvar vals = [];\r\n\tfor(var i = 0; i<sortedVals.length; i++){\r\n\t\tif(sortedVals[i] && sortedVals[i].render){\r\n\t\t\tvar rend = sortedVals[i].render(sortedVals[i]);\r\n\t\t\tif(rend) vals.push(rend);\r\n\t\t}\r\n\t}\r\n\treturn vals;\r\n};\r\n\r\nPropertyFrame.prototype.sortValues = function () {\r\n\tif (this.compare) {\r\n\t\treturn this.values.sort((a, b) => this.compare(a, b, this));\r\n\t}\r\n\treturn this.values;\r\n};\r\n\r\nPropertyFrame.prototype.cardControlAllows = function(action){\r\n\tif(this.cframe.hasRestriction()){\r\n\t\tvar rest = this.cframe.restriction;\r\n\t\tvar currentnum = this.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nPropertyFrame.prototype.isUpdated = function(){\r\n\treturn true;\r\n\tif(this.values.length != this.originalValues.length) return true;\r\n\tfor(var i = 0 ; i < this.values.length; i++){\r\n\t\tif(this.cframe && this.cframe.isData()){\r\n\t\t\tif(this.values[i].value() != this.originalValues[i]){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif(this.values[i].subject() != this.originalValues[i]) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(this.values[i].isUpdated()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\nfunction DataFrame(frame, parent, index) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tthis.index = index;\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nDataFrame.prototype.load = function (frame) {\r\n\tif (typeof frame !== 'object') {\r\n\t\tthis.error('No frame passed to load');\r\n\t\treturn;\r\n\t}\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = frame.type;\r\n\tthis.predicate = frame.property;\r\n\tthis.range = frame.range;\r\n\tthis.rangeValue = frame.rangeValue;\r\n\tthis.domain = frame.domain;\r\n\tthis.domainValue = frame.domainValue;\r\n\tthis.frame = frame.frame;\r\n\tthis.label = frame.label;\r\n\tthis.comment = frame.comment;\r\n\tconst { restriction } = frame;\r\n\tthis.restriction = false;\r\n\tif (restriction && typeof restriction === 'object') {\r\n\t\tthis.restriction = new Restriction(restriction);\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.filter = function (rules, onmatch) {\r\n\t//FramePattern.FramePatternMatcher.testRules(rules, this, onmatch);\r\n\treturn this;\r\n};\r\n\r\nDataFrame.prototype.delete = function () {\r\n\tthis.parent.deletePropertyValue(this.get(), this.index);\r\n};\r\n\r\nDataFrame.prototype.save = function () {\r\n\tif (this.parent) {\r\n\t\tthis.parent.save();\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.reset = function () {\r\n\tthis.set(this.originalValue);\r\n\t// this.redraw();\r\n};\r\n\r\nDataFrame.prototype.clone = function () {\r\n\tconst newb = this.parent.addPropertyValue(this.get());\r\n\tconst nrend = this.copy(newb);\r\n\tnrend.setNew();\r\n\tnrend.mode = 'edit';\r\n\tnrend.index = this.parent.values.length;\r\n\tthis.parent.values.push(nrend);\r\n};\r\n\r\n\r\nDataFrame.prototype.depth = function () { return (this.parent ? this.parent.depth() : false); };\r\nDataFrame.prototype.property = function () { return (this.parent ? this.parent.property() : false); };\r\nDataFrame.prototype.subject = function () { return (this.parent ? this.parent.subject() : false); };\r\nDataFrame.prototype.subjectClass = function () { return (this.parent ? this.parent.subjectClass() : false); };\r\nDataFrame.prototype.range = function () {\treturn (this.frame ? this.frame.range : false); };\r\n\r\nDataFrame.prototype.isValidType = function (dt) {\r\n\tconst vtypes = ['datatypeProperty', 'objectProperty', 'restriction '];\r\n\tif (vtypes.indexOf(dt) === -1) return false;\r\n\treturn true;\r\n};\r\n\r\n\r\nDataFrame.prototype.getAsFrame = function () {\r\n\t const ff = { type: this.type, property: this.property() };\r\n\t if (this.range) ff.range = this.range;\r\n\t if (this.rangeValue) ff.rangeValue = this.rangeValue;\r\n\t if (this.domain) ff.domain = this.domain;\r\n\t if (this.domainValue) ff.domainValue = this.domainValue;\r\n\t if (this.frame) ff.frame = this.frame;\r\n\t if (this.label) ff.label = this.label;\r\n\t if (this.comment) ff.comment = this.comment;\r\n\t return ff;\r\n};\r\n\r\nDataFrame.prototype.hasRestriction = function () {\r\n\t if (this.restriction) {\r\n\t\t return this.restriction.hasCardRestriction();\r\n\t }\r\n\t return false;\r\n};\r\n\r\nDataFrame.prototype.copy = function (newid) {\r\n\tconst copy = new DataFrame(this, this.parent);\r\n\tif (newid) copy.domainValue = newid;\r\n\treturn copy;\r\n};\r\n\r\nDataFrame.prototype.getLabel = function () {\r\n\tlet lab = '';\r\n\tif(this.predicate == \"rdfs:label\") return \"Name\";\r\n\tif(this.predicate == \"rdfs:comment\") return \"Description\";\r\n\tif (this.label && typeof this.label === 'object') lab = this.label['@value'];\r\n\tif (this.label && typeof this.label === 'string') lab = this.label;\r\n\t// always return something\r\n\tif (!lab && this.property()) lab = FrameHelper.labelFromURL(this.property());\r\n\tif (!lab) lab = FrameHelper.labelFromURL(this.cls);\r\n\treturn lab;\r\n};\r\n\r\nDataFrame.prototype.getType = function () {\r\n\tif (this.range) return this.range;\r\n\tif (this.rangeValue && this.rangeValue.type) return this.rangeValue.type;\r\n\treturn false;\r\n};\r\n\r\nObjectFrame.prototype.getLabel = DataFrame.prototype.getLabel;\r\n\r\nDataFrame.prototype.getComment = function () {\r\n\tlet comment = '';\r\n\tif (this.comment && typeof this.comment === 'object') comment = this.comment['@value'];\r\n\tif (this.comment && typeof this.comment === 'string') comment = this.comment;\r\n\treturn comment;\r\n};\r\n\r\nObjectFrame.prototype.getComment = DataFrame.prototype.getComment;\r\n\r\n\r\nDataFrame.prototype.error = function (msg) {\r\n\tif (msg)\tthis.err = msg;\r\n\treturn this.err;\r\n};\r\n\r\nDataFrame.prototype.isValid = function () {\r\n\tif (!(this.type && this.isValidType(this.type))) {\r\n\t\tthis.error(`Missing or Illegal Frame Type ${this.type}`);\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.predicate)) {\r\n\t\tthis.error('Missing Frame Property');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.domain)) {\r\n\t\tthis.error('Missing Frame Domain');\r\n\t\treturn false;\r\n\t}\r\n\tif (!(this.range)) {\r\n\t\tthis.error('Missing Frame Range');\r\n\t\treturn false;\r\n\t}\r\n\tif (this.isObjectProperty() && !(this.frame && typeof this.frame === 'object')) {\r\n\t\tthis.error('Missing Object Frame');\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\nDataFrame.prototype.isObjectProperty = function () {\r\n\treturn this.type === 'objectProperty';\r\n};\r\n\r\nDataFrame.prototype.isDatatypeProperty = function () {\r\n\treturn this.type === 'datatypeProperty';\r\n};\r\n\r\nDataFrame.prototype.isLogic = function () {\r\n\tif (this.type === 'and' || this.type === 'or' || this.type === 'xor') {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.isRestriction = function () {\r\n\treturn this.type === 'restriction';\r\n};\r\n\r\nDataFrame.prototype.ftype = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isDatatypeProperty()) return 'data';\r\n\tif (this.isChoice()) return 'oneOf';\r\n\tif (this.isObject()) return 'object';\r\n\tif (this.isLogic()) return 'logic';\r\n\tif (this.isClassChoice()) return 'class_choice';\r\n\treturn undefined;\r\n};\r\n\r\n\r\nDataFrame.prototype.isClassChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'class_choice');\r\n};\r\n\r\nDataFrame.prototype.isString = function () {\r\n\tif (this.range === FrameHelper.getStdURL('xsd', 'string')) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getChoiceOptions = function () {\r\n\tconst opts = [];\r\n\tfor (let i = 0; i < this.frame.elements.length; i += 1) {\r\n\t\tconst option = {};\r\n\t\tif (this.frame.elements[i].label) {\r\n\t\t\toption.label = this.frame.elements[i].label['@value'];\r\n\t\t} else {\r\n\t\t\toption.label = FrameHelper.labelFromURL(this.frame.elements[i].class);\r\n\t\t}\r\n\t\toption.value = this.frame.elements[i].class;\r\n\t\topts.push(option);\r\n\t}\r\n\treturn opts;\r\n};\r\n\r\nDataFrame.prototype.lang = function () {\r\n\treturn 'en';\r\n};\r\n\r\nDataFrame.prototype.isChoice = function () {\r\n\treturn (this.frame && this.frame.type === 'oneOf');\r\n};\r\n\r\nDataFrame.prototype.isDocument = function () {\r\n\treturn (this.frame && this.frame.type === 'document');\r\n};\r\n\r\nDataFrame.prototype.isData = function () {\r\n\treturn (this.isDocument() || this.isChoice() || this.isDatatypeProperty());\r\n};\r\n\r\nDataFrame.prototype.isObject = function () {\r\n\treturn (this.isObjectProperty() && this.frame && !(this.isChoice() || this.isDocument()));\r\n};\r\n\r\nDataFrame.prototype.isProperty = function () {\r\n\treturn false;\r\n};\r\n\r\nDataFrame.prototype.getTypeShorthand = function () {\r\n\tif (this.isDocument()) return 'document';\r\n\tif (this.isChoice()) return 'choice';\r\n\tconst sh = FrameHelper.getShorthand(this.getType());\r\n\treturn (sh || this.getType());\r\n};\r\n\r\nDataFrame.prototype.get = function () {\r\n\tif (this.contents) {\r\n\t\treturn this.contents;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue && typeof this.rangeValue['@value'] !== 'undefined') {\r\n\t\treturn this.rangeValue['@value'];\r\n\t}\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\treturn this.frame.domainValue;\r\n\t}\r\n\treturn '';\r\n};\r\n\r\nDataFrame.prototype.set = function (value, normalizer) {\r\n\tif (normalizer) value = normalizer(value, this);\r\n\tthis.contents = value;\r\n\tif (this.isChoice() || this.isDocument()) {\r\n\t\tthis.frame.domainValue = value;\r\n\t}\r\n\tif (this.isDatatypeProperty() && this.rangeValue) {\r\n\t\tthis.rangeValue['@value'] = value;\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.clear = function () {\r\n\tif (this.isDocument() || this.isChoice() || this.isDatatypeProperty()) {\r\n\t\tthis.set('');\r\n\t}\r\n};\r\n\r\nDataFrame.prototype.cardControlAllows = function(action){\r\n\tif(this.parent.cframe.hasRestriction()){\r\n\t\tvar rest = this.parent.cframe.restriction;\r\n\t\tvar currentnum = this.parent.values.length;\r\n\t\tif(action == \"add\" || action == \"clone\"){\r\n\t\t\tif(rest.max && currentnum >= rest.max){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(action == \"delete\" && (rest.min && currentnum <= rest.min)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n\r\n/*\r\n * Class frames represent the archetypal version of a property frame as returned by the class frame api\r\n */\r\nfunction ClassFrame(frame, parent) {\r\n\tthis.err = false;\r\n\tthis.parent = parent;\r\n\t// the id of the object that owns this dataframe\r\n\tthis.subjid = (parent ? parent.subjid : false);\r\n\tif (frame) {\r\n\t\tthis.load(frame);\r\n\t}\r\n}\r\n\r\nClassFrame.prototype = DataFrame.prototype;\r\n\r\nClassFrame.prototype.loadFromObjectFrame = function (par, child) {\r\n\t// all the meta-data carried in frames:\r\n\tthis.type = 'objectProperty';\r\n\tthis.predicate = par.property;\r\n\tthis.range = par.range;\r\n\tthis.rangeValue = child.subjid;\r\n\tthis.domain = par.cls;\r\n\tthis.domainValue = par.subjid;\r\n\tthis.label = par.getLabel();\r\n\tthis.comment = par.getComment();\r\n\tthis.restriction = par.restriction;\r\n};\r\n\r\nClassFrame.prototype.createEmptyChoice = function (cls, newid) {\r\n\tconst cf = this.getChosenClassFrames(cls);\r\n\tconst objframe = new ObjectFrame(cls);\r\n\tif (newid) objframe.subjid = newid;\r\n\tobjframe.loadClassFrames(cf);\r\n\tconst fframe = objframe.fillFromSchema();\r\n\treturn fframe;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrames = function (chosen) {\r\n\tlet nc = [];\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\tif (chosen === this.frame.operands[i][j].domain) {\r\n\t\t\t\tnc = nc.concat(this.frame.operands[i][j]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn nc;\r\n};\r\n\r\nClassFrame.prototype.createEmpty = function (newid) {\r\n\tif (this.isObject()) {\r\n\t\tconst objframe = new ObjectFrame(this.range);\r\n\t\tif (newid) objframe.subjid = newid;\r\n\t\tobjframe.loadClassFrames(this.frame);\r\n\t\tconst fframe = objframe.fillFromSchema();\r\n\t\treturn fframe;\r\n\t}\r\n\tif (this.isData()) {\r\n\t\tconst dataframe = this.copy();\r\n\t\tdataframe.set('');\r\n\t\treturn dataframe;\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.cloneDataFrame = function (newid, other) {\r\n\treturn other;\r\n};\r\n\r\nClassFrame.prototype.clone = function (newid, other) {\r\n\tif (this.isObject()) {\r\n\t\tconsole.log('cannot clone class frame');\r\n\t} else if (this.isData()) {\r\n\t\treturn this.cloneDataFrame(newid, other);\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nClassFrame.prototype.getClassChoices = function () {\r\n\tconst choices = [];\r\n\tif (this.frame.operands) {\r\n\t\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\t\tfor (let j = 0; j < this.frame.operands[i].length; j += 1) {\r\n\t\t\t\tconst domcls = this.frame.operands[i][j].domain;\r\n\t\t\t\tif (domcls && choices.indexOf(domcls) === -1) {\r\n\t\t\t\t\tchoices.push(domcls);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn choices;\r\n};\r\n\r\nClassFrame.prototype.getChosenClassFrame = function (chosen) {\r\n\tfor (let i = 0; i < this.frame.operands.length; i += 1) {\r\n\t\tconst operand = this.frame.operands[i];\r\n\t\tif (operand.length) {\r\n\t\t\tfor (let j = 0; j < operand.length; j += 1) {\r\n\t\t\t\tif (operand[j] && (chosen === operand[j].domain)) {\r\n\t\t\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\t\t\treturn cf;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (operand.range && chosen === operand.range) {\r\n\t\t\tconst cf = new ClassFrame(operand);\r\n\t\t\treturn cf;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};\r\n\r\nClassFrame.prototype.getChosenFrame = function (dataframe) {\r\n\treturn dataframe;\r\n};\r\n\r\n\r\nfunction Restriction(restriction) {\r\n\tthis.min = 0;\r\n\tthis.max = 0;\r\n\tif (restriction) this.loadRestriction(restriction);\r\n}\r\n\r\nRestriction.prototype.hasCardRestriction = function () {\r\n\tif (this.min === 0 && this.max === 0) return false;\r\n\treturn true;\r\n};\r\n\r\nRestriction.prototype.loadRestriction = function (restriction) {\r\n\tif (typeof restriction.cardinality !== 'undefined') {\r\n\t\tthis.max = restriction.cardinality;\r\n\t\tthis.min = restriction.cardinality;\r\n\t} else if (typeof restriction.maxCardinality !== 'undefined') {\r\n\t\tthis.max = restriction.maxCardinality;\r\n\t} else if (typeof restriction.minCardinality !== 'undefined') {\r\n\t\tthis.min = restriction.minCardinality;\r\n\t} else if (typeof restriction.type !== 'undefined' && restriction.type === 'and' && typeof restriction.operands === 'object') {\r\n\t\tfor (let i = 0; i < restriction.operands.length; i += 1) {\r\n\t\t\tconst nrest = new Restriction(restriction.operands[i]);\r\n\t\t\tif (this.max === 0 && nrest.max > 0) this.max = nrest.max;\r\n\t\t\telse if (this.max > 0 && nrest.max > 0 && nrest.max < this.max) this.max = nrest.max;\r\n\t\t\tif (this.min === 0 && nrest.min > 0) this.min = nrest.min;\r\n\t\t\telse if (this.min > 0 && nrest.min > 0 && nrest.min > this.min) this.min = nrest.min;\r\n\t\t}\r\n\t}\r\n};\r\n\r\nmodule.exports = TerminusDocument;\r\n","/**\n * @file WOQL Result Object\n * @license Apache Version 2\n * @summary Object representing the result of a WOQL Query\n */\nconst UTILS = require('./utils.js');\n\n/**\n * \n * @param {Object} results result JSON object as returned by WOQL query\n * @param {WOQLQuery} query the query object that generated the result\n * @param {Object} [config] optional result configuration options object\n *                 [config.no_compress] by default all URLs are compressed where possible (v:X rather than http://.../variable/x) set to true to return non-compressed values \n *                 [config.context] specify the JSON-LD context to use for compressing results - by default the query context will be used\n */\nfunction WOQLResult(results, query, config) {\n\tthis.bindings = results.bindings;\n\tif(query.constructor.name == \"WOQLQuery\"){\n\t\tthis.query = query;\n\t}\n\telse {\n\t\tthis.query = query.query;\n\t}\n\tthis.cursor = 0;\n\tif (!(config && config.no_compress)) {\n\t\tconst context = (config && config.context ? config.context : false);\n\t\tthis.compress(context);\n\t}\n}\n\n/**\n * @param {Object} [context] optional context to use for compression - if ommitted query context is used\n */\nWOQLResult.prototype.compress = function (context) {\n\tcontext = (context || this.query.getContext());\n\tfor (let i = 0; i < this.bindings.length; i++) {\n\t\tfor (const prop of Object.keys(this.bindings[i])) {\n\t\t\tconst nprop = UTILS.shorten(prop, context);\n\t\t\tconst nval = ((typeof this.bindings[i][prop] === 'string')\n\t\t\t\t? UTILS.shorten(this.bindings[i][prop], context)\n\t\t\t\t: this.bindings[i][prop]\n\t\t\t);\n\t\t\tdelete (this.bindings[i][prop]);\n\t\t\tthis.bindings[i][nprop] = nval;\n\t\t}\n\t}\n\treturn this;\n}\n\n/**\n * Returns true if there are any results \n */\nWOQLResult.prototype.hasBindings = function () {\n\treturn (this.bindings && this.count());\n};\n\n/**\n * Returns original array of bindings returned by API\n */\nWOQLResult.prototype.getBindings = function () {\n\treturn this.bindings;\n};\n\n/**\n * Returns list of variables returned in bindings from API\n */\nWOQLResult.prototype.getVariableList = function () {\n\tif (this.bindings && this.bindings[0]) {\n\t\treturn Object.keys(this.bindings[0]);\n\t}\n\treturn [];\n};\n\n/**\n * Number of rows in bound results\n */\nWOQLResult.prototype.count = function () {\n\treturn this.bindings.length;\n};\n\n/**\n * Result set navigation\n */\nWOQLResult.prototype.first = function () {\n\tthis.cursor = 0;\n\treturn this.bindings[0];\n};\n\nWOQLResult.prototype.last = function(){\n\tthis.cursor = this.bindings.length-1;\n\treturn this.bindings[this.bindings.length-1];\n}\n\nWOQLResult.prototype.next = function () {\n\tconst res = this.bindings[this.cursor];\n\tthis.cursor++;\n\treturn res;\n};\n\nWOQLResult.prototype.prev = function () {\n\tif (this.cursor > 0) {\n\t\tthis.cursor--;\n\t\treturn this.bindings[this.cursor];\n\t}\n};\n\n/**\n * Normally sorting of results is the job of the query - this is just in case you want to resort results according to some key (variable)\n */\nWOQLResult.prototype.sort = function(key, asc_or_desc){\n\tthis.bindings.sort((a, b) => {\n\t\treturn this.compareValues(a[key], b[key], asc_or_desc);\n\t});\n\tthis;\n}\n\n/**\n * Compares results a, b according to \"asc\" or \"desc\" order\n */\nWOQLResult.prototype.compareValues = function(a, b, asc_or_desc){\n\tif(!a || !b) return 0;\n\tif(typeof a['@value'] != \"undefined\" && typeof b['@value'] != \"undefined\"){\n\t\ta = a['@value'];\n\t\tb = b['@value'];\n\t}\n\tif (a > b) {\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? 1 : -1);\n\t}\n\tif (b > a) {\n\t\treturn (asc_or_desc && asc_or_desc == 'asc' ? -1 : 1);\n\t}\n};\n\nmodule.exports = WOQLResult;\n","/**\n * The WOQL object is a wrapper around the WOQLQuery object\n * Syntactic sugar to allow writing WOQL.triple()... instead of new WOQLQuery().triple()\n * Every function matches one of the public api functions of the woql query object\n */\nconst UTILS = require('./utils');\nconst WOQLRule = require('./woqlRule');\nconst FrameRule = require('./frameRule');\n\nconst WOQL = {};\n\n/*\n * We expose all the real woql predicates via the WOQL object,\n * for ease of typing all return a WOQL query object\n */\nWOQL.when = function(Query, Update){ return new WOQLQuery().when(Query, Update);}\nWOQL.opt = function(query){ return new WOQLQuery().opt(query); }\nWOQL.from = function(dburl, query){ return new WOQLQuery().from(dburl, query); }\nWOQL.into = function(dburl, query){ return new WOQLQuery().into(dburl, query); }\nWOQL.limit = function(limit, query){ return new WOQLQuery().limit(limit, query); }\nWOQL.start = function(start, query){ return new WOQLQuery().start(start, query); }\nWOQL.select = function(...list){ return new WOQLQuery().select(...list); }\nWOQL.or = function(...queries){\treturn new WOQLQuery().or(...queries); }\nWOQL.and = function(...queries){ return new WOQLQuery().and(...queries); }\nWOQL.not = function(query){ return new WOQLQuery().not(query); }\nWOQL.triple = function(a, b, c){ return new WOQLQuery().triple(a, b, c); }\nWOQL.quad = function(a, b, c, d){ return new WOQLQuery().quad(a, b, c, d); }\nWOQL.sub = function(a, b){ return new WOQLQuery().sub(a, b); }\nWOQL.isa = function(a, b){\treturn new WOQLQuery().isa(a, b);\t}\nWOQL.eq = function(a, b){ return new WOQLQuery().eq(a, b);}\nWOQL.trim = function(a, b){\treturn new WOQLQuery().trim(a, b);\t}\nWOQL.delete = function(JSON_or_IRI){ return new WOQLQuery().delete(JSON_or_IRI);\t}\nWOQL.delete_triple = function( S, P, O ){ return new WOQLQuery().delete_triple (S, P, O);\t}\nWOQL.delete_quad = function( S, P, O, G ){ return new WOQLQuery().delete_quad (S, P, O, G); }\nWOQL.add_triple = function( S, P, O ){ return new WOQLQuery().add_triple (S, P, O); }\nWOQL.add_quad = function( S, P, O, G ){ \treturn new WOQLQuery().add_quad (S, P, O, G);}\nWOQL.get = function(vars, cols, target){\treturn new WOQLQuery().get(vars, cols, target); }\nWOQL.as = function(map, vari){\treturn new WOQLQuery().as(map, vari); }\nWOQL.remote = function(url){\treturn new WOQLQuery().remote(url); }\nWOQL.file = function(url){\treturn new WOQLQuery().file(url); }\nWOQL.list = function(...vars){\treturn new WOQLQuery().list(...vars); }\nWOQL.order_by = function(gvarlist, query){\treturn new WOQLQuery().order_by(gvarlist, query); }\nWOQL.asc = function(varlist_or_var){\treturn new WOQLQuery().asc(varlist_or_var); }\nWOQL.desc = function(varlist_or_var){\treturn new WOQLQuery().desc(varlist_or_var); }\nWOQL.group_by = function(gvarlist, groupedvar, groupquery, output){\treturn new WOQLQuery().group_by(gvarlist, groupedvar, groupquery, output); }\nWOQL.update = function(Q){\treturn new WOQLQuery().update(Q); }\n\n/* String and other processing functions */\nWOQL.concat = function(list, v){\treturn new WOQLQuery().concat(list, v); }\nWOQL.lower = function(u, l){\treturn new WOQLQuery().lower(u, l); }\nWOQL.pad = function(input, pad, len, output){\treturn new WOQLQuery().pad(input, pad, len, output); }\nWOQL.join = function(...list){\treturn new WOQLQuery().join(...list); }\nWOQL.unique = function(prefix, vari, type){\treturn new WOQLQuery().unique(prefix, vari, type); }\nWOQL.idgen = function(prefix, vari, type, output){\treturn new WOQLQuery().idgen(prefix, vari, type, output); }\nWOQL.typecast = function(vara, type, varb){\treturn new WOQLQuery().typecast(vara, type, varb); }\nWOQL.cast = WOQL.typecast;\nWOQL.re = function(pattern, test, matches){\treturn new WOQLQuery().re(pattern, test, matches); }\n\nWOQL.less = function(v1, v2){\treturn new WOQLQuery().less(v1, v2); }\nWOQL.greater = function(v1, v2){\treturn new WOQLQuery().greater(v1, v2); }\n\n\n/* Mathematical Processing */\nWOQL.eval = function(arith, v){\treturn new WOQLQuery().eval(arith, v);}\nWOQL.plus = function(...args){\treturn new WOQLQuery().plus(...args);}\nWOQL.minus = function(...args){\treturn new WOQLQuery().minus(...args); }\nWOQL.times = function(...args){\treturn new WOQLQuery().times(...args); }\nWOQL.divide = function(...args){ return new WOQLQuery().divide(...args); }\nWOQL.exp = function(a, b){\treturn new WOQLQuery().exp(a, b); }\nWOQL.div = function(...args){\treturn new WOQLQuery().div(...args); }\nWOQL.comment = function(arg){\treturn new WOQLQuery().comment(arg); }\nWOQL.length = function(var1, res){\treturn new WOQLQuery().length(var1, res);}\n\n\n//language extensions that can be chained after 'grounded' stuff (clauses with a specific subject) sub, isa, delete_triple, add_triple, delete_quad, add_quad, node\n//WOQL.value = function(vars){\treturn new WOQLQuery().list(vars); }\n//These ones are special ones for dealing with the schema only...\nWOQL.star = function(G, S, P, O){\treturn new WOQLQuery().star(G, S, P, O); }\nWOQL.add_class = function(classid, graph){\treturn new WOQLQuery().add_class(classid, graph); }\nWOQL.add_property = function(propid, type, graph){\treturn new WOQLQuery().add_property(propid, type, graph); }\nWOQL.delete_class = function(classid, graph){\treturn new WOQLQuery().delete_class(classid, graph); }\nWOQL.delete_property = function(propid, type, graph){\treturn new WOQLQuery().delete_property(propid, type, graph); }\nWOQL.node = function(nodeid, type){\treturn new WOQLQuery().node(nodeid, type); }\n\n/*\n * Beneath here are pseudo predicates - they belong to the javascript object\n * but not to the WOQL language\n */\n//returns empty query object\nWOQL.query = function(){\treturn new WOQLQuery(); }\n//loads query from json\nWOQL.json = function(json){\treturn new WOQLQuery().json(json); }\n\nWOQL.rule = function(type){ \n\tif(type && type == \"frame\") return new FrameRule(); \n\treturn new WOQLRule(); \n}\nWOQL.getMatchingRules = function(rules, row, key, context, action){\n\treturn new WOQLRule().getMatchingRules(rules, row, key, context, action);\n}\n\nWOQL.insert = function(Node, Type, Graph){\n\tvar q = new WOQLQuery();\n\tif(Graph){\n\t\treturn q.add_quad(Node, \"rdf:type\", q.cleanType(Type), Graph);\n\t}\n\telse {\n\t\treturn q.add_triple(Node, \"rdf:type\", q.cleanType(Type));\n\t}\n}\n\nWOQL.doctype = function(Type, Graph){\n\treturn new WOQLQuery().add_class(Type, Graph).parent(\"Document\");\t\n}\n\n\n/**\n * The WOQL Query object implements the WOQL language via the fluent style\n * @param query - json version of query\n * @returns WOQLQuery object\n */\nfunction WOQLQuery(query){\n\tthis.query = (query ? query : {});\n\tthis.cursor = this.query;\n\tthis.chain_ended = false;\n\tthis.contains_update = false;\n\t// operators which preserve global paging\n\tthis.paging_transitive_properties = ['select', 'from', 'start', 'when', 'opt', 'limit'];\n\tthis.vocab = this.loadDefaultVocabulary();\n\t//object used to accumulate triples from fragments to support usage like node(\"x\").label(\"y\");\n\tthis.tripleBuilder = false;\n\treturn this;\n}\n\n/**\n * Takes an array of variables, an optional array of column names\n */\nWOQLQuery.prototype.get = function(arr1, arr2, target){\n\tif(arr1.json){\n\t\tvar map = arr1.json();\n\t\ttarget = arr2;\n\t}\n\telse {\n\t\tvar map = this.buildAsClauses(arr1, arr2);\n\t}\n\tif(target){\n\t\tif(target.json) target = target.json();\n\t\tthis.cursor['get'] = [map, target];\n\t}\n\telse {\n\t\tthis.cursor['get'] = [map, {}];\n\t\tthis.cursor = this.cursor[\"get\"][1];\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.buildAsClauses = function(vars, cols){\n\tvar clauses = [];\n\tif(vars && typeof vars == \"object\" && vars.length){\n\t\tfor(var i = 0; i<vars.length; i++){\n\t\t\tvar v = vars[i];\n\t\t\tif(cols && typeof cols == \"object\" && cols.length){\n\t\t\t\tvar c = cols[i];\n\t\t\t\tif(typeof c == \"string\"){\n\t\t\t\t\tc = {\"@value\": c};\n\t\t\t\t}\n\t\t\t\tclauses.push({as: [c, v]});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tv.as ? clauses.push(v) : clauses.push({as: [v]});\n\t\t\t}\n\t\t}\n\t}\n\treturn clauses;\n}\n\nWOQLQuery.prototype.typecast = function(va, type, vb){\n\tthis.cursor['typecast'] = [va, type, vb];\n\treturn this;\n}\n\n/**\n * Shorthand of above\n */\nWOQLQuery.prototype.cast = WOQLQuery.prototype.typecast;\n\n\nWOQLQuery.prototype.length = function(va, vb){\n\tthis.cursor['length'] = [va, vb];\n\treturn this;\n}\n\nWOQLQuery.prototype.re = function(p, s, m){\n\tthis.cursor['re'] = [p, s, m];\n\treturn this;\n}\n\nWOQLQuery.prototype.remote = function(json){\n\tthis.cursor['remote'] = [json];\n\treturn this;\n}\n\nWOQLQuery.prototype.file = function(json){\n\tthis.cursor['file'] = [json];\n\treturn this;\n}\n\nWOQLQuery.prototype.order_by = function(gvarlist, asc_or_desc, query){\n\tlet ordering = gvarlist;\n\tif(gvarlist.json) {\n\t\tordering = gvarlist.json();\n\t}\n\tif(typeof ordering != \"object\"){\n\t\tordering = [ordering];\n\t}\n\tif(Array.isArray(ordering)){\n\t\tconst vars = UTILS.addNamespacesToVariables(ordering);\n\t\tasc_or_desc = asc_or_desc || \"asc\";\n\t\tordering = {};\n\t\tordering[asc_or_desc] = vars; \n\t}\n\tthis.advanceCursor(\"order_by\", ordering);\n\tif(query){\n\t\tthis.cursor = (query.json ? query.json() : query);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.asc = function(varlist_or_var){\n\tif(!Array.isArray(varlist_or_var)){\n\t\tvarlist_or_var = [varlist_or_var];\n\t}\n\tthis.cursor[\"asc\"] = varlist_or_var;\n\treturn this;\n}\n\nWOQLQuery.prototype.desc = function(varlist_or_var){\n\tif(!Array.isArray(varlist_or_var)){\n\t\tvarlist_or_var = [varlist_or_var];\n\t}\n\tthis.cursor[\"desc\"] = varlist_or_var;\n\treturn this;\n}\n\nWOQLQuery.prototype.group_by = function(gvarlist, groupedvar, groupquery, output){\n\tvar args = [];\n\tthis.cursor['group_by'] = args;\n\tif(gvarlist.json){\n\t\targs.push(gvarlist.json());\n\t}\n\tif(gvarlist['list']){\n\t\targs.push(gvarlist);\n\t}\n\telse {\n\t\targs.push({'list': gvarlist});\n\t}\n\tif(typeof groupedvar == \"object\" && Array.isArray(groupedvar)){\n\t\tconst ng = UTILS.addNamespacesToVariables(groupedvar);\n\t\tgroupedvar = {\"list\": ng};\n\t}\n\telse if(typeof groupedvar == \"string\"){\n\t\tgroupedvar = UTILS.addNamespacesToVariables(groupedvar);\n\t}\n\targs.push(groupedvar);\n\tif(output){\n\t\tgroupquery = groupquery.json ? groupquery.json() : groupquery;\n\t\targs.push(groupquery);\n\t}\n\telse {\n\t\toutput = groupquery;\n\t\tvar sq = {};\n\t\tthis.cursor = sq;\n\t\targs.push(sq);\n\t}\n\targs.push(UTILS.addNamespaceToVariable(output));\n\treturn this;\n}\n\nWOQLQuery.prototype.idgen = function(prefix, vari, type, mode){\n\tthis.cursor['idgen'] = [prefix];\n\tif(vari.json){\n\t\tthis.cursor['idgen'].push(vari.json());\n\t}\n\telse if(vari.list){\n\t\tthis.cursor['idgen'].push(vari);\n\t}\n\telse {\n\t\tthis.cursor['idgen'].push({\"list\": vari})\n\t}\n\tif(mode){\n\t\tthis.cursor['idgen'].push(mode);\n\t}\n\tthis.cursor['idgen'].push(type);\n\treturn this;\n}\n\n\nWOQLQuery.prototype.unique = function(prefix, vari, type){\n\tthis.cursor['unique'] = [prefix];\n\tif(vari.json){\n\t\tthis.cursor['unique'].push(vari.json());\n\t}\n\telse if(vari.list){\n\t\tthis.cursor['unique'].push(vari);\n\t}\n\telse {\n\t\tthis.cursor['unique'].push({\"list\": vari})\n\t}\n\tthis.cursor['unique'].push(type);\n\treturn this;\n}\n\n\nWOQLQuery.prototype.concat = function(list, v){\n\tif(typeof list == \"string\"){\n\t\tvar nlist = list.split(/(v:[\\w_]+)\\b/);\n\t\tvar nxlist = [];\n\t\tfor(var i = 1; i<nlist.length; i++){\n\t\t\tif(nlist[i-1].substring(nlist[i-1].length-1) == \"v\" && nlist[i].substring(0, 1) == \":\"){\n\t\t\t\tnlist[i-1] = nlist[i-1].substring(0, nlist[i-1].length-1);\n\t\t\t\tnlist[i] = nlist[i].substring(1);\n\t\t\t}\n\t\t}\n\t}\n\telse if(list.list){\n\t\tvar nlist = list.list;\n\t}\n\telse if(typeof list == \"object\"){\n\t\tvar nlist = list;\n\t}\n\tvar args = [];\n\tfor(var i = 0; i<nlist.length; i++){\n\t\tif(!nlist[i]) continue;\n\t\tif(typeof nlist[i] == \"string\"){\n\t\t\tif(nlist[i].substring(0, 2) == \"v:\"){\n\t\t\t\targs.push(nlist[i]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar nvalue = {\"@value\": nlist[i], \"@type\": \"xsd:string\"};\n\t\t\t\targs.push(nvalue);\n\t\t\t}\n\t\t}\n\t\telse if(nlist[i]){\n\t\t\targs.push(nlist[i]);\n\t\t}\n\t}\n\tif(v.indexOf(\":\") == -1) v = \"v:\" + v;\n\tthis.cursor['concat'] = [{\"list\": args}, v];\n\treturn this;\n};\n\nWOQLQuery.prototype.lower = function(u, l){\n\tthis.cursor['lower'] = [u, l];\n\treturn this;\n};\n\nWOQLQuery.prototype.pad = function(input, pad, len, output){\n\tthis.cursor['pad'] = [input, pad, len, output];\n\treturn this;\n}\n\nWOQLQuery.prototype.join = function(...list){\n\tthis.cursor['join'] = list;\n\treturn this;\n}\n\nWOQLQuery.prototype.less = function(v1, v2){\n\tthis.cursor['less'] = [v1, v2];\n\treturn this;\n}\n\nWOQLQuery.prototype.greater = function(v1, v2){\n\tthis.cursor['greater'] = [v1, v2];\n\treturn this;\n}\n\nWOQLQuery.prototype.list  = function(...vars){\n\tthis.cursor['list'] = vars;\n\treturn this;\n}\n\n\n/*\n * json version of query for passing to api\n */\nWOQLQuery.prototype.json = function(json){\n\tif(json){\n\t\tthis.query = json;\n\t\treturn this;\n\t}\n\treturn this.query;\n}\n\n/*\n * Functions which take a query as an argument advance the cursor to make the chaining of queries fall\n * into the corrent place in the encompassing json\n */\nWOQLQuery.prototype.when = function(Query, Update){\n\tif(typeof Query == 'boolean'){\n\t\tif(Query){\n\t\t\tthis.cursor[\"when\"] = [{\"true\": []}, {}];\n\t\t}\n\t\telse {\n\t\t\tthis.cursor[\"when\"] = [{\"false\": []}, {}];\n\t\t}\n\t}\n\telse {\n\t\tvar q = (Query.json ? Query.json() : Query);\n\t\tthis.cursor['when'] = [q, {}];\n\t}\n\tif(Update){\n\t\tvar upd = (Update.json ? Update.json() : Update);\n\t\tthis.cursor[\"when\"][1] = upd;\n\t}\n\tthis.cursor = this.cursor[\"when\"][1];\n\treturn this;\n}\n\nWOQLQuery.prototype.opt = function(query){\n\tif(query){\n\t\tvar q = ((typeof query.json == \"function\") ? query.json() : query);\n\t\tthis.cursor[\"opt\"] = [q];\n\t}\n\telse {\n\t\tthis.cursor['opt'] = [{}];\n\t\tthis.cursor = this.cursor[\"opt\"][0];\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.from = function(dburl, query){\n\tthis.advanceCursor(\"from\", dburl);\n\tif(query){\n\t\tthis.cursor = (query.json ? query.json() : query);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.into = function(dburl, query){\n\tthis.advanceCursor(\"into\", dburl);\n\tif(query){\n\t\tthis.cursor = (query.json ? query.json() : query);\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.limit = function(limit, query){\n\tthis.advanceCursor(\"limit\", limit);\n\tif(query){\n\t\tthis.cursor = (query.json ? query.json() : query);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.start = function(start, query){\n\tthis.advanceCursor(\"start\", start);\n\tif(query){\n\t\tthis.cursor = query.json();\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.select = function (...list) {\n\tthis.cursor.select = list;\n\tconst index = list.length;\n\tif (typeof this.cursor.select[index - 1] === 'object') {\n\t\tthis.cursor.select[index - 1] = this.cursor.select[index - 1].json();\n\t} else {\n\t\tthis.cursor.select[index] = {};\n\t\tthis.cursor = this.cursor.select[index];\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.and = function (...queries) {\n\tthis.cursor.and = [];\n\tfor (let i = 0; i < queries.length; i++) {\n\t\tif (queries[i].contains_update) this.contains_update = true;\n\t\tthis.cursor.and.push(queries[i].json());\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.or = function (...queries) {\n\tthis.cursor.or = [];\n\tfor (let i = 0; i < queries.length; i++) {\n\t\tif (queries[i].contains_update) this.contains_update = true;\n\t\tthis.cursor.or.push(queries[i].json());\n\t}\n\treturn this;\n};\n\n/**\n * Negation of passed or chained query\n */\nWOQLQuery.prototype.not = function (query) {\n\tif (query) {\n\t\tif (query.contains_update) this.contains_update = true;\n\t\tif(query.json) query = query.json();\n\t\tthis.cursor.not = [query];\n\t} else {\n\t\tthis.cursor.not = [{}];\n\t\tthis.cursor = this.cursor.not[0];\n\t}\n\treturn this;\n};\n\nWOQLQuery.prototype.triple = function(a, b, c){\n\tthis.cursor[\"triple\"] = [this.cleanSubject(a),this.cleanPredicate(b),this.cleanObject(c)];\n\treturn this.chainable(\"triple\", this.cleanSubject(a));\n}\n\nWOQLQuery.prototype.quad = function(a, b, c, g){\n\tthis.cursor[\"quad\"] = [this.cleanSubject(a),this.cleanPredicate(b),this.cleanObject(c),this.cleanGraph(g)];\n\treturn this.chainable(\"quad\", this.cleanSubject(a));\n}\n\nWOQLQuery.prototype.eq = function(a, b){\n\tthis.cursor[\"eq\"] = [this.cleanObject(a),this.cleanObject(b)];\n\treturn this.last();\n};\n\nWOQLQuery.prototype.sub = function(a, b){\n\tif(!b && this.tripleBuilder){\n\t\tthis.tripleBuilder.sub(this.cleanClass(a));\n\t\treturn this;\n\t}\n\tthis.cursor[\"sub\"] = [this.cleanClass(a),this.cleanClass(b)];\n\treturn this.last(\"sub\", a);\n}\n\nWOQLQuery.prototype.comment = function(val){\n\tif(val && val.json){\n\t\tthis.cursor['comment'] = [val.json()];\n\t}\n\telse if(typeof val == \"string\"){\n\t\tthis.cursor['comment'] = [{\"@value\": val, \"@language\": \"en\"}];\n\t}\n\telse if(typeof val == \"object\"){\n\t\tif(val.length) this.cursor['comment'] = val;\n\t\telse this.cursor['comment'] = [val];\n\t}\n\telse {\n\t\tthis.cursor['comment'] = [];\n\t}\n\tvar last_index = this.cursor['comment'].length;\n\tthis.cursor['comment'][last_index] = {};\n\tthis.cursor = this.cursor['comment'][last_index];\n\treturn this;\n}\n\n\nWOQLQuery.prototype.abstract = function(varname){\n\tif(varname){\n\t\treturn this.quad(varname, \"tcs:tag\", \"tcs:abstract\", \"db:schema\");\n\t}\n\telse if(this.tripleBuilder){\n\t\tthis.tripleBuilder.abstract();\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.isa = function(a, b){\n\tif(!b && this.tripleBuilder){\n\t\tthis.tripleBuilder.isa(this.cleanClass(a));\n\t\treturn this;\n\t}\n\tif(b){\n\t\tthis.cursor[\"isa\"] = [this.cleanClass(a),this.cleanClass(b)];\n\t\treturn this.chainable(\"isa\", a);\n\t}\n}\n\nWOQLQuery.prototype.trim = function(a, b){\n\tthis.cursor['trim'] = [a, b];\n\treturn this.chainable('trim', b);\n}\n\nWOQLQuery.prototype.eval = function(arith, v){\n\tarith = arith.json ? arith.json() : arith;\n\tthis.cursor['eval'] = [arith, v];\n\treturn this.chainable('eval', v);\n}\n\nWOQLQuery.prototype.plus = function (...args) {\n\tthis.cursor.plus = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.plus.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.minus = function (...args) {\n\tthis.cursor.minus = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.minus.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.times = function (...args) {\n\tthis.cursor.times = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.times.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.divide = function (...args) {\n\tthis.cursor.divide = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.divide.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.div = function (...args) {\n\tthis.cursor.div = [];\n\tfor(var i = 0; i < args.length; i++){\n\t\tthis.cursor.div.push(args[i].json ? args[i].json() : args[i]);\n\t}\n\treturn this.last();\n};\n\nWOQLQuery.prototype.exp = function (a, b) {\n\ta = (a.json ? a.json() : a);\n\tb = (b.json ? b.json() : b);\n\tthis.cursor.exp = [a, b];\n\treturn this.last();\n};\n\nWOQLQuery.prototype.delete = function (JSON_or_IRI) {\n\tthis.cursor.delete = [JSON_or_IRI];\n\treturn this.lastUpdate();\n};\n\nWOQLQuery.prototype.delete_triple = function( Subject, Predicate, Object_or_Literal ){\n\tthis.cursor['delete_triple'] = [this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal)];\n\treturn this.chainableUpdate('delete_triple', Subject);\n}\n\nWOQLQuery.prototype.add_triple = function( Subject, Predicate, Object_or_Literal ){\n\tthis.cursor['add_triple'] =[this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal)];\n\treturn this.chainableUpdate('add_triple', Subject);\n}\n\nWOQLQuery.prototype.delete_quad = function( Subject, Predicate, Object_or_Literal, Graph ){\n\tthis.cursor['delete_quad'] =[this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal),this.cleanGraph(Graph)];\n\treturn this.chainableUpdate('delete_quad', Subject);\n}\n\nWOQLQuery.prototype.add_quad = function( Subject, Predicate, Object_or_Literal, Graph){\n\tthis.cursor['add_quad'] = [this.cleanSubject(Subject),this.cleanPredicate(Predicate),this.cleanObject(Object_or_Literal),this.cleanGraph(Graph)];\n\treturn this.chainableUpdate(\"add_quad\", Subject);\n}\n\nWOQLQuery.prototype.update = function(woql){\n\tthis.cursor['update'] = [ woql.json() ];\n\treturn this.lastUpdate();\n}\n\n/**\n * Schema manipulation shorthand\n */\nWOQLQuery.prototype.add_class = function(c, graph){\n\tif(c){\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\n\t\tc = (c.indexOf(\":\") == -1) ? \"scm:\" + c : c;\n\t\tthis.adding_class = c;\n\t\tthis.add_quad(c,\"rdf:type\",\"owl:Class\",graph);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.add_property = function(p, t, g){\n\tt = (t ? t : \"xsd:string\");\n\tif(p){\n\t\tvar graph = (g ? this.cleanGraph(g) : \"db:schema\");\n\t\tp = (p.indexOf(\":\") == -1) ?  \"scm:\" + p : p;\n\t\tt = (t.indexOf(\":\") == -1) ? this.cleanType(t) : t ;\n\t\tvar tc = this.cursor;\n\t\tvar pref = t.split(\":\");\n\t\tif(pref[0] && (pref[0] == \"xdd\" || pref[0] == \"xsd\")) {\n\t\t    this.and(\n\t\t\t\tWOQL.add_quad(p, \"rdf:type\", \"owl:DatatypeProperty\", graph),\n\t\t\t\tWOQL.add_quad(p, \"rdfs:range\", t, graph)\n\t\t\t);\n\t\t}\n\t\telse {\n\t\t\tthis.and(\n\t\t\t\tWOQL.add_quad(p, \"rdf:type\", \"owl:ObjectProperty\", graph),\n\t\t\t\tWOQL.add_quad(p, \"rdfs:range\", t, graph)\n\t\t\t);\n\t\t}\n\t}\n\treturn this.chainableUpdate(\"add_quad\", p);\n}\n\nWOQLQuery.prototype.delete_class = function(c, graph){\n\tif(c){\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\n\t\tc = (c.indexOf(\":\") == -1) ?  \"scm:\" + c : c;\n\t\treturn this.and(\n\t\t\tWOQL.delete_quad(c, \"v:All\", \"v:Al2\", graph),\n\t\t\tWOQL.opt().delete_quad(\"v:Al3\", \"v:Al4\", c, graph)\n\t\t);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.delete_property = function(p, graph){\n\tif(p){\n\t\tgraph = (graph ? this.cleanGraph(graph) : \"db:schema\");\n\t\tp = (p.indexOf(\":\") == -1) ? \"scm:\" + p : p;\n\t\treturn this.and(\n\t\t\tWOQL.delete_quad(p, \"v:All\", \"v:Al2\", graph),\n\t\t\tWOQL.delete_quad(\"v:Al3\", \"v:Al4\", p, graph)\n\t\t);\n\t}\n\treturn this;\n}\n\n/**\n * Language elements that cannot be invoked from the top level and therefore are not exposed in the WOQL api\n */\nWOQLQuery.prototype.as = function(a, b){\n\tif(!a || !b) return;\n\tif(!this.asArray){\n\t\tthis.asArray = true;\n\t\tthis.query = [];\n\t}\n\tb = (b.indexOf(\":\") == -1 ? \"v:\" + b : b);\n\tvar val = (typeof a == \"object\" ? a : { \"@value\" : a});\n\tthis.query.push({as: [val, b]});\n\treturn this;\n}\n\n/**\n * WOQL API\n */\n\nWOQLQuery.prototype.node = function(node, type){\n\ttype = (type ? type : \"triple\");\n\tthis.tripleBuilder = new TripleBuilder(type, this.cursor, node);\n\treturn this;\n}\n\nWOQLQuery.prototype.max = function(m){\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"max\");\n\treturn this;\n}\n\nWOQLQuery.prototype.cardinality = function(m){\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"cardinality\");\n\treturn this;\n}\n\nWOQLQuery.prototype.min = function(m){\n\tif(this.tripleBuilder) this.tripleBuilder.card(m, \"min\");\n\treturn this;\n}\n\nWOQLQuery.prototype.graph = function(g){\n\tg = this.cleanGraph(g);\n\tvar t = (this.type == \"triple\") ? \"quad\" : false;\n\tif(this.type == \"add_triple\") t = \"add_quad\";\n\tif(this.type == \"delete_triple\") t = \"delete_quad\";\n\tif(!this.tripleBuilder){\n\t\tthis.tripleBuilder = new TripleBuilder(t, this.cursor);\n\t}\n\tthis.tripleBuilder.graph(g);\n\treturn this;\n}\n\nWOQLQuery.prototype.domain = function(d){\n\td = this.cleanClass(d);\n\tif(this.tripleBuilder) this.tripleBuilder.addPO('rdfs:domain',d);\n\treturn this;\n}\n\nWOQLQuery.prototype.label = function(l, lang){\n\tif(this.tripleBuilder) this.tripleBuilder.label(l, lang);\n\treturn this;\n}\n\nWOQLQuery.prototype.description = function(c, lang){\n\tif(this.tripleBuilder) this.tripleBuilder.description(c, lang);\n\treturn this;\n}\n\nWOQLQuery.prototype.parent = function(...p){\n\tif(this.tripleBuilder){\n\t\tfor(var i = 0 ; i<p.length; i++){\n\t\t\tvar pn = this.cleanClass(p[i]);\n\t\t\tthis.tripleBuilder.addPO('rdfs:subClassOf', pn);\n\t\t}\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.entity = function(...p){\n\treturn this.parent(\"tcs:Entity\");\n}\n\nWOQLQuery.prototype.relationship = function(...p){\n\treturn this.parent(\"tcs:Entity\");\n}\n\nWOQLQuery.prototype.property = function(p,val){\n\tif(this.tripleBuilder) {\n\t\tif(this.adding_class){\n\t\t\tvar nwoql = WOQL.add_property(p, val).domain(this.adding_class);\n\t\t\tnwoql.query.and.push(this.json());\n\t\t\tnwoql.adding_class = this.adding_class;\n\t\t\treturn nwoql; \n\t\t}\n\t\telse {\n\t\t\tp = this.cleanPredicate(p);\n\t\t\tthis.tripleBuilder.addPO(p, val);\n\t\t}\n\t}\n\treturn this;\n}\n\t\nWOQLQuery.prototype.star = function(GraphIRI, Subj, Pred, Obj){\n\tSubj = (Subj ? this.cleanSubject(Subj) : \"v:Subject\");\n\tPred = (Pred ? this.cleanPredicate(Pred) : \"v:Predicate\");\n\tObj = (Obj  ? this.cleanObject(Obj) : \"v:Object\");\n\tGraphIRI = (GraphIRI ? this.cleanGraph(GraphIRI) : false);\n\tif(GraphIRI){\n\t\treturn this.quad(Subj, Pred, Obj, GraphIRI);\n\t}\n\telse {\n\t\tconsole.log(Subj, Pred, Obj);\n\t\treturn this.triple(Subj, Pred, Obj);\n\t}\n}\n\n/** \n * These are composite functions, the above are primitives\n */\nWOQLQuery.prototype.getEverything = function(GraphIRI){\n\tif(GraphIRI){\n\t\tGraphIRI = this.cleanGraph(GraphIRI);\n\t\treturn this.quad(\"v:Subject\", \"v:Predicate\", \"v:Object\", GraphIRI);\n\t}\n\telse {\n\t\treturn this.triple(\"v:Subject\", \"v:Predicate\", \"v:Object\");\n\t}\n}\n\nWOQLQuery.prototype.getAllDocuments = function(){\n\treturn this.and(\n\t\tWOQL.triple(\"v:Subject\", \"rdf:type\", \"v:Type\"),\n\t\tWOQL.sub(\"v:Type\", \"tcs:Document\")\n\t);\n}\n\nWOQLQuery.prototype.documentMetadata = function(){\n\treturn this.and(\n\t\tWOQL.triple(\"v:ID\", \"rdf:type\", \"v:Class\"),\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:label\", \"v:Label\"),\n\t\tWOQL.opt().triple(\"v:ID\", \"rdfs:comment\", \"v:Comment\"),\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Type\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Type_Comment\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.concreteDocumentClasses = function(){\n\treturn this.and(\n\t\tWOQL.sub(\"v:Class\", \"tcs:Document\"),\n\t\tWOQL.not().abstract(\"v:Class\"),\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Class\", \"rdfs:comment\", \"v:Comment\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.propertyMetadata = function(){\n\treturn this.and(\n\t\tWOQL.or(\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:DatatypeProperty\", \"db:schema\"),\n\t\t\tWOQL.quad(\"v:Property\", \"rdf:type\", \"owl:ObjectProperty\", \"db:schema\")\n\t\t),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:range\", \"v:Range\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Type\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:domain\", \"v:Domain\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.elementMetadata = function(){\n\treturn this.and(\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"v:Type\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:subClassOf\", \"v:Parent\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:domain\", \"v:Domain\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:range\", \"v:Range\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.classMetadata = function(){\n\treturn this.and(\n\t\tWOQL.quad(\"v:Element\", \"rdf:type\", \"owl:Class\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:label\", \"v:Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"rdfs:comment\", \"v:Comment\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Element\", \"tcs:tag\", \"v:Abstract\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.getDataOfClass = function(chosen){\n\treturn this.and(\n\t\tWOQL.triple(\"v:Subject\", \"rdf:type\", chosen),\n\t\tWOQL.opt().triple(\"v:Subject\", \"v:Property\", \"v:Value\")\n\t);\n}\n\nWOQLQuery.prototype.getDataOfProperty = function(chosen){\n\treturn this.and(\n\t\tWOQL.triple(\"v:Subject\", chosen, \"v:Value\"),\n\t\tWOQL.opt().triple(\"v:Subject\", \"rdfs:label\", \"v:Label\")\n\t);\n}\n\nWOQLQuery.prototype.documentProperties = function(id){\n\treturn this.and(\n\t\tWOQL.triple(id, \"v:Property\", \"v:Property_Value\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdfs:label\", \"v:Property_Label\", \"db:schema\"),\n\t\tWOQL.opt().quad(\"v:Property\", \"rdf:type\", \"v:Property_Type\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.getDocumentConnections = function(id){\n\treturn this.and(\n\t\tWOQL.or(\n\t\t\tWOQL.triple(id, \"v:Outgoing\", \"v:Entid\"),\n\t\t\tWOQL.triple(\"v:Entid\", \"v:Incoming\", id)\n\t\t),\n\t\tWOQL.isa(\"v:Entid\", \"v:Enttype\"),\n\t\tWOQL.sub(\"v:Enttype\", \"tcs:Document\"),\n\t\tWOQL.opt().triple(\"v:Entid\", \"rdfs:label\", \"v:Label\"),\n\t\tWOQL.opt().quad(\"v:Enttype\", \"rdfs:label\", \"v:Class_Label\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.getInstanceMeta = function(url){\n\treturn this.and(\n\t\tWOQL.triple(url, \"rdf:type\", \"v:InstanceType\"),\n\t\tWOQL.opt().triple(url, \"rdfs:label\", \"v:InstanceLabel\"),\n\t\tWOQL.opt().triple(url, \"rdfs:comment\", \"v:InstanceComment\"),\n\t\tWOQL.opt().quad(\"v:InstanceType\", \"rdfs:label\", \"v:ClassLabel\", \"db:schema\")\n\t);\n}\n\nWOQLQuery.prototype.simpleGraphQuery = function(){\n\treturn this.and(\n\t    WOQL.triple(\"v:Source\", \"v:Edge\", \"v:Target\"),\n\t    WOQL.isa(\"v:Source\", \"v:Source_Class\"),\n\t    WOQL.sub(\"v:Source_Class\", \"tcs:Document\"),\n\t    WOQL.isa(\"v:Target\", \"v:Target_Class\"),\n\t    WOQL.sub(\"v:Target_Class\", \"tcs:Document\"),\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:label\", \"v:Source_Label\"),\n\t    WOQL.opt().triple(\"v:Source\", \"rdfs:comment\", \"v:Source_Comment\"),\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:label\", \"v:Source_Type\", \"db:schema\"),\n\t    WOQL.opt().quad(\"v:Source_Class\", \"rdfs:comment\", \"v:Source_Type_Comment\", \"db:schema\"),\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:label\", \"v:Target_Label\"),\n\t    WOQL.opt().triple(\"v:Target\", \"rdfs:comment\", \"v:Target_Comment\"),\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:label\", \"v:Target_Type\", \"db:schema\"),\n\t    WOQL.opt().quad(\"v:Target_Class\", \"rdfs:comment\", \"v:Target_Type_Comment\", \"db:schema\"),\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:label\", \"v:Edge_Type\", \"db:schema\"),\n\t    WOQL.opt().quad(\"v:Edge\", \"rdfs:comment\", \"v:Edge_Type_Comment\", \"db:schema\")\n\t);\n}\n\n\n/**\n * Queries the schema graph and loads all the ids found there as vocabulary that can be used without prefixes\n * ignoring blank node ids\n */\nWOQLQuery.prototype.loadVocabulary = function(client){\n\tvar nw = new WOQLQuery().quad(\"v:S\", \"v:P\", \"v:O\", \"db:schema\");\n\tnw.execute(client).then( (result) => {\n\t\tif(result.bindings && result.bindings.length > 0){\n\t\t\tfor(var i = 0; i<result.bindings.length; i++){\n\t\t\t\tfor(var k in result.bindings[i]){\n\t\t\t\t\tvar v = result.bindings[i][k]\n\t\t\t\t\tif(typeof v == \"string\"){\n\t\t\t\t\t\tvar spl = v.split(\":\");\n\t\t\t\t\t\tif(spl.length == 2 && spl[1] && spl[0] != \"_\"){\n\t\t\t\t\t\t\tthis.vocab[spl[1]] = v;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\n\n/**\n * Provides the query with a 'vocabulary' a list of well known predicates that can be used without prefixes mapping: id: prefix:id ...\n */\nWOQLQuery.prototype.setVocabulary = function(vocab){\n\tthis.vocab = vocab;\n}\n\nWOQLQuery.prototype.getVocabulary = function(vocab){\n\treturn this.vocab;\n}\n\nWOQLQuery.prototype.getLimit = function(){\n\treturn this.getPagingProperty(\"limit\");\n}\n\nWOQLQuery.prototype.setLimit = function(l){\n\treturn this.setPagingProperty(\"limit\", l);\n}\n\nWOQLQuery.prototype.isPaged = function(q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == \"limit\") return true;\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\treturn this.isPaged(q[prop][q[prop].length-1]);\n\t\t}\n\t}\n\treturn false;\n}\n\nWOQLQuery.prototype.getPage = function(){\n\tif(this.isPaged()){\n\t\tvar psize = this.getLimit();\n\t\tif(this.hasStart()){\n\t\t\tvar s = this.getStart();\n\t\t\treturn (parseInt(s / psize) + 1);\n\t\t}\n\t\telse return 1;\n\t}\n\telse return false;\n}\n\nWOQLQuery.prototype.setPage = function(pagenum){\n\tvar pstart = (this.getLimit() * (pagenum - 1));\n\tif(this.hasStart()){\n\t\tthis.setStart(pstart);\n\t}\n\telse {\n\t\tthis.addStart(pstart);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.nextPage = function(){\n\treturn this.setPage(this.getPage() + 1);\n}\n\nWOQLQuery.prototype.firstPage = function(){\n\treturn this.setPage(1);\n}\n\nWOQLQuery.prototype.previousPage = function(){\n\tconst npage = this.getPage() - 1;\n\tif(npage > 0) this.setPage(npage);\n\treturn this;\n}\n\nWOQLQuery.prototype.setPageSize = function(size){\n\tthis.setPagingProperty(\"limit\", size);\n\tif(this.hasStart()){\n\t\tthis.setStart(0);\n\t}\n\telse {\n\t\tthis.addStart(0);\n\t}\n\treturn this;\n}\n\nWOQLQuery.prototype.hasSelect = function(){\n\treturn (this.getPagingProperty(\"select\") ? true : false);\n}\n\nWOQLQuery.prototype.getSelectVariables = function(q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == \"select\") {\n\t\t\tvar vars = q[prop].slice(0, q[prop].length - 1);\n\t\t\treturn vars;\n\t\t}\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\tvar val = this.getSelectVariables(q[prop][q[prop].length-1]);\n\t\t\tif(typeof val != \"undefined\"){\n\t\t\t\treturn val;\n\t\t\t}\n\t\t}\n\t}\n}\n\nWOQLQuery.prototype.hasStart = function(){\n\treturn (typeof this.getPagingProperty(\"start\") != \"undefined\");\n}\n\nWOQLQuery.prototype.getStart = function(){\n\treturn this.getPagingProperty(\"start\");\n}\n\nWOQLQuery.prototype.setStart = function(start){\n\treturn this.setPagingProperty(\"start\", start);\n}\n\nWOQLQuery.prototype.addStart = function(s){\n\tif(this.hasStart()) this.setStart(s);\n\telse {\n\t\tvar nq = {'start': [s, this.query]};\n\t\tthis.query = nq;\n\t}\n\treturn this;\n}\n\n\n/**\n * Executes the query using the passed client to connect to a server\n */\nWOQLQuery.prototype.execute = function(client){\n\tif(!this.query[\"@context\"]){\n\t\tthis.query['@context'] = this.defaultContext(client.connectionConfig.dbURL());\n\t\tvar json = this.json();\n\t}\n\telse {\n\t\tvar json = this.json();\n\t}\n\tif(this.contains_update){\n\t\treturn client.select(false, json);\n\t\t//return client.update(false, json);\n\t}\n\telse {\n\t\treturn client.select(false, json);\n\t}\n}\n\n/*\n * Internal State Control Functions\n * Not part of public API -\n */\n\n /**\n * Advances internal cursor to support chaining of calls: limit(50).start(50). rather than (limit, [50, (start, [50, (lisp-style (encapsulation)))))\n */\nWOQLQuery.prototype.advanceCursor = function(action, value){\n\tthis.cursor[action] = [value];\n\tthis.cursor[action][1] = {};\n\tthis.cursor = this.cursor[action][1];\n}\n\nWOQLQuery.prototype.loadDefaultVocabulary = function(){\n\tvar vocab = {};\n\tvocab.type = \"rdf:type\";\n\tvocab.label = \"rdfs:label\";\n\tvocab.Class = \"owl:Class\";\n\tvocab.DatatypeProperty = \"owl:DatatypeProperty\";\n\tvocab.ObjectProperty = \"owl:ObjectProperty\";\n\tvocab.Entity = \"tcs:Entity\";\n\tvocab.Document = \"tcs:Document\";\n\tvocab.Relationship = \"tcs:Relationship\";\n\tvocab.temporality = \"tcs:temporality\";\n\tvocab.geotemporality = \"tcs:geotemporality\";\n\tvocab.geography = \"tcs:geography\";\n\tvocab.abstract = \"tcs:abstract\";\n\tvocab.comment = \"rdfs:comment\";\n\tvocab.range = \"rdfs:range\";\n\tvocab.domain = \"rdfs:domain\";\n\tvocab.subClassOf = \"rdfs:subClassOf\";\n\tvocab.string = \"xsd:string\";\n\tvocab.integer = \"xsd:integer\";\n\tvocab.decimal = \"xsd:decimal\";\n\tvocab.email = \"xdd:email\";\n\tvocab.json = \"xdd:json\";\n\tvocab.dateTime = \"xsd:dateTime\";\n\tvocab.date = \"xsd:date\";\n\tvocab.coordinate = \"xdd:coordinate\";\n\tvocab.line = \"xdd:coordinatePolyline\";\n\tvocab.polygon = \"xdd:coordinatePolygon\";\n\treturn vocab;\n}\n\nWOQLQuery.prototype.defaultContext = function(DB_IRI){\n\tlet def = {}\n\tfor(var pref in UTILS.standard_urls){\n\t\tdef[pref] = UTILS.standard_urls[pref];\n\t}\n\tdef.scm = DB_IRI + \"/schema#\"\n\tdef.doc = DB_IRI + \"/document/\"\n\tdef.db = DB_IRI + \"/\";\n\treturn def;\n}\n\n\n\n/**\n * Called to indicate that this is the last call in constructing a complete woql query object\n *\n */\nWOQLQuery.prototype.last = function(){\n\tthis.chain_ended = true;\n\treturn this;\n}\n\n/**\n * Called to inidicate that this is the last call in constructing a complete WOQL update query\n */\nWOQLQuery.prototype.lastUpdate = function(){\n\tthis.contains_update = true;\n\tthis.last();\n\treturn this;\n}\n\n/**\n * Called to indicate internally that this is a chainable update - by setting the subject and call of the Triple Builder object which is used to build further triples\n */\nWOQLQuery.prototype.chainable = function(call, subj){\n\tthis.tripleBuilder = new TripleBuilder(call, this.cursor, this.cleanSubject(subj));\n\tthis.last();\n\treturn this;\n}\n\n/**\n * Called to indicate internally that this is a chainable update - by setting the subject and call of the Triple Builder object which is used to build further triples\n */\nWOQLQuery.prototype.chainableUpdate = function(call, subj){\n\tthis.tripleBuilder = new TripleBuilder(call, this.cursor, this.cleanSubject(subj));\n\treturn this.lastUpdate();\n}\n\n\n/**\n * Returns the value of one of the 'paging' related properties (limit, start,...)\n */\nWOQLQuery.prototype.getPagingProperty = function(pageprop, q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == pageprop) return q[prop][0];\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\tvar val = this.getPagingProperty(pageprop, q[prop][q[prop].length-1]);\n\t\t\tif(typeof val != \"undefined\"){\n\t\t\t\treturn val;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Sets the value of one of the paging_transitive_properties properties\n */\nWOQLQuery.prototype.setPagingProperty = function(pageprop, val, q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == pageprop) {\n\t\t\tq[prop][0] = val;\n\t\t}\n\t\telse if(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\tthis.setPagingProperty(pageprop, val, q[prop][q[prop].length-1]);\n\t\t}\n\t}\n\treturn this;\n}\n\n/**\n * Retrieves the value of the current json-ld context\n */\nWOQLQuery.prototype.getContext = function(q){\n\tq = (q ? q : this.query);\n\tfor (const prop of Object.keys(q)) {\n\t\tif(prop == \"@context\") return q[prop];\n\t\tif(this.paging_transitive_properties.indexOf(prop) !== -1){\n\t\t\tvar nq = q[prop][1];\n\t\t\tvar nc = this.getContext(nq);\n\t\t\tif(nc) return nc;\n\t\t}\n\t}\n}\n\n\n/**\n * Retrieves the value of the current json-ld context\n */\nWOQLQuery.prototype.context = function(c){\n\tthis.cursor['@context'] = c;\n}\n\n\n/*\n* Transforms from internal json representation to human writable WOQL.js format\n*/\nWOQLQuery.prototype.prettyPrint = function(indent, show_context, q, fluent){\n\tif(!this.indent) this.indent = indent;\n\tq = (q ? q : this.query);\n\tvar str = \"\";\n\tconst newlining_operators = [\"get\", \"from\", \"into\"];\n\tfor(var operator in q){\n\t\t//ignore context in pretty print\n\t\tif(operator == \"@context\") {\n\t\t\tif( show_context){\n\t\t\t\tvar c = this.getContext();\n\t\t\t\tif(c) str += \"@context: \" + JSON.stringify(c) + \"\\n\";\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\t//statement starts differently depending on indent and whether it is fluent style or regular function style\n\t\tstr += this.getWOQLPrelude(operator, fluent, indent - this.indent);\n\t\tvar val = q[operator];\n\t\tif(this.isChainable(operator, val[val.length-1])){\n\t\t\t//all arguments up until the last are regular function arguments\n\t\t\tstr += this.uncleanArguments(operator,  val.slice(0, val.length-1), indent, show_context);\n\t\t\tif(newlining_operators.indexOf(operator) !== -1){\n\t\t\t\t//some fluent function calls demand a linebreak..\n\t\t\t\tstr += \"\\n\" + nspaces(indent-this.indent);\n\t\t\t}\n\t\t\t//recursive call to query included in tail\n\t\t\tstr += this.prettyPrint(indent, show_context, val[val.length-1], true);\n\t\t}\n\t\telse {\n\t\t\t//non chainable operators all live inside the function call parameters\n\t\t\tstr += this.uncleanArguments(operator,  val, indent, show_context);\n\t\t}\n\t}\n\t//remove any trailing dots in the chain (only exist in incompletely specified queries)\n\tif(str.substring(str.length-1) == \".\"){\n\t\tstr = str.substring(0, str.length-1);\n\t}\n\treturn str;\n}\n\n/**\n * Gets the starting characters for a WOQL query - varies depending on how the query is invoked and how indented it is\n */\nWOQLQuery.prototype.getWOQLPrelude = function(operator, fluent, inline){\n\tif(operator === \"true\" || operator === \"false\"){\n\t\treturn operator;\n\t}\n\tif(fluent){\n\t\treturn \".\" + operator;\n\t}\n\treturn (inline ? \"\\n\" + nspaces(inline) : \"\") + \"WOQL.\" + operator;\n}\n\n/**\n * Determines whether a given operator can have a chained query as its last argument\n */\nWOQLQuery.prototype.isChainable = function(operator, lastArg){\n\tconst non_chaining_operators = [\"and\", \"or\"];\n\tif(lastArg && typeof lastArg == \"object\" && typeof lastArg['@value'] == \"undefined\"  && typeof lastArg['@type'] == \"undefined\"  && typeof lastArg['value'] == \"undefined\" && non_chaining_operators.indexOf(operator) == -1){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n/**\n * Transforms arguments to WOQL functions from the internal (clean) version, to the WOQL.js human-friendly version\n */\nWOQLQuery.prototype.uncleanArguments = function(operator, args, indent, show_context){\n\tstr = '(';\n\tconst args_take_newlines = [\"and\", \"or\"];\n\tif(this.hasShortcut(operator, args)){\n\t\treturn this.getShortcut(args, indent);\n\t}\n\telse {\n\t\tfor(var i = 0; i<args.length; i++){\n\t\t\tif(this.argIsSubQuery(operator, args[i], i)){\n\t\t\t\tstr += this.prettyPrint(indent + this.indent, show_context, args[i], false);\n\t\t\t}\n\t\t\telse if(operator == \"get\" && i == 0){ // weird one, needs special casing\n\t\t\t\tstr += \"\\n\" + nspaces(indent-this.indent) + \"WOQL\";\n\t\t\t\tfor(var j = 0; j < args[0].length; j++){\n\t\t\t\t\tvar myas = (args[0][j].as ? args[0][j].as : args[0][j]);\n\t\t\t\t\tvar lhs = myas[0];\n\t\t\t\t\tvar rhs = myas[1];\n\t\t\t\t\tif(typeof lhs == \"object\" && lhs['@value']){\n\t\t\t\t\t\tlhs = lhs['@value'];\n\t\t\t\t\t}\n\t\t\t\t\tif(typeof lhs == \"object\") {\n\t\t\t\t\t\tlhs = JSON.stringify(lhs);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tlhs = '\"' + lhs + '\"'\n\t\t\t\t\t}\n\t\t\t\t\tstr += '.as(' + lhs;\n\t\t\t\t\tif(rhs) str += ', \"' + rhs + '\"';\n\t\t\t\t\tstr += \")\";\n\t\t\t\t\tstr += \"\\n\" + nspaces(indent);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstr += this.uncleanArgument(operator, args[i], i, args);\n\t\t\t}\n\t\t\tif(i < args.length -1) str +=  ',';\n\t\t}\n\t}\n\tif(args_take_newlines.indexOf(operator) != -1){\n\t\tstr += \"\\n\" + nspaces(indent-this.indent);\n\t}\n\tstr += \")\";\n\treturn str;\n}\n\n\n/**\n * Passed as arguments: 1) the operator (and, triple, not, opt, etc)\n * 2) the value of the argument\n * 3) the index (position) of the argument.\n */\nWOQLQuery.prototype.uncleanArgument = function(operator, val, index, allArgs){\n\t//numeric values go out untouched...\n\tconst numeric_operators = [\"limit\", \"start\", \"eval\", \"plus\", \"minus\", \"times\", \"divide\", \"exp\", \"div\"];\n\tif(operator == \"isa\"){\n\t\tval = (index == 0 ? this.unclean(val, 'subject') : this.unclean(val, 'class'));\n\t}\n\telse if(operator == \"sub\"){\n\t\tval = this.unclean(val, 'class');\n\t}\n\telse if([\"select\"].indexOf(operator) != -1){\n\t\tif(val.substring(0, 2) == \"v:\") val = val.substring(2);\n\t}\n\telse if([\"quad\", \"add_quad\", \"delete_quad\", \"add_triple\", \"delete_triple\", \"triple\"].indexOf(operator) != -1){\n\t\tswitch(index){\n\t\t\tcase 0: val = this.unclean(val, \"subject\"); break;\n\t\t\tcase 1: val = this.unclean(val, \"predicate\"); break;\n\t\t\tcase 2: val = this.unclean(val, \"object\"); break;\n\t\t\tcase 3: val = this.unclean(val, \"graph\"); break;\n\t\t}\n\t}\n\tif(typeof val == \"object\"){\n\t\tif(operator == \"concat\" && index == 0){\n\t\t\tvar cstr = \"\";\n\t\t\tif(val.list){\n\t\t\t\tfor(var i = 0 ; i<val.list.length; i++){\n\t\t\t\t\tif(val.list[i]['@value']) cstr += val.list[i]['@value'];\n\t\t\t\t\telse cstr += val.list[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar oval = '\"' + cstr + '\"';\n\t\t}\n\t\telse {\n\t\t\tvar oval = this.uncleanObjectArgument(operator, val, index);\n\t\t}\n\t\treturn oval;\n\t}\n\t//else if(numeric_operators.indexOf(operator) !== -1){\n\t//\treturn val;\n\t//}\n\tif(typeof val == \"string\"){\n\t\treturn '\"' + val + '\"';\n\t}\n\treturn val;\n}\n\n\n\nWOQLQuery.prototype.uncleanObjectArgument = function(operator, val, index){\n\tif(val['@value'] && (val['@language'] || (val['@type'] && val['@type'] == \"xsd:string\"))) return '\"' + val['@value'] + '\"';\n\tif(val['@value'] && (val['@type'] && val['@type'] == \"xsd:integer\")) return val['@value'];\n\tif(val['list']) {\n\t\tvar nstr = \"[\";\n\t\tfor(var i = 0 ; i<val['list'].length; i++){\n\t\t\tif(typeof val['list'][i] == \"object\"){\n\t\t\t\tnstr += this.uncleanObjectArgument(\"list\", val['list'][i], i);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnstr += '\"' + val['list'][i] + '\"';\n\t\t\t}\n\t\t\tif(i < val['list'].length-1){\n\t\t\t\tnstr += \",\";\n\t\t\t}\n\t\t}\n\t\tnstr += \"]\";\n\t\treturn nstr;\n\t}\n\treturn JSON.stringify(val);\n}\n\nWOQLQuery.prototype.argIsSubQuery = function(operator, arg, index){\n\tconst squery_operators = [\"and\", \"or\", \"when\", \"not\", \"opt\", \"exp\", \"minus\", \"div\", \"divide\", \"plus\", \"multiply\"];\n\tif(squery_operators.indexOf(operator) !== -1){\n\t\tif(arg && typeof arg != \"object\") return false;\n\t\treturn true;\n\t}\n\tif(operator == \"group_by\" && index == 2) return true;\n\telse return false;\n}\n\n/**\n * Goes from the properly prefixed clean internal version of a variable to the WOQL.js unprefixed form\n */\nWOQLQuery.prototype.unclean = function(s, part){\n\tif(typeof s != \"string\") return s;\n\tif(s.indexOf(\":\") == -1) return s;\n\tif(s.substring(0,4) == \"http\") return s;\n\tvar suff = s.split(\":\")[1];\n\tif(this.vocab && this.vocab[suff] && this.vocab[suff] == s){\n\t\treturn suff;\n\t}\n\tif(!part) return s;\n\tif(part == \"subject\" && (s.split(\":\")[0] == \"doc\")) return suff;\n\tif(part == \"class\" && (s.split(\":\")[0] == \"scm\")) return suff;\n\tif(part == \"predicate\" && (s.split(\":\")[0] == \"scm\")) return suff;\n\tif(part == \"type\" && (s.split(\":\")[0] == \"scm\")) return suff;\n\tif(part == \"graph\" && (s.split(\":\")[0] == \"db\")) return suff;\n\treturn s;\n}\n\nWOQLQuery.prototype.hasShortcut = function(operator, args, indent, show_context){\n\tif(operator == \"true\") return true;\n}\n\nWOQLQuery.prototype.getShortcut = function(operator, args, indent, show_context){\n\tif(operator == \"true\") return true;\n}\n\nfunction nspaces(n){\n\tlet spaces = \"\";\n\tfor(var i = 0; i<n; i++){\n\t\tspaces += \" \";\n\t}\n\treturn spaces;\n}\n\nWOQLQuery.prototype.printLine = function(indent, clauses){\n\treturn \"(\\n\" + nspaces(indent) + \"WOQL.\" + clauses.join(\",\\n\"+ nspaces(indent) + \"WOQL.\") + \"\\n\" + nspaces(indent - this.indent) + \")\";\n}\n\nWOQLQuery.prototype.cleanSubject = function(s){\n\tif(typeof s != \"string\") return s;\n\tif(s.indexOf(\":\") != -1) return s;\n\tif(this.vocab && this.vocab[s]) return this.vocab[s];\n\treturn \"doc:\" + s;\n}\n\nWOQLQuery.prototype.cleanPredicate = function(p){\n\tif(p.indexOf(\":\") != -1) return p;\n\tif(this.vocab && this.vocab[p]) return this.vocab[p];\n\treturn \"scm:\" + p;\n}\nWOQLQuery.prototype.cleanType = function(t){\n\tif(t.indexOf(\":\") != -1) return t;\n\tif(this.vocab && this.vocab[t]) return this.vocab[t];\n\treturn \"scm:\" + t;\n}\n\nWOQLQuery.prototype.cleanObject = function(o){\n\tif(typeof o != \"string\" || o.indexOf(\":\") != -1) return o;\n\tif(this.vocab && this.vocab[o]) return this.vocab[o];\n\treturn { \"@value\": o, \"@language\": \"en\"};\n}\n\nWOQLQuery.prototype.cleanGraph = function(g){\n\tif(g.indexOf(\":\") != -1) return g;\n\tif(this.vocab && this.vocab[g]) return this.vocab[g];\n\treturn \"db:\" + g;\n}\n\nWOQLQuery.prototype.cleanClass = function(c){\n\tif(c.indexOf(\":\") != -1) return c;\n\tif(this.vocab && this.vocab[c]) return this.vocab[c];\n\treturn \"scm:\" + c;\n}\n\n/*\n * higher level composite queries - not language or api elements\n */\n/**\n * Class for enabling building of triples from pieces\n * type is add_quad / remove_quad / add_triple / remove_triple\n */\nfunction TripleBuilder(type, cursor, s){\n\t//what accumulation type are we\n\tthis.type = type;\n\tthis.cursor = cursor;\n\tthis.subject = (s ? s : false);\n\tthis.g = false;\n}\n\nTripleBuilder.prototype.label = function(l, lang){\n\tlang = (lang ? lang : \"en\");\n\tif(l.substring(0, 2) == \"v:\"){\n\t\tvar d = l;//{\"value\": l, \"@language\": lang }\n\t}\n\telse {\n\t\tvar d = {\"@value\": l, \"@language\": lang }\n\t}\n\tvar x = this.addPO('rdfs:label', d);\n\treturn x;\n}\n\nTripleBuilder.prototype.description = function(c, lang){\n\tlang = (lang ? lang : \"en\");\n\tif(c.substring(0, 2) == \"v:\"){\n\t\t//var d = {\"value\": c, \"@language\": lang }\n\t\tvar d = c;\n\t}\n\telse {\n\t\tvar d = {\"@value\": c, \"@language\": lang }\n\t}\n\treturn this.addPO('rdfs:comment', d);\n}\n\nTripleBuilder.prototype.addPO = function(p, o, g){\n\tif(this.type){\n\t\tvar ttype = (this.type == \"isa\" || this.type == \"sub\" ? \"triple\" : this.type);\n\t}\n\telse var ttype = \"triple\";\n\tvar evstr = ttype + '(\"' + this.subject + '\", \"' + p + '\", ';\n\tif(typeof o == \"string\"){\n\t\tevstr += \"'\" + o + \"'\";\n\t}\n\telse if(typeof o == \"object\"){\n\t\tevstr += JSON.stringify(o);\n\t}\n\telse {\n\t\tevstr += o;\n\t}\n\tif(ttype.substring(ttype.length-4) == \"quad\" || this.g){\n\t\tvar g = (g ? g : (this.g ? this.g : \"db:schema\"));\n\t\tevstr += ', \"' + g + '\"';\n\t}\n\tevstr += \")\";\n\ttry {\n\t\tvar unit = eval(\"new WOQLQuery().\" + evstr );\n\t\treturn this.addEntry(unit);\n\t}\n\tcatch(e){\n\t\tconsole.error(e);\n\t\treturn this;\n\t}\n}\n\nTripleBuilder.prototype.getO = function(s, p){\n\tif(this.cursor['and']){\n\t\tfor(var i = 0; i<this.cursor['and'].length; i++){\n\t\t\tvar clause = this.cursor['and'][i];\n\t\t\tvar key = Object.keys(clause)[0];\n\t\t\tif(clause[key][0] == s && clause[key][1] == p && clause[key][2]) return clause[key][2];\n\t\t}\n\t}\n\telse if(Object.keys(this.cursor)) {\n\t\tvar key =  Object.keys(this.cursor)[0];\n\t\tif(this.cursor[key][0] == s && this.cursor[key][1] == p && this.cursor[key][2])  return this.cursor[key][2];\n\t}\n\treturn false;\n}\n\nTripleBuilder.prototype.addEntry = function(unit){\n\tif(this.cursor[this.type]){\n\t\tvar next = {};\n\t\tnext[this.type] = this.cursor[this.type];\n\t\tthis.cursor['and'] = [next];\n\t\tdelete(this.cursor[this.type]);\n\t}\n\tif(this.cursor['and']){\n\t\tthis.cursor['and'].push(unit.json());\n\t}\n\telse {\n\t\tvar j = unit.json();\n\t\tif(j[this.type]) this.cursor[this.type] = j[this.type];\n\t\telse {\n\t\t\talert(JSON.stringify(j));\n\t\t}\n\t}\n\treturn this;\n}\n\nTripleBuilder.prototype.card = function(n, which){\n\tlet os = this.subject;\n\tthis.subject += \"_\" + which;\n\tthis.addPO('rdf:type', \"owl:Restriction\");\n\tthis.addPO(\"owl:onProperty\", os);\n\tswitch(which){\n\t\tcase \"max\": this.addPO(\"owl:maxCardinality\", {\"@value\": n, \"@type\": \"xsd:nonNegativeInteger\"});\n\t\t\tbreak;\n\t\tcase \"min\": this.addPO(\"owl:minCardinality\", {\"@value\": n, \"@type\": \"xsd:nonNegativeInteger\"});\n\t\t\tbreak;\n\t\tdefault: this.addPO(\"owl:cardinality\", {\"@value\": n, \"@type\": \"xsd:nonNegativeInteger\"});\n\t}\n\tlet od = this.getO(os, \"rdfs:domain\");\n\tif(od){\n\t\tvar x = this.subject;\n\t\tthis.subject = od;\n\t\tthis.addPO(\"rdfs:subClassOf\", this.subject);\n\t\t//this.triples.push([od, \"rdfs:subClassOf\", this.subject]);\n\t}\n\tthis.subject = os;\n\treturn this;\n};\n\nTripleBuilder.prototype.isa = function(a){\n\tvar unit = new WOQLQuery.isa(this.subject, a);\n\tthis.tb.addEntry(unit);\n}\n\nTripleBuilder.prototype.graph = function(g){\n\tthis.g = g;\n}\n\nTripleBuilder.prototype.sub = function(s){\n\tvar unit = new WOQLQuery.sub(this.subject, s);\n\treturn this.addEntry(unit);\n}\n\nTripleBuilder.prototype.abstract = function(){\n\treturn this.addPO('tcs:tag', \"tcs:abstract\");\n}\n\nmodule.exports = WOQL;\n"],"sourceRoot":""}